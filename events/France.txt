###########################
# French Events
###########################

add_namespace = france

# Japan demands Indochina
country_event = {
	id = france.1
	title = france.1.t
	desc = france.1.d
	picture = GFX_report_event_japan_army_mountainside

	is_triggered_only = yes

	option = { # Accept demands
		name = france.1.a
		ai_chance = {
			factor = 25
			modifier = {
				factor = 50
				has_war = yes
				any_enemy_country = {
					strength_ratio = {
						tag = ROOT
						ratio < 0.4
					}
				}
			}
			modifier = {
				factor = 75
				16 = { NOT = { is_controlled_by = FRA } } #Paris
			}
		}
		JAP = {
			country_event = { days = 5 id = japan.6 }
		}
	}
	option = { # Refuse
		name = france.1.b
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				16 = { NOT = { is_controlled_by = FRA } } #Paris
			}
		}
		JAP = {
			country_event = { days = 5 id = japan.7 }
		}
	}
}

# Maginot Line Extension
country_event = {
	id = france.2
	title = france.2.t
	desc = france.2.d
	picture = GFX_report_event_bunker_01

	is_triggered_only = yes

	option = {
		name = france.2.a
		18 = {
			add_building_construction = {
				type = bunker
				province = 5291
				level = 2
				instant_build = yes
			}
			add_building_construction = {
				type = bunker
				province = 3560
				level = 2
				instant_build = yes
			}
			add_building_construction = {
				type = bunker
				province = 9472
				level = 2
				instant_build = yes
			}
		}
		29 = {
			add_building_construction = {
				type = bunker
				province = 11606
				level = 2
				instant_build = yes
			}
			add_building_construction = {
				type = bunker
				province = 11483
				level = 2
				instant_build = yes
			}
			add_building_construction = {
				type = bunker
				province = 575
				level = 2
				instant_build = yes
			}
		}
		785 = {
			add_building_construction = {
				type = bunker
				province = 3447
				level = 2
				instant_build = yes
			}
		}
	}
}

# Alpine Line Extension
country_event = {
	id = france.3
	title = france.3.t
	desc = france.3.d
	picture = GFX_report_event_bunker_01

	is_triggered_only = yes

	option = {
		name = france.3.a
		735 = {
			add_building_construction = {
				type = bunker
				province = 764
				level = 2
				instant_build = yes
			}
			add_building_construction = {
				type = bunker
				province = 9909
				level = 2
				instant_build = yes
			}
			add_building_construction = {
				type = bunker
				province = 3959
				level = 2
				instant_build = yes
			}
			add_building_construction = {
				type = bunker
				province = 6975
				level = 2
				instant_build = yes
			}
			add_building_construction = {
				type = bunker
				province = 3764
				level = 2
				instant_build = yes
			}
			add_building_construction = {
				type = bunker
				province = 9745
				level = 2
				instant_build = yes
			}
			add_building_construction = {
				type = bunker
				province = 778
				level = 2
				instant_build = yes
			}
		}
	}
}

### The Fall of France

#hidden pre-event to check before capitulation
country_event = {
	id = france.101
	hidden = yes

	fire_only_once = yes

	trigger = {
		tag = FRA
		has_war_with = GER
		has_government = democratic
		surrender_progress > 0.6
		GER = {
			OR = {
				is_faction_leader = yes
				has_government = neutrality
			}
		}
		has_civil_war = no

		#Don't fire if France has pushed pretty far into ITA or GER
		NOT = {
			42 = { is_controlled_by = FRA }
		}
		NOT = {
			50 = { is_controlled_by = FRA }
		}
		NOT = {
			159 = { is_controlled_by = FRA }
		}
		NOT = {
			161 = { is_controlled_by = FRA }
		}
		OR = {
			has_war_with = BEL
			BEL = { has_capitulated = yes }
			BEL = { has_war = no }
			28 = { is_controlled_by = GER }
			6 = { is_controlled_by = GER }
		}
		if = {
			limit = {
				has_war_with = ITA
			}
			ITA = { is_in_faction_with = GER }
		}
	}

	immediate = {
		country_event = france.10
		if = {
			limit = {
				is_ai = yes
			}
			add_equipment_to_stockpile = {
				type = fra_motorized_equipment_1
				producer = FRA
				amount = -25000
			}
		}
	}
}
# The Battle is Lost
country_event = {
	id = france.10
	title = france.10.t
	desc = france.10.d
	picture = GFX_report_event_german_parade_paris

	fire_only_once = yes

	is_triggered_only = yes

	immediate = {
		set_global_flag = achievement_france_surrender
	}

	option = { # Become Vichy
		name = france.10.a
		trigger = { is_ai = no }
		set_country_flag = become_vichy
		save_global_event_target_as = vichy_france
		set_global_flag = fall_of_france
		GER = { country_event = france.14 }
		custom_effect_tooltip = france.10.a_tt
		# Switches to Vichy if GER accepts
	}
	option = { # Become Free French
		name = france.10.b
		ai_chance = {
			factor = 85
		}
		set_global_flag = fall_of_france
		save_global_event_target_as = free_france
		GER = { country_event = france.14 }
		custom_effect_tooltip = france.10.b_tt
	}
	option = { # Ask for British Union
		name = france.10.c
		trigger = { doesnt_have_disjointed_government = yes }
		ai_chance = {
			factor = 15
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		ENG = {
			country_event = france.11
			effect_tooltip = {
				annex_country = { target = FRA transfer_troops = yes }
			}
		}
		custom_effect_tooltip = GAME_OVER_TT
	}
	option = { # decide to fight on
		name = france.10.e
		trigger = {
        	doesnt_have_disjointed_government = yes
            has_war_support > 0.7
        }
		ai_chance = {
			factor = 15
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		add_stability = -0.05
	}
}

# France suggests a Union (Britain)
country_event = {
	id = france.11
	title = france.11.t
	desc = france.11.d
	picture = GFX_report_event_degaulle_churchill

	is_triggered_only = yes

	option = { # Refuse Union
		name = france.11.a
		ai_chance = {
			factor = 10
		}
		FRA = {
			country_event = { hours = 6 id = france.13 }
		}
	}
	option = { # Agree to Union
		name = france.11.b
		ai_chance = {
			factor = 90
		}
		FRA = {
			country_event = { hours = 6 id = france.12 }
		}
	}
}

# Britain agrees to Union (France)
country_event = {
	id = france.12
	title = france.12.t
	desc = france.12.d
	picture = GFX_report_event_chamberlain_announce

	is_triggered_only = yes

	option = {
		name = france.12.a
		# Franco-British Union created
		set_global_flag = fall_of_france
		set_global_flag = flag_franco_british_union
		hidden_effect = {
			every_state = {
				limit = {
					is_core_of = FRA
				}
				ENG = {
					add_state_core = PREV
				}
			}
		}
		FRA = {
			every_unit_leader = {
				set_unit_leader_flag = flag_former_french_general
				set_nationality = ENG
			}
		}
		ENG = {
			annex_country = { target = FRA transfer_troops = yes }
		}
		custom_effect_tooltip = FRA_franco_british_cores
		hidden_effect = {
			ENG = { set_cosmetic_tag = FRA_UK }
			GER = {
				country_event = { hours = 6 id = news.35 }
			}
		}
	}
}

# Britain refuses Union (France)
country_event = {
	id = france.13
	title = france.13.t
	desc = france.13.d
	picture = GFX_report_event_pierre_laval

	is_triggered_only = yes

	option = { # Become Vichy
		name = france.13.a
		trigger = { is_ai = no }
		set_country_flag = become_vichy
		set_global_flag = fall_of_france
		save_global_event_target_as = vichy_france
		GER = { country_event = france.14 }
		custom_effect_tooltip = france.10.a_tt
		# Switches to Vichy if GER accepts
	}
	option = { # Become Free France
		name = france.13.b
		GER = { country_event = france.14 }
		save_global_event_target_as = free_france
		custom_effect_tooltip = france.10.b_tt
		set_global_flag = fall_of_france
	}
	option = { # decide to fight on
		name = france.10.e
		ai_chance = {
			factor = 15
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		trigger = { has_war_support > 0.7 }
		add_stability = -0.05
		custom_effect_tooltip = france_continue_the_fight_tt
	}
}

# France wants Armistice (Germany)
country_event = {
	id = france.14
	title = france.14.t
	desc = france.14.d
	picture = GFX_report_event_german_parade_paris

	is_triggered_only = yes

	option = { # Agree
		name = france.14.a
		ai_chance = {
			factor = 150
		}
		news_event = { hours = 6 id = news.34 }
		add_named_threat = {
			threat = -32
			name = vichy_formed
		}
		trigger = {
			has_government = fascism
		}
		if = {
			limit = {
				FRA = { is_in_faction_with = ENG }
			}
			effect_tooltip = {
				ENG = {
					add_war_support = -0.4
				}
			}
		}
		FRA = {
			set_country_flag = FRA_capitulate_into_free_france
			every_owned_state = {
				limit = {
					is_controlled_by = ITA
					OR = {
						state = 1
						state = 735
						state = 458
						state = 665
					}
				}
				set_state_flag = vichy_italian_conquest
			}
		}
		custom_effect_tooltip = establishing_vichy_tt
		hidden_effect = {
			set_global_flag = the_fall_of_france_global_flag
			release = VIC
			every_state = { #transfer French colonial empire
				limit = {
					is_controlled_by = FRA
					is_owned_by = FRA
					OR = {
						is_on_continent = africa
						is_on_continent = asia
						is_core_of = VIN
						is_core_of = CAM
						is_core_of = LAO
						is_core_of = LEB
						is_core_of = SYR
						is_core_of = TAH
					}
				}
				VIC = { transfer_state = PREV }
			}
			if = {
				limit = { ITA = { has_war_with = FRA } }
				every_state = { #Italy gets there claimed lands
					limit = {
						OR = {
							state = 1
							state = 735
							state = 458
							state = 665
						}
						has_state_flag = vichy_italian_conquest
					}
					ITA = { transfer_state = PREV }
				}
			}
			every_state = {
				limit = { #set up Vichy continental holdings
					OR = {
						state = 31
						state = 25
						state = 33
						state = 26
						state = 22
						state = 20
						state = 32
						state = 735
						state = 21
						state = 1
					}
					NOT = { has_state_flag = vichy_italian_conquest }
					CONTROLLER = {
						OR = {
							original_tag = FRA
							has_war_with = FRA
						}
					}
				}
				add_core_of = VIC
				VIC = { transfer_state = PREV }
			}
			FRA = {
				delete_unit_template_and_units = {
					division_template = "Tirailleurs"
					disband = yes
				}
				delete_unit_template_and_units = {
					division_template = "Tirailleurs Montagne"
					disband = yes
				}
				delete_unit_template_and_units = {
					division_template = "Compagnies Méharistes Sahariennes"
					disband = yes
				}
			}
			FRA = { # Give all Military and stockpile to Vichy
				transfer_units_fraction = {
					target = VIC
					size = 1.0
					stockpile_ratio = 1.0
					army_ratio = 1.0
					navy_ratio = 1.0
					air_ratio = 1.0
					keep_unit_leaders_trigger = {
						always = yes
					}
				}
			}
			every_state = {
				limit = { #set up german continental holdings
					OR = {
						state = 19
						state = 23
						state = 30
						state = 14
						state = 15
						state = 24
						state = 1015
						state = 16
						state = 855
						state = 785
						state = 29
						state = 18
						state = 27
						state = 17
						state = 28
					}
					OWNER = { original_tag = FRA }
					CONTROLLER = { original_tag = FRA }
				}
				GER = { set_state_controller = PREV }
			}

			#Vichy gets the merchant Fleet
			FRA = {
				if = {
					limit = {
						has_equipment = {
							convoy_1 > 180
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -180
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 180
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 170
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -170
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 170
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 160
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -160
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 160
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 150
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -150
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 150
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 140
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -140
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 140
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 130
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -130
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 130
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 120
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -120
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 120
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 110
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -110
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 110
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 100
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -100
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 100
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 90
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -90
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 90
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 80
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -80
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 80
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 70
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -70
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 70
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 60
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -60
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 60
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 50
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -50
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 50
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 40
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -40
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 40
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 30
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -30
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 30
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 20
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -20
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 20
							producer = ROOT
						}
					}
				}
				else_if = {
					limit = {
						has_equipment = {
							convoy_1 > 10
						}
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -10
					}
					VIC = {
						add_equipment_to_stockpile = {
							type = convoy_1
							amount = 10
							producer = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					FRA = {
						check_variable = { FRA_People_national_unity > 2 }
					}
				}
				GER = {
					every_controlled_state = {
						limit = {
							is_core_of = FRA
						}
						add_compliance = 45
					}
				}
			}
			else_if = {
				limit = {
					FRA = {
						check_variable = { FRA_People_national_unity > 1 }
					}
				}
				GER = {
					every_controlled_state = {
						limit = {
							is_core_of = FRA
						}
						add_compliance = 60
					}
				}
			}
			else_if = {
				limit = {
					FRA = {
						check_variable = { FRA_People_national_unity > 0 }
					}
				}
				GER = {
					every_controlled_state = {
						limit = {
							is_core_of = FRA
						}
						add_compliance = 75
					}
				}
			}
			
			FRA = { 
				country_event = {
					id = france.20 
					days = 2
				} 
			}

			if = {
				limit = {
					NOT = { 
						FRA = { 
							has_completed_focus = FRA_purge_the_old_guard
						}
					}
				}
				remove_unit_leader_role = FRA_maurice_gamelin
				deactivate_advisor = FRA_maurice_gamelin
			}
			FRA = { remove_resource_rights = 286 }
			FRA = {
				FRA_philippe_petain = {
					set_nationality = VIC
				}
				FRA_francois_darlan = {
					set_nationality = VIC
				}
				FRA_pierre_laval = {
					set_nationality = VIC
				}
				FRA_pierre_cathala = {
					set_nationality = VIC
				}
				FRA_ludovic_oscar_frossard = {
					set_nationality = VIC
				}
				FRA_gaston_henry_haye = {
					set_nationality = VIC
				}
				FRA_jean_decoux = {
					set_nationality = VIC
				}
				FRA_charles_huntziger = { #Dies in November 1941
				   	set_nationality = VIC
			  	}
				FRA_alphonse_juin = { #Rejoins free france after NA is retaken
				 	set_nationality = VIC
			  	}
				FRA_jean_de_laborde = {
					set_nationality = VIC
				}
				FRA_philippe_henriot = {
					set_nationality = VIC
				}
				FRA_maxime_weygand = {
					set_nationality = VIC
				}
				FRA_maurice_gamelin = {
					set_nationality = VIC
				}
			}
			VIC = {
				set_capital = { state = 26 }
				add_country_leader_role = {
					character = FRA_philippe_petain
					country_leader = {
						expire = "1965.1.1"
						ideology = fascism_ideology
						traits = { national_symbol }
					}
				}
				promote_character = FRA_philippe_petain
				add_ideas = VIC_depowered_government
				add_ideas = national_syndicalism
				inherit_technology = FRA
				add_ideas = FRA_empire
				add_ideas = FRA_dirigisme
				add_ideas = FRA_emancipate_women
				add_ideas = FRA_static_command
				add_ideas = FRA_victors_of_wwi_2
				add_timed_idea = {
					idea = VIC_ai_plane_transfer_fix
					days = 30
				}
				set_variable = { var = FRA_National_bloc_attitude value = -6 }
				set_variable = { var = FRA_National_bloc_influence value = 0 }
				set_variable = { var = FRA_National_bloc_political_power_gain value = 0 }
				set_variable = { var = FRA_National_bloc_factory_output value = 0 }
				set_variable = { var = FRA_National_bloc_stability value = 0 }
				set_variable = { var = FRA_CGT_attitude value = -6 }
				set_variable = { var = FRA_CGT_influence value = 0 }
				set_variable = { var = FRA_CGT_factory_output value = 0 }
				set_variable = { var = FRA_CGT_political_power_gain value = 0 }
				set_variable = { var = FRA_CGT_stability value = 0 }
				set_variable = { var = FRA_Far_Right_Leagues_attitude value = -6 }
				set_variable = { var = FRA_Far_Right_Leagues_influence value = 0 }
				set_variable = { var = FRA_Far_Right_Leagues_political_power_gain value = 0 }
				set_variable = { var = FRA_far_right_leagues_war_support value = 0 }
				set_variable = { var = FRA_Far_Right_Leagues_stability value = 0 }
				set_variable = { var = FRA_French_Industrialists_attitude value = -6 }
				set_variable = { var = FRA_French_Industrialists_influence value = 0 }
				set_variable = { var = FRA_French_Industrialists_political_power_gain value = 0 }
				set_variable = { var = FRA_French_Industrialists_factory_output value = 0 }
				set_variable = { var = FRA_French_Industrialists_dockyard_output value = 0 }
				FRA_political_instability_update_effect = yes
			}
		}

        if = {
        	limit = {
            	has_dlc = "La Resistance"
            }
            FRA = { add_ideas = FRA_defeatism }
			VIC = {
				add_ideas = VIC_occupation_costs_4
				load_focus_tree = vichy_french_focus
				reverse_add_opinion_modifier = {
					target = GER
					modifier = Unembargoed
				}
			}
        }
        else = {
            FRA = { add_timed_idea = { idea = FRA_defeatism days = 365 } }
            VIC = { add_timed_idea = { idea = VIC_occupation_costs_4 days = 1095 } }
        }

		VIC = {
			GER = {
				give_guarantee = PREV
			}
			if = {
				limit = {
					has_dlc = "La Resistance"
				}
				if = {
					limit = {
						FRN = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = {
						target = FRN
						autonomy_state = autonomy_integrated_puppet
					}
				}
				else = {
					release_autonomy = {
						target = FRN
						autonomy_state = autonomy_integrated_puppet
					}
					every_owned_state = {
						limit = {
							is_core_of = ALG
							is_controlled_by = VIC
						}
						transfer_state_to = FRN
					}
				}
				if = {
					limit = {
						FRT = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = {
						target = FRT
						autonomy_state = autonomy_integrated_puppet
					}
				}
				else = {
					release_autonomy = {
						target = FRT
						autonomy_state = autonomy_integrated_puppet
					}
					every_owned_state = {
						limit = {
							is_core_of = TUN
							is_controlled_by = VIC
						}
						transfer_state_to = FRT
					}
				}
				if = {
					limit = {
						FRM = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = {
						target = FRM
						autonomy_state = autonomy_integrated_puppet
					}
				}
				else = {
					release_autonomy = {
						target = FRM 
						autonomy_state = autonomy_integrated_puppet
					}
					every_owned_state = {
						limit = {
							is_core_of = MOR
							is_controlled_by = VIC
						}
						transfer_state_to = FRM
					}
				}
				if = {
					limit = {
						FRS = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = {
						target = FRS
						autonomy_state = autonomy_integrated_puppet
					}
				}
				else = {
					release_autonomy = {
						target = FRS 
						autonomy_state = autonomy_integrated_puppet
					}
					every_owned_state = {
						limit = {
							is_core_of = SYR
							is_controlled_by = VIC
						}
						transfer_state_to = FRS
					}
				}
				if = {
					limit = {
						FRW = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = {
						target = FRW
						autonomy_state = autonomy_integrated_puppet
					}
				}
				else = {
					release_autonomy = {
						target = FRW
						autonomy_state = autonomy_integrated_puppet
					}
					every_owned_state = {
						limit = {
							OR = {
								region = 140
								region = 127
							}
							is_controlled_by = VIC
						}
						transfer_state_to = FRW
					}
				}
				if = {
					limit = {
						FRC = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = {
						target = FRC
						autonomy_state = autonomy_integrated_puppet
					}
				}
				else = {
					release_autonomy = {
						target = FRC
						autonomy_state = autonomy_integrated_puppet
					}
					every_owned_state = {
						limit = {
							OR = {
								region = 184
								region = 183
							}
							is_controlled_by = VIC
						}
						transfer_state_to = FRC
					}
				}
				if = {
					limit = {
						FRP = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = {
						target = FRP
						autonomy_state = autonomy_integrated_puppet
					}
				}
				else = {
					release_autonomy = {
						target = FRP
						autonomy_state = autonomy_integrated_puppet
					}
					every_owned_state = {
						limit = {
							is_core_of = DJI
							is_controlled_by = VIC
						}
						transfer_state_to = FRP
					}
				}
				if = {
					limit = {
						FRJ = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = {
						target = FRJ
						autonomy_state = autonomy_integrated_puppet
					}
				}
				else = {
					release_autonomy = {
						target = FRJ
						autonomy_state = autonomy_integrated_puppet
					}
					every_owned_state = {
						limit = {
							is_core_of = MAD
							is_controlled_by = VIC
						}
						transfer_state_to = FRJ
					}
				}
				if = {
					limit = {
						FRI = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = {
						target = FRI
						autonomy_state = autonomy_integrated_puppet
					}
				}
				else = {
					release_autonomy = {
						target = FRI
						autonomy_state = autonomy_integrated_puppet
					}
					every_owned_state = {
						limit = {
							is_core_of = CAY
							is_controlled_by = VIC
						}
						transfer_state_to = FRI
					}
				}
				if = {
					limit = {
						FRV = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = { target = FRV autonomy_state = autonomy_free }
					VIC = {
						set_autonomy = {
							target = FRV
							autonomous_state = autonomy_integrated_puppet
							freedom_level = 0.5
						}
					}
					FRV = {
						set_politics = {
							ruling_party = neutrality
							elections_allowed = no
						}
					}
				}
				else_if = {
					limit = {
						FRV = {
							exists = yes
							NOT = { has_war_with = VIC }
						}
					}
					VIC = { give_guarantee = FRV }
				}
			}
			else = {
				if = {
					limit = {
						FRN = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					puppet = FRN
				}
				else = {
					release_puppet_on_controlled = FRN
					every_owned_state = {
						limit = {
							is_core_of = ALG
							is_controlled_by = VIC
						}
						transfer_state_to = FRN
					}
				}
				if = {
					limit = {
						FRT = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					puppet = FRT
				}
				else = {
					release_puppet_on_controlled = FRT
					every_owned_state = {
						limit = {
							is_core_of = TUN
							is_controlled_by = VIC
						}
						transfer_state_to = FRT
					}
				}
				if = {
					limit = {
						FRM = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					puppet = FRM
				}
				else = {
					release_puppet_on_controlled = FRM
					every_owned_state = {
						limit = {
							is_core_of = MOR
							is_controlled_by = VIC
						}
						transfer_state_to = FRM
					}
				}
				if = {
					limit = {
						FRS = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					puppet = FRS
				}
				else = {
					release_puppet_on_controlled = FRS
					every_owned_state = {
						limit = {
							is_core_of = SYR
							is_controlled_by = VIC
						}
						transfer_state_to = FRS
					}
				}
				if = {
					limit = {
						FRW = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					puppet = FRW
				}
				else = {
					release_puppet_on_controlled = FRW
					every_owned_state = {
						limit = {
							OR = {
								region = 140
								region = 127
							}
							is_controlled_by = VIC
						}
						transfer_state_to = FRW
					}
				}
				if = {
					limit = {
						FRC = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					puppet = FRC
				}
				else = {
					release_puppet_on_controlled = FRC
					every_owned_state = {
						limit = {
							OR = {
								region = 184
								region = 183
							}
							is_controlled_by = VIC
						}
						transfer_state_to = FRC
					}
				}
				if = {
					limit = {
						FRP = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					puppet = FRP
				}
				else = {
					release_puppet_on_controlled = FRP
					every_owned_state = {
						limit = {
							is_core_of = DJI
							is_controlled_by = VIC
						}
						transfer_state_to = FRP
					}
				}
				if = {
					limit = {
						FRJ = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					puppet = FRJ
				}
				else = {
					release_puppet_on_controlled = FRJ
					every_owned_state = {
						limit = {
							is_core_of = MAD
							is_controlled_by = VIC
						}
						transfer_state_to = FRJ
					}
				}
				if = {
					limit = {
						FRI = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					puppet = FRI
				}
				else = {
					release_puppet_on_controlled = FRI
					every_owned_state = {
						limit = {
							is_core_of = CAY
							is_controlled_by = VIC
						}
						transfer_state_to = FRI
					}
				}
				if = {
					limit = {
						FRV = {
							exists = yes
							OR = {
								is_subject_of = ROOT
								is_subject_of = FRA
							}
						}
					}
					set_autonomy = { target = FRV autonomy_state = autonomy_free }
					VIC = {
						set_autonomy = {
							target = FRV
							autonomous_state = autonomy_integrated_puppet
							freedom_level = 0.5
						}
					}
					FRV = {
						set_politics = {
							ruling_party = neutrality
							elections_allowed = no
						}
						add_country_leader_role = {
							character = FRV_eugene_robin
							country_leader = {
								expire = "1965.1.1"
								ideology = despotism
								traits = {
									#
								}
								desc = ""
							}
						}
					}
				}
				else_if = {
					limit = {
						FRV = {
							exists = yes
							NOT = { has_war_with = VIC }
						}
					}
					VIC = { give_guarantee = FRV }
				}
			}
			
			if = {
				limit = { FRA = { has_country_flag = become_vichy } }
				change_tag_from = FRA
			}
			FRA = {
				create_corps_commander = {
					name = "Paul Legentilhomme"
					portrait_path = "gfx/leaders/FRA/Portrait_France_Paul_Legentilhomme.dds"
					traits = { trait_reckless desert_fox }
					skill = 1
					attack_skill = 2
					defense_skill = 1
					planning_skill = 1
					logistics_skill = 1
				}

				create_corps_commander = {
					name = "Felix Eboué"
					portrait_path = "gfx/leaders/FRA/Portrait_France_Felix_Eboue.dds"
					traits = { skilled_staffer }
					skill = 2
					attack_skill = 1
					defense_skill = 2
					planning_skill = 1
					logistics_skill = 2
				}
			}
			FRA = {
				if = {
					limit = {
						has_idea = FRA_structured_doctrines
					}
					remove_ideas = FRA_structured_doctrines
				}
				if = {
					limit = {
						has_idea = FRA_structured_doctrines_air
					}
					remove_ideas = FRA_structured_doctrines_air
				}
				if = {
					limit = {
						has_idea = FRA_structured_doctrines_land
					}
					remove_ideas = FRA_structured_doctrines_land
				}
				if = {
					limit = {
						has_idea = FRA_structured_doctrines_naval
					}
					remove_ideas = FRA_structured_doctrines_naval
				}
				if = {
					limit = {
						has_idea = FRA_structured_doctrines_air_land
					}
					remove_ideas = FRA_structured_doctrines_air_land
				}
				if = {
					limit = {
						has_idea = FRA_structured_doctrines_air_naval
					}
					remove_ideas = FRA_structured_doctrines_air_naval
				}
				if = {
					limit = {
						has_idea = FRA_structured_doctrines_land_naval
					}
					remove_ideas = FRA_structured_doctrines_land_naval
				}
			}
		}
	}

	option = { # Agree - Neutrality
		name = france.14.c
		ai_chance = {
			factor = 50
		}
		trigger = {
			has_government = neutrality
		}
		#Set same cosmetic tag they would get on capitulation
		FRA = {
			set_country_flag = FRA_capitulate_into_free_france
		}
		# German Occupation Zone
		if = {
			limit = { 28 = { owner = { original_tag = FRA } } }
			set_state_controller = 28
		}
		if = {
			limit = { 17 = { owner = { original_tag = FRA } } }
			set_state_controller = 17
		}
		if = {
			limit = { 27 = { owner = { original_tag = FRA } } }
			set_state_controller = 27
		}
		if = {
			limit = { 18 = { owner = { original_tag = FRA } } }
			set_state_controller = 18
		}
		if = {
			limit = { 29 = { owner = { original_tag = FRA } } }
			set_state_controller = 29
		}
		if = {
			limit = { 785 = { owner = { original_tag = FRA } } }
			set_state_controller = 785
		}
		if = {
			limit = { 15 = { owner = { original_tag = FRA } } }
			set_state_controller = 15
		}
		if = {
			limit = { 16 = { owner = { original_tag = FRA } } }
			set_state_controller = 16
		}
		if = {
			limit = { 24 = { owner = { original_tag = FRA } } }
			set_state_controller = 24
		}
		if = {
			limit = { 30 = { owner = { original_tag = FRA } } }
			set_state_controller = 30
		}
		if = {
			limit = { 14 = { owner = { original_tag = FRA } } }
			set_state_controller = 14
		}
		if = {
			limit = { 23 = { owner = { original_tag = FRA } } }
			set_state_controller = 23
		}
		if = {
			limit = { 19 = { owner = { original_tag = FRA } } }
			set_state_controller = 19
		}
		# Italian Occupation Zone (if they did well)
		if = { #if Italy did really well, they get an extra bonus state (but only if that doesn't lead to bordergore)
			limit = {
				AND = {
					735 = { #Savoy
						owner = { original_tag = FRA }
						is_controlled_by = ITA
					}
					21 = { #Provence
						owner = { original_tag = FRA }
						is_controlled_by = ITA
					}
					32 = { #Alpes
						owner = { original_tag = FRA }
						is_controlled_by = ITA
					}
				}
			}
			ITA = { transfer_state = 32 }
		}
		if = {
			limit = {
				AND = {
					21 = { #Provence
						owner = { original_tag = FRA }
						is_controlled_by = ITA
					}
				}
			}
			ITA = { transfer_state = 21 }
		}
		if = {
			limit = {
				AND = {
					1 = { #Corsica
						owner = { original_tag = FRA }
						is_controlled_by = ITA
					}
				}
			}
			ITA = { transfer_state = 1 }
		}
		if = {
			limit = {
				AND = {
					735 = { #Savoy
						owner = { original_tag = FRA }
						is_controlled_by = ITA
					}
				}
			}
			ITA = { transfer_state = 735 }
		}

		#Spanish occupation zone
		if = {
			limit = {
				31 = { #Midi-Pyrinees
					owner = { original_tag = FRA }
					controller = { original_tag = SPR }
				}
			}
			random_other_country = {
				limit = {
					original_tag = SPR
					has_war_with = FRA
				}
				transfer_state = 31
			}
		}
		FRA = {
			set_capital = { state = 539 }
			hidden_effect = {
					set_state_controller = 26
					set_state_controller = 22
					set_state_controller = 25
					set_state_controller = 20
					set_state_controller = 33

					#tunisia
					if = {
						limit = {
							458 = {
								owner = { original_tag = FRA }
								controller = {
									original_tag = FRA
								}
							}
						}
						set_state_controller = 458
					}

					#syria
					if = {
						limit = {
							677 = {
								owner = { original_tag = FRA }
								controller = {
									original_tag = FRA
								}
							}
						}
						set_state_controller = 677
					}
					if = {
						limit = {
							680 = {
								owner = { original_tag = FRA }
								controller = {
									original_tag = FRA
								}
							}
						}
						set_state_controller = 680
					}
					if = {
						limit = {
							554 = {
								owner = { original_tag = FRA }
								controller = {
									original_tag = FRA
								}
							}
						}
						set_state_controller = 554
					}

					if = {
						limit = {
							1 = {
								owner = { original_tag = FRA }
							}
						}
						set_state_controller = 1
					}
					if = {
						limit = {
							32 = {
								owner = { original_tag = FRA }
							}
						}
						set_state_controller = 32
					}
					if = {
						limit = {
							735 = {
								owner = { original_tag = FRA }
							}
						}
						set_state_controller = 735
					}
					if = {
						limit = {
							21 = {
								owner = { original_tag = FRA }
							}
						}
						set_state_controller = 21
					}
					if = {
						limit = {
							31 = {
								owner = { original_tag = FRA }
							}
						}
						set_state_controller = 31
					}
			}
			start_civil_war = {
				ideology = neutrality
				size = 0.5
				capital = 26
				states = { 26 21 22 31 25 20 32 33 1 735 677 680 554 458 462 461 513 459 460 665 553 272 556 543 706 708 713 268 557 514 515 }
				states_filter = {
					owner = { original_tag = FRA }
					OR = {
						# lets not involve syria or tunisia in civil war flip if occupied by other party
						AND = {
							OR = {
								state = 554
								state = 680
								state = 677
								state = 458
							}
							controller = { # FRA not controller
								original_tag = FRA
							}
						}
						NOT = {
							OR = {
								state = 554
								state = 680
								state = 677
								state = 458
							}
						}
					}
				}
			}
		}
		random_other_country = {
			limit = { original_tag = FRA has_government = neutrality }
			ROOT = { puppet = PREV }
			set_capital = { state = 26 }
			set_politics = {
				ruling_party = neutrality
				elections_allowed = no
			}
			set_popularities = {
				democratic = 22
				neutrality = 60
				fascism = 16
				communism = 2
			}
			if = {
				limit = {
					FRN = {
						exists = yes
						OR = {
							is_subject_of = ROOT
							is_subject_of = FRA
						}
					}
				}
				annex_country = { target = FRN }
			}
			if = {
				limit = {
					FRT = {
						exists = yes
						OR = {
							is_subject_of = ROOT
							is_subject_of = FRA
						}
					}
				}
				annex_country = { target = FRT }
			}
			if = {
				limit = {
					FRM = {
						exists = yes
						OR = {
							is_subject_of = ROOT
							is_subject_of = FRA
						}
					}
				}
				annex_country = { target = FRM }
			}
			if = {
				limit = {
					FRS = {
						exists = yes
						OR = {
							is_subject_of = ROOT
							is_subject_of = FRA
						}
					}
				}
				annex_country = { target = FRS }
			}
			if = {
				limit = {
					FRW = {
						exists = yes
						OR = {
							is_subject_of = ROOT
							is_subject_of = FRA
						}
					}
				}
				annex_country = { target = FRW }
			}
			if = {
				limit = {
					FRC = {
						exists = yes
						OR = {
							is_subject_of = ROOT
							is_subject_of = FRA
						}
					}
				}
				annex_country = { target = FRC }
			}
			if = {
				limit = {
					FRP = {
						exists = yes
						OR = {
							is_subject_of = ROOT
							is_subject_of = FRA
						}
					}
				}
				annex_country = { target = FRP }
			}
			if = {
				limit = {
					FRJ = {
						exists = yes
						OR = {
							is_subject_of = ROOT
							is_subject_of = FRA
						}
					}
				}
				annex_country = { target = FRJ }
			}
			if = {
				limit = {
					FRI = {
						exists = yes
						OR = {
							is_subject_of = ROOT
							is_subject_of = FRA
						}
					}
				}
				annex_country = { target = FRI }
			}
			if = {
				limit = {
					FRV = {
						exists = yes
						OR = {
							is_subject_of = ROOT
							is_subject_of = FRA
						}
					}
				}
				annex_country = { target = FRV }
			}
			transfer_state = 514
			# FRA Player Switches to Vichy
			if = {
				limit = { FRA = { has_country_flag = become_vichy } }
				change_tag_from = FRA
			}
			save_event_target_as = vichy_france
		}
		news_event = { hours = 6 id = news.34 }
	}

	option = { # Conquer everything!
		name = france.14.b
		ai_chance = {
			factor = 50
			modifier = {
				is_historical_focus_on = yes
				factor = 0
			}
		}
		FRA = {
			country_event = { hours = 6 id = france.15 }
		}
	}
}

# Germany refuses armistice! (France)
country_event = {
	id = france.15
	title = france.15.t
	desc = france.15.d
	picture = GFX_report_event_french_resistance_01

	is_triggered_only = yes

	option = {
		name = france.15.a
	}
}

#Capital captured by non french faction
country_event = {
	id = france.16
	title = france.16.t
	desc = france.16.d
	picture = GFX_report_event_french_resistance_02

	fire_only_once = yes

	trigger = {
		original_tag = FRA
		855 = { controller = { NOT = { original_tag = FRA } } }
		has_capitulated = yes
		#16 = { is_owned_by = FRA }
	}

	mean_time_to_happen = {
		days = 4
	}

	option = {
		name = france.16.a
		FRA_remove_disjointed_government = yes
		FRA_disjointed_government_level = yes
	}
}

# Invitation to French Faction
country_event = {
	id = france.17
	title = france.17.t
	desc = france.17.d
	picture = GFX_report_event_worried_french

	is_triggered_only = yes

	option = {
		name = france.17.a
		ai_chance = { factor = 90 }
		FRA = {
			country_event = france.18
			add_to_faction = ROOT
		}
		add_ai_strategy = {
			type = alliance
			id = "FRA"
			value = 200
		}
	}

	option = {
		name = france.17.b
		ai_chance = { factor = 10 }
		FRA = { country_event = france.19 }
	}
}

# [Country] Accepts
country_event = {
	id = france.18
	title = france.18.t
	desc = france.18.d
	picture = GFX_report_event_soldiers_in_france

	is_triggered_only = yes

	option = {
		name = france.18.a
		effect_tooltip = {
			add_to_faction = FROM
		}
	}
}

# [Country] Refuses
country_event = {
	id = france.19
	title = france.19.t
	desc = france.19.d
	picture = GFX_report_event_finnish_letter

	is_triggered_only = yes

	option = {
		name = france.19.a
	}
}

# De Gaulle becomes leader
country_event = {
	id = france.20
	title = france.20.t
	desc = france.20.d
	picture = GFX_report_event_degaulle_churchill

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						has_country_flag = FRA_annexed_overseas
					}
				}
				annex_country = {
					target = FRO
				}
			}
			if = {
				limit = {
					country_exists = VIC
				}
				VIC = { transfer_state = 320 }
			}
			transfer_state = 635
			transfer_state = 734
			transfer_state = 641
			set_capital = {
				state = 635
			}
			add_country_leader_role = {
				character = FRA_charles_de_gaulle
				country_leader = {
					expire = "1965.1.1"
					ideology = conservatism
					traits = { patriot }
			 	}
			}
			promote_character = FRA_charles_de_gaulle
			deactivate_advisor = FRA_rene_massigli
			deactivate_advisor = FRA_georges_bonnet
			deactivate_advisor = FRA_paul_baudouin
			deactivate_advisor = FRA_paul_reynaud
			deactivate_advisor = FRA_marx_dormoy
			deactivate_advisor = FRA_albert_sarraut
			deactivate_advisor = FRA_georges_mandel
			deactivate_advisor = FRA_pierre_pucheu
			deactivate_advisor = FRA_vincent_auriol
			deactivate_advisor = FRA_paul_marchandeau
			deactivate_advisor = FRA_lucien_lamoureux
			deactivate_advisor = FRA_charles_tillon
			deactivate_advisor = FRA_albert_bedouce
			deactivate_advisor = FRA_henri_queuille
			deactivate_advisor = FRA_maurice_gauche
			deactivate_advisor = FRA_felix_gouin
			deactivate_advisor = FRA_charles_maurras
			deactivate_advisor = FRA_jacques_duclos
			deactivate_advisor = FRA_roger_salengro
			deactivate_advisor = FRA_edouard_daladier
			set_cosmetic_tag = FRA_FREE
			set_country_flag = france_de_gaulle
			if = {
				limit = {
					check_variable = { FRA_Army_national_unity = 3 compare = equals }
				}
				VIC = {
					transfer_units_fraction = {
						target = FRA
						stockpile_ratio = 0
						army_ratio = 0.15
						air_ratio = 0
						navy_ratio = 0
						keep_unit_leaders_trigger = {
							always = yes
						}
					}
				}
			}
			else_if = {
				limit = {
					check_variable = { FRA_Army_national_unity = 2 compare = equals }
				}
				VIC = {
					transfer_units_fraction = {
						target = FRA
						stockpile_ratio = 0
						army_ratio = 0.10
						air_ratio = 0
						navy_ratio = 0
						keep_unit_leaders_trigger = {
							always = yes
						}
					}
				}
			}
			else = {
				VIC = {
					transfer_units_fraction = {
						target = FRA
						stockpile_ratio = 0
						army_ratio = 0.05
						air_ratio = 0
						navy_ratio = 0
						keep_unit_leaders_trigger = {
							always = yes
						}
					}
				}
			}
			FRA = {
				transfer_navy = { target = VIC }
			}
			if = {
				limit = {
					check_variable = { FRA_Airforce_national_unity = 3 compare = equals }
				}
				VIC = {
					send_equipment = {
						target = FRA
						type = fighter_equipment
						amount = 500
					}
					send_equipment = {
						target = FRA
						type = CAS_equipment
						amount = 300
					}
					send_equipment = {
						target = FRA
						type = attacker_equipment
						amount = 100
					}
					send_equipment = {
						target = FRA
						type = tac_bomber_equipment
						amount = 500
					}
					send_equipment = {
						target = FRA
						type = strat_bomber_equipment
						amount = 200
					}
					send_equipment = {
						target = FRA
						type = scout_plane_equipment
						amount = 100
					}
				}
			}
			else_if = {
				limit = {
					check_variable = { FRA_Airforce_national_unity = 2 compare = equals }
				}
				VIC = {
					send_equipment = {
						target = FRA
						type = fighter_equipment
						amount = 250
					}
					send_equipment = {
						target = FRA
						type = CAS_equipment
						amount = 150
					}
					send_equipment = {
						target = FRA
						type = attacker_equipment
						amount = 50
					}
					send_equipment = {
						target = FRA
						type = tac_bomber_equipment
						amount = 250
					}
					send_equipment = {
						target = FRA
						type = strat_bomber_equipment
						amount = 100
					}
					send_equipment = {
						target = FRA
						type = scout_plane_equipment
						amount = 50
					}
				}
			}
			if = {
				limit = {
					check_variable = { FRA_Navy_national_unity = 3 compare = equals }
					has_dlc = "Man the Guns"
				}
				VIC = {
					transfer_ship = {
						prefer_name = "Béarn"
						type = carrier
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Richelieu"
						type = battleship
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Lorraine"
						type = battleship
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Paris"
						type = battleship
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Courbet"
						type = battleship
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Duquesne"
						type = heavy_cruiser
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Tourville"
						type = heavy_cruiser
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Pluton"
						type = light_cruiser
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Primauguet"
						type = light_cruiser
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Léopard"
						type = destroyer
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Tigre"
						type = destroyer
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Le Triomphant"
						type = destroyer
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Albatros"
						type = destroyer
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Vautour"
						type = destroyer
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Mistral"
						type = frigate
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Ouragan"
						type = frigate
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Savorgnan de Brazza"
						type = frigate
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Narval"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Archimède"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Argo"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Casabianca"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Le Centaure"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Le Glorieux"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Protée"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Surcouf"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Rubis"
						type = submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Iris"
						type = submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Junon"
						type = submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Minerve"
						type = submarine
						target = FRA
						exclude_refitting = no
					}
				}
			}
			else_if = {
				limit = {
					check_variable = { FRA_Navy_national_unity = 2 compare = equals }
					has_dlc = "Man the Guns"
				}
				VIC = {
					transfer_ship = {
						prefer_name = "Béarn"
						type = carrier
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Lorraine"
						type = battleship
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Paris"
						type = battleship
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Courbet"
						type = battleship
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Léopard"
						type = destroyer
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Tigre"
						type = destroyer
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Le Triomphant"
						type = destroyer
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Mistral"
						type = frigate
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Ouragan"
						type = frigate
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Savorgnan de Brazza"
						type = frigate
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Narval"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Archimède"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Argo"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Casabianca"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Le Centaure"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Le Glorieux"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Protée"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Surcouf"
						type = cruiser_submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Rubis"
						type = submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Iris"
						type = submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Junon"
						type = submarine
						target = FRA
						exclude_refitting = no
					}
					transfer_ship = {
						prefer_name = "Minerve"
						type = submarine
						target = FRA
						exclude_refitting = no
					}
				}
			}

			#Vichy is Disarmed
			VIC = {
				delete_unit = {
					disband = yes
				}
				send_equipment_fraction = {
					value = 0.75
					target = GER
				}
				activate_mission = economy_fatigue_civilian_economy_mission
				activate_mission = economy_fatigue_export_focus_mission
				activate_mission = economy_fatigue_volunteer_only_mission
			}

			#notify germany
			GER = {
				country_event = france.206
			}
		}
	}

	option = {
		name = france.20.a
		trigger = {
			has_dlc = "La Resistance"
		}
		custom_effect_tooltip = free_france_creation_tt
		load_focus_tree = free_french_focus
		add_ideas = FRA_quasi_legitimate_france_1
	}

	option = {
		name = france.20.a
		trigger = {
			NOT = { has_dlc = "La Resistance" }
		}
		custom_effect_tooltip = france.20.a_tt
	}
}


# Germany notice about captured equipment
country_event = {
	id = france.206
	title = france.206.t
	desc = france.206.d
	picture = GFX_report_event_soldier_surrender

	is_triggered_only = yes

	option = {
		name = france.206.a
		custom_effect_tooltip = france.206.a_tt
	}
}

# French strikes
country_event = {
	id = france.21
	title = france.21.t
	desc = france.21.d
	picture = GFX_report_event_worker_protests

	trigger = {
		tag = FRA
		date > 1936.5.26
	}

	fire_only_once = yes

	mean_time_to_happen = {	days = 1 }

	option = {
		ai_chance = {
			base = 1
		}
		name = france.21.a
		add_timed_idea = {
			idea = FRA_factory_strikes
			days = 360
		}
	}
}

# French strikes
country_event = {
	id = france.22
	title = france.21.t
	desc = france.21.d
	picture = GFX_report_event_worker_protests

	is_triggered_only = yes

	option = {
		ai_chance = {
			base = 15
		}
		name = france.21.a
		add_timed_idea = {
			idea = FRA_factory_strikes
			days = 60
		}
		hidden_effect = {
			country_event = { id = france.23 days = 60 }
		}
	}

	option = {
		ai_chance = {
			base = 85
		}
		name = france.21.b
		add_political_power = -50
	}
}

# Strikes are over
country_event = {
	id = france.23
	title = france.23.t
	desc = france.23.d
	picture = GFX_report_event_airplane_factory

	is_triggered_only = yes

	fire_only_once = yes

	option = {
		name = france.23.a
	}
}

# French ban on communism
#country_event = {
#	id = france.24
#	title = france.24.t
#	desc = france.24.d
#	picture = GFX_report_event_molotov_ribentrop_handshake
#
#
#	trigger = {
#		tag = FRA
#		SOV = { has_government = communism }
#		has_government = democratic
#		communism < 0.5
#		has_global_flag = sov_yes_pact
#	}
#
#	fire_only_once = yes
#
#	mean_time_to_happen = {	days = 2	}
#
#	option = {
#		ai_chance = {	factor = 10 }
#		add_political_power = -20
#		name = france.24.a
#		add_popularity = {
#			ideology = communism
#			popularity = -0.3
#		}
#		add_ideas = FRA_communism_banned
#
#		add_opinion_modifier = {
#			target = SOV
#			modifier = FRA_ban_communism
#		}
#
#		every_other_country = {
#			limit = {
#				has_government = communism
#			}
#			add_opinion_modifier = {
#				target = FRA
#				modifier = FRA_ban_communism
#			}
#		}
#		hidden_effect = {
#			news_event = { id = news.161 hours = 6 }
#		}
#
#	}
#	option = {
#		ai_chance = {	factor = 0 }
#		name = france.24.b
#	}
#}

# British abandon yugoslavia
country_event = {
	id = france.25
	title = france.25.t
	desc = france.25.d
	picture = GFX_report_event_hitler_croatia_handshake

	is_triggered_only	= yes
	option = { # Follow Britain's lead
		name = france.25.a
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0
				is_in_faction_with = YUG
			}
		}
		if = {
			limit = {
				has_guaranteed = YUG
			}
			diplomatic_relation = {
   				country = YUG
   				relation = guarantee
   				active = no
  			}
		}
		if = {
			limit = {
				ITA = {
					OR = {
						NOT = { is_in_faction_with = YUG }
						is_in_faction_with = GER
						exists = no
					}
				}
			}
			YUG = {
				add_opinion_modifier = { target = FRA modifier = western_betrayal }
				country_event = { id = yugoslavia.5 hours = 6 }
			}
		}
		if = {
			limit = {
				ITA = {
					is_in_faction_with = YUG
					NOT = { is_in_faction_with = GER }
					NOT = { has_war_with = YUG }
				}
			}
			ITA = { country_event = { id = italy.12 } }
		}
	}
	option = { # Support the Yugoslavs alone
		name = france.25.b
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				is_in_faction_with = GER
			}
		}
		add_political_power = -200
		add_opinion_modifier = { target = GER modifier = condemn_aggression }
		YUG = {
			country_event = { id = yugoslavia.4 days = 1 }
			add_opinion_modifier = { target = FRA modifier = offered_support }
		}
		GER = {
			country_event = { id = germany.97 hours = 6 } #Generate wargoal
			effect_tooltip = {
				create_wargoal = {
					type = take_state_focus
					target = YUG
					generator = { 887 }
				}
			}
		}
		if = {
			limit = { is_in_faction_with = ENG }
			ENG = {
				country_event = { id = britain.15 hours = 6 }
				remove_from_faction = FRA
			}
		}
		if = {
			limit = { is_in_faction_with = GER }
			GER = {
				remove_from_faction = FRA
			}
		}
		if = {
			limit = {
				is_in_faction = yes
				is_faction_leader = yes
				NOT = { is_in_faction_with = ENG }
				NOT = { is_in_faction_with = GER }
			}
			add_to_faction = YUG
			YUG = {
				add_ai_strategy = {
					type = alliance
					id = "FRA"
					value = 200
				}
			}
		}
		if = {
			limit = {
				OR = {
					is_in_faction = no
					is_faction_leader = no
					is_in_faction_with = ENG
					is_in_faction_with = GER
				}
			}
			create_faction = "french_alliance"
			add_to_faction = YUG
			YUG = {
				add_ai_strategy = {
					type = alliance
					id = "FRA"
					value = 200
				}
			}
		}
		if = {
			limit = { NOT = { has_completed_focus = FRA_ratify_the_entente } }
			add_stability = 0.05
		}
	}
}

# British support yugoslavia
country_event = {
	id = france.26
	title = france.26.t
	desc = france.26.d
	picture = GFX_report_event_hitler_croatia_handshake

	is_triggered_only	= yes

	option = {
		name = france.26.a
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0
				is_in_faction_with = GER
			}
		}
		if = {
			limit = {
				is_in_faction = yes
				NOT = { is_in_faction_with = ENG }
			}
			remove_from_faction = FRA
		}
		if = {
			limit = { NOT = { is_in_faction_with = ENG } }
			ENG = { add_to_faction = FRA }
			FRA = {
				add_ai_strategy = {
					type = alliance
					id = "ENG"
					value = 200
				}
			}
		}
		add_opinion_modifier = { target = GER modifier = condemn_aggression }
		YUG = {
			country_event = { id = yugoslavia.3 days = 1 }
			add_opinion_modifier = { target = FRA modifier = offered_support }
		}
		GER = {
			country_event = { id = germany.93 hours = 6 } #Generate wargoal
			effect_tooltip = {
				create_wargoal = {
					type = take_state_focus
					target = YUG
					generator = { 887 }
				}
			}
		}
	}

	#Abandon
	option = {
		name = france.26.b
		trigger = { NOT = { is_in_faction_with = ENG } }
		ai_chance = { factor = 10 }
		set_global_flag = FRA_abandoned_yugoslavia
		if = {
			limit = {
				has_guaranteed = YUG
			}
			diplomatic_relation = {
   				country = YUG
   				relation = guarantee
   				active = no
  			}
		}
		YUG = {
			country_event = { id = yugoslavia.3 hours = 6 }
			add_opinion_modifier = { target = FRA modifier = western_betrayal }
		}
	}
}

# Vichy France: Germany is handing over some of our land
country_event = {
	id = france.27
	title = france.27.t
	desc = {
		text = france.27.d_1_state
		trigger = {
			OR = {
				NOT = { has_global_flag = ITA_claims_on_france_735 }
				has_global_flag = ITA_claims_on_france_1
			}
			OR = {
				has_global_flag = ITA_claims_on_france_735
				NOT = { has_global_flag = ITA_claims_on_france_1 }
			}
		}
	}
	desc = {
		text = france.27.d_both
		trigger = {
			has_global_flag = ITA_claims_on_france_735
			has_global_flag = ITA_claims_on_france_1
		}
	}
	picture = GFX_report_event_worried_french

	is_triggered_only	= yes

	option = {
		name = france.27.a

		effect_tooltip = {
			if = {
				limit = { has_global_flag = ITA_claims_on_france_735 }
				ITA = { transfer_state = 735 }
			}
			if = {
				limit = { has_global_flag = ITA_claims_on_france_1 }
				ITA = { transfer_state = 1 }
			}
		}

		if = {
			limit = {
				has_global_flag = ITA_claims_on_france_735
				has_global_flag = ITA_claims_on_france_1
				OR = {
					owns_state = 554
					owns_state = 677
					owns_state = 680
				}

			}
			random_other_country = {
				limit = {
					original_tag = FRA
					has_government = democratic
				}
				if = {
					limit = { ROOT = { owns_state = 554 } }
					transfer_state = 554
				}
				if = {
					limit = { ROOT = { owns_state = 677 } }
					transfer_state = 677
				}
				if = {
					limit = { ROOT = { owns_state = 680 } }
					transfer_state = 680
				}
				country_event = france.28
			}
		}
	}

}

# France - Syria defects to us
country_event = {
	id = france.28
	title = france.28.t
	desc = france.28.d
	picture = GFX_report_event_worried_french

	is_triggered_only	= yes

	option = {
		name = france.28.a
	}

}

# France - Britain accepts Ally request
country_event = {
	id = france.29
	title = france.29.t
	desc = france.29.d
	picture = GFX_report_event_generic_sign_treaty2

	is_triggered_only = yes

	option = {
		name = france.29.a
	}
}

# France - Britain denies Ally request
country_event = {
	id = france.30
	title = france.30.t
	desc = france.30.d
	picture = GFX_report_event_chamberlain

	is_triggered_only	= yes

	option = {
		name = france.30.a
	}
}

# Hidden event to add AI values for nationalist spain if France is going fascist
country_event = {
    id = france.32
    hidden = yes

    fire_only_once = yes

    is_triggered_only = yes

    immediate = {
    	if = {
    		limit = {
    			NOT = { has_dlc = "La Resistance" }
    		}
    		random_other_country = {
				limit = {
					original_tag = SPR
					has_government = fascism
				}
				FRA = {
					add_ai_strategy = {
						type = befriend
						id = PREV
						value = 200
					}
				}
			}
    	}
    	if = {
    		limit = {
    			has_dlc = "La Resistance"
    		}
			FRA = {
            	add_ai_strategy = {
            		type = befriend
            		id = "SPA"
               		value = 200
            	}
			}
    	}
    }

    option = {
        name = france.32.a
     }
}

# Britain is at peace after annexing France in the Franco-British Union
# AI will tend to release France if historic mode is on or they are democratic

country_event = {
	id = france.33
	title = france.33.title
	desc = france.33.desc

	picture = GFX_report_event_generic_peaceful_annexation

	fire_only_once = yes

	trigger = {
		tag = ENG
		has_war = no
		is_subject = no
		has_global_flag = flag_franco_british_union
		any_owned_state = {
			is_core_of = FRA
		}
	}

	mean_time_to_happen = {
		months = 1
	}

	option = { # Release
		name = france.33.a

		if = {
			limit = {
				has_cosmetic_tag = FRA_UK
			}
			drop_cosmetic_tag = yes
		}

		if = {
			limit = {
				NOT = { country_exists = FRA }
			}
			if = {
				limit = {
					has_government = democratic
				}
				FRA = {
					set_politics = {
						ruling_party = democratic
						elections_allowed = yes
					}
					set_popularities = {
						democratic = 60
						fascism = 20
						communism = 20
					}
				}
			}
			if = {
				limit = {
					has_government = fascism
				}
				FRA = {
					set_politics = {
						ruling_party = fascism
						elections_allowed = no
					}
					set_popularities = {
						democratic = 20
						fascism = 60
						communism = 20
					}
				}
			}
			if = {
				limit = {
					has_government = communism
				}
				FRA = {
					set_politics = {
						ruling_party = communism
						elections_allowed = no
					}
					set_popularities = {
						democratic = 20
						fascism = 20
						communism = 60
					}
				}
			}
			if = {
				limit = {
					has_government = neutrality
				}
				FRA = {
					set_politics = {
						ruling_party = neutrality
						elections_allowed = no
					}
					set_popularities = {
						democratic = 15
						neutrality = 55
						fascism = 15
						communism = 15
					}
				}
			}
			release = FRA

			set_autonomy = { target = FRA autonomy_state = autonomy_free }
		}

		every_state = {
			limit = {
				is_core_of = ENG
				is_core_of = FRA
			}
			remove_core_of = ENG
		}

		hidden_effect = { # This looks odd in the tooltip
			every_other_country = {
				limit = {
					is_subject_of = ENG
				}
				every_owned_state = {
					limit = {
						is_core_of = FRA
					}
					FRA = {
						transfer_state = PREV
					}
				}
			}
		}

		if = {
			limit = {
				is_faction_leader = yes
				FRA = {
					is_subject = no
					is_in_faction = no
				}
			}
			add_to_faction = FRA
		}

		every_unit_leader = {
			limit = {
				has_unit_leader_flag = {
					flag = flag_former_french_general
				}
			}
			set_nationality = FRA
		}

		hidden_effect =  {
			news_event = { id = france.34 days = 1 }
		}

		ai_chance = {
			factor = 60

			modifier = {
				factor = 2
				has_government = democratic
			}
		}
	}

	option = { # Don't release
		name = france.33.b

		add_war_support = -0.1
		add_stability = -0.2

		every_state = {
			limit = {
				is_core_of = ENG
				is_core_of = FRA
			}
			remove_core_of = ENG
		}

		every_unit_leader = {
			limit = {
				has_unit_leader_flag = {
					flag = flag_former_french_general
				}
			}
			set_nationality = FRA
		}

		ai_chance = {
			factor = 40

			modifier = {
				factor = 0.5
				has_stability < 0.5
			}
			modifier = {
				factor = 0.5
				has_war_support < 0.5
			}
			modifier = {
				factor = 2
				has_government = fascism
			}
			modifier = {
				factor = 0.5
				is_historical_focus_on = yes
			}
		}
	}
}

# News event for the release of France

news_event = {
	id = france.34
	title = france.34.title
	desc = france.34.desc

	picture = GFX_news_event_degaulle_churchill

	is_triggered_only = yes

	option = {
		name = france.34.a
		trigger = {
			OR = {
				tag = ENG
				tag = FRA
				is_in_faction_with = ENG
				is_subject_of = ENG
			}
		}
	}

	option = {
		name = france.34.b
		trigger = {
			NOT = {
				OR = {
					tag = ENG
					tag = FRA
					is_in_faction_with = ENG
					is_subject_of = ENG
				}
			}
		}
	}
}

# Laval Ribbentrop Pact
country_event = {
	id = france.37
	title = france.37.t
	desc = france.37.d
	picture = GFX_report_event_molotov_ribentrop_handshake

	is_triggered_only = yes

	option = {
		name = france.37.a	#sounds good
		ai_chance = {
			factor = 80
		}
		add_opinion_modifier = { target = FRA modifier = LR_pact }# pact
		FRA = {
			country_event = { days = 1 id = france.35 }
			effect_tooltip = {
				add_opinion_modifier = { target = GER modifier = LR_pact }# pact
			}
		}
	}

	option = {
		name = france.37.b	#no way
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0
				is_in_faction_with = GER
			}
		}
		add_political_power = -50
		add_opinion_modifier = { target = FRA modifier = refused_LR_pact }# no pact
		FRA = {
			country_event = { days = 1 id = france.36 }
		}
	}
}

# Soviets Sign MR Pact
country_event = {
	id = france.35
	title = france.35.t
	desc = france.35.d
	picture = GFX_report_event_molotov_signing_pact

	is_triggered_only = yes

	option = {
		name = france.35.a	#neat
		diplomatic_relation = { country = GER relation = non_aggression_pact }
		add_opinion_modifier = { target = GER modifier = LR_pact }# pact
	}
}

# Soviets Reject MR Pact
country_event = {
	id = france.36
	title = france.36.t
	desc = france.36.d
	picture = GFX_report_event_worried_french

	is_triggered_only = yes

	option = {
		name = france.36.a	#bah
		add_opinion_modifier = { target = GER modifier = refused_LR_pact }# no pact
	}
}

country_event = {
	id = france.38
	hidden = yes

	fire_only_once = yes

	trigger = {
		tag = FRA
		date > 1939.1.1
		has_idea = FRA_protected_by_the_maginot_line
	}

	immediate = {
		remove_ideas = FRA_protected_by_the_maginot_line
		add_ideas = FRA_protected_by_the_maginot_line_1
	}
}