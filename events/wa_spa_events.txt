add_namespace = spa_armor

### End of unplanned offensives

country_event = {
	id = spa_armor.801
	hidden = yes

	mean_time_to_happen = { days = 1 }

	fire_only_once = yes

	trigger = {
		tag = SPR
		date > 1939.1.1
		has_dlc = "La Resistance"
		NOT = { has_global_flag = scw_early_end }
		NOT = { has_global_flag = scw_over }
	}

	immediate = {
		every_state = {
			limit = {
				OR = {
					state = 41
					state = 165
					state = 166
					state = 167
					state = 168
					state = 169
					state = 170
					state = 171
					state = 172
					state = 173
					state = 174
					state = 175
					state = 176
					state = 796
					state = 864
					state = 865
					state = 866
					state = 867
					state = 868
					state = 956
				}
			}
			clr_state_flag = SPR_unplanned_offensive_flag
			remove_province_modifier = {
				static_modifiers = { unplanned_offensive }
				province = {
					all_provinces = yes
				}
			}
		}
		every_other_country = {
			limit = {
				original_tag = SPR
				has_war = yes
			}
			country_event = { id = spa_armor.802 }
		}
	}

	option = {}

}
country_event = {
	id = spa_armor.802
	title = spa_armor.802.t
	desc = spa_armor.802.d
	picture = GFX_report_event_spr_nationalist_soldiers

	is_triggered_only = yes

	option = {
		name = spa_armor.802.a
		custom_effect_tooltip = spa_armor.802.a_tt
	}
}

country_event = {
	id = spa_armor.803
	title = spa_armor.803.t
	desc = spa_armor.803.d

	is_triggered_only = yes

	option = {
		name = spa_armor.803.a
		army_experience = 10
	}
}

country_event = {
	id = spa_armor.804
	title = spa_armor.804.t
	desc = spa_armor.804.d

	is_triggered_only = yes

	option = {
		name = spa_armor.804.a
	}
}

### Famine Events

#Actual Famine Event

country_event = {
	id = spa_armor.805
	hidden = yes

	mean_time_to_happen = { days = 1 }

	fire_only_once = yes

	trigger = {
		tag = SPA
		has_idea = SPR_agricultural_mishandlement_2
		date > 1936.1.1
	}

	immediate = {
		country_event = { id = spa_armor.806 days = 365 }
	}

	option = {}

}
country_event = {
	id = spa_armor.806
	title = spa_armor.806.t
	desc = spa_armor.806.d

	is_triggered_only = yes

	trigger = {
		has_idea = SPR_agricultural_mishandlement_2
		NOT = { has_idea = SPR_usa_food_imports }
		NOT = { has_idea = SPR_sov_food_imports }
		NOT = { has_idea = SPR_ger_food_imports }
	}

	immediate = {
		hidden_effect = {
			swap_ideas = {
				remove_idea = SPR_agricultural_mishandlement_2
				add_idea = SPR_agricultural_mishandlement
			}
			add_timed_idea = { idea = SPR_famine days = 540 }
		}
	}

	option = {
		name = spa_armor.806.a
		effect_tooltip = {
			swap_ideas = {
				remove_idea = SPR_agricultural_mishandlement_2
				add_idea = SPR_agricultural_mishandlement
			}
			add_timed_idea = { idea = SPR_famine days = 540 }
		}
	}
}

country_event = {
	id = spa_armor.807
	title = spa_armor.807.t
	desc = spa_armor.807.d

	is_triggered_only = yes

	trigger = {
		NOT = {
			OR = {
				has_idea = GER_famine_payments
				has_idea = GER_famine_payments_ukraine
			}
		}
	}

	immediate = {
	}

	option = {
		name = spa_armor.807.a
	}
}

### US Embargo

country_event = {
	id = spa_armor.810
	title = spa_armor.810.t
	desc = spa_armor.810.d

	picture = GFX_report_event_merchant_ship_01

	is_triggered_only = yes

	option = {
		name = spa_armor.810.a
		ai_chance = {
			factor = 25
		}
		add_ideas = SPA_equipment_and_export_bans
		if = {
			limit = {
				OR = {
					has_idea = free_trade
					has_idea = export_focus
				}
			}
			add_ideas = limited_exports
		}
	}

	option = {
		name = spa_armor.810.b
		ai_chance = {
			factor = 0
		}
		every_country = {
			limit = {
				OR = {
					tag = USA
					AND = {
						is_guaranteed_by = USA
						OR = {
							tag = BRA
							tag = ARG
							tag = CHL
							tag = BOL
							tag = URG
							tag = PRU
							tag = ECU
							tag = COL
							tag = VEN
							tag = PAR
							tag = GUA
							tag = ELS
							tag = HON
							tag = NIC
							tag = COS
							tag = PAN
							tag = CUB
							tag = HAI
							tag = DOM
							tag = JAM
							tag = BAH
							tag = BLZ
							tag = TRI
							tag = BAS
							tag = CRC
							tag = GDL
							tag = PUE
							tag = GYA
							tag = SUR
							tag = CAY
							tag = MEX
						}
					}
					is_in_faction_with = USA
				}
				NOT = { has_war_with = USA }
			}
			add_opinion_modifier = { target = ROOT modifier = embargo }
		}
	}
}

### Army of Africa

country_event = {
	id = spa_armor.811
	title = spa_armor.811.t
	desc = spa_armor.811.d

	#picture = GFX_report_event_merchant_ship_01

	is_triggered_only = yes

	option = {
		name = spa_armor.810.a
		trigger = {
			OR = {
				ITA = { has_completed_focus = ITA_triumph_in_africa }
				GER = { has_completed_focus = GER_rhineland }
			}
		}
		ai_chance = {
			factor = 1
		}
		if = {
			limit = {
				is_ai = yes
			}
			hidden_effect = {
				add_to_variable = { SPA_airlift_var = 3 }
			}
		}
		custom_effect_tooltip = spa_africa_army_airlift_tt
		activate_mission = SPA_africa_airlift
	}

	option = {
		name = spa_armor.810.b
		trigger = {
			NOT = {
				ITA = { has_completed_focus = ITA_triumph_in_africa }
				GER = { has_completed_focus = GER_rhineland }
			}
		}
		ai_chance = {
			factor = 1
		}
		if = {
			limit = {
				is_ai = yes
			}
			hidden_effect = {
				add_to_variable = { SPA_airlift_var = 3 }
			}
		}
		290 = {
			create_unit = {
				division = "division_template = \"División del Ejército de África\" start_experience_factor = 0.5"
				owner = SPA
				count = SPA_airlift_var
			}
		}
	}
}

###

country_event = {
	id = spa_armor.920
	hidden = yes

	mean_time_to_happen = { days = 1 }

	fire_only_once = yes

	trigger = {
		tag = SPD
		date > 1939.4.1
		num_of_controlled_states < 3
		NOT = { has_global_flag = scw_early_end }
		NOT = { has_global_flag = scw_over }
	}

	immediate = {
		add_timed_idea = {
			idea = SPR_death_before_surrender_capitulation
			days = 7
		}
	}

	option = {}
}

country_event = {
	id = spa_armor.921
	hidden = yes

	mean_time_to_happen = { days = 1 }

	fire_only_once = yes

	trigger = {
		tag = SPA
		date > 1939.4.1
		num_of_controlled_states < 3
		NOT = { has_global_flag = scw_early_end }
		NOT = { has_global_flag = scw_over }
	}

	immediate = {
		add_timed_idea = {
			idea = SPA_death_before_surrender_capitulation
			days = 7
		}
	}

	option = {}
}