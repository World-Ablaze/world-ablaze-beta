############################################################################################################
#	World Ablaze - Functional Test Framework
#	Generic test infrastructure: state management, pass/fail marking, timeout, print function
#	Tests are stored per-country, print function iterates all registered countries
############################################################################################################

### Test State Constants
@WA_TEST_NOT_LAUNCHED = 0
@WA_TEST_ONGOING = 1
@WA_TEST_PASSED = 2
@WA_TEST_FAILED = 3

### Configuration
@WA_TEST_TIMEOUT_DAYS = 120
@WA_TEST_TOTAL_TESTS = 8

############################################################################################################
#	REGISTER COUNTRY
#	Adds THIS to global.WA_TEST_registered_countries if not already present
#	Called by suite runners before init
############################################################################################################

WA_TEST_register_country = {
	# Check if THIS is already in the registry
	set_temp_variable = { _wt_already_registered = 0 }
	for_each_scope_loop = { array = global.WA_TEST_registered_countries
		if = { limit = { tag = PREV } set_temp_variable = { _wt_already_registered = 1 } }
	}
	if = {
		limit = { check_variable = { _wt_already_registered = 0 } }
		add_to_array = { global.WA_TEST_registered_countries = THIS.id }
		log = "[GetYear] [GetMonth] | TEST | [This.GetName] | REGISTRY: Country registered for testing"
	}
}

############################################################################################################
#	INIT
#	Resets test variables for tests that are NOT already PASSED
#	Preserves prior successes across re-runs
#	Runs in country scope
############################################################################################################

WA_TEST_init = {
	log = "[GetYear] [GetMonth] | TEST | [This.GetName] | INIT: Resetting non-PASSED test states"

	# Test 1
	if = { limit = { check_variable = { WA_TEST_state^1 = @WA_TEST_PASSED } }
		log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST 001: preserving previous PASS"
	}
	else = {
		set_variable = { WA_TEST_state^1 = @WA_TEST_NOT_LAUNCHED }
		set_variable = { WA_TEST_fail_code^1 = 0 }
		set_variable = { WA_TEST_launch_day^1 = 0 }
		set_variable = { WA_TEST_end_day^1 = 0 }
	}

	# Test 2
	if = { limit = { check_variable = { WA_TEST_state^2 = @WA_TEST_PASSED } }
		log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST 002: preserving previous PASS"
	}
	else = {
		set_variable = { WA_TEST_state^2 = @WA_TEST_NOT_LAUNCHED }
		set_variable = { WA_TEST_fail_code^2 = 0 }
		set_variable = { WA_TEST_launch_day^2 = 0 }
		set_variable = { WA_TEST_end_day^2 = 0 }
	}

	# Test 3
	if = { limit = { check_variable = { WA_TEST_state^3 = @WA_TEST_PASSED } }
		log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST 003: preserving previous PASS"
	}
	else = {
		set_variable = { WA_TEST_state^3 = @WA_TEST_NOT_LAUNCHED }
		set_variable = { WA_TEST_fail_code^3 = 0 }
		set_variable = { WA_TEST_launch_day^3 = 0 }
		set_variable = { WA_TEST_end_day^3 = 0 }
	}

	# Test 4
	if = { limit = { check_variable = { WA_TEST_state^4 = @WA_TEST_PASSED } }
		log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST 004: preserving previous PASS"
	}
	else = {
		set_variable = { WA_TEST_state^4 = @WA_TEST_NOT_LAUNCHED }
		set_variable = { WA_TEST_fail_code^4 = 0 }
		set_variable = { WA_TEST_launch_day^4 = 0 }
		set_variable = { WA_TEST_end_day^4 = 0 }
	}

	# Test 5
	if = { limit = { check_variable = { WA_TEST_state^5 = @WA_TEST_PASSED } }
		log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST 005: preserving previous PASS"
	}
	else = {
		set_variable = { WA_TEST_state^5 = @WA_TEST_NOT_LAUNCHED }
		set_variable = { WA_TEST_fail_code^5 = 0 }
		set_variable = { WA_TEST_launch_day^5 = 0 }
		set_variable = { WA_TEST_end_day^5 = 0 }
	}

	# Test 6
	if = { limit = { check_variable = { WA_TEST_state^6 = @WA_TEST_PASSED } }
		log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST 006: preserving previous PASS"
	}
	else = {
		set_variable = { WA_TEST_state^6 = @WA_TEST_NOT_LAUNCHED }
		set_variable = { WA_TEST_fail_code^6 = 0 }
		set_variable = { WA_TEST_launch_day^6 = 0 }
		set_variable = { WA_TEST_end_day^6 = 0 }
	}

	# Test 7
	if = { limit = { check_variable = { WA_TEST_state^7 = @WA_TEST_PASSED } }
		log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST 007: preserving previous PASS"
	}
	else = {
		set_variable = { WA_TEST_state^7 = @WA_TEST_NOT_LAUNCHED }
		set_variable = { WA_TEST_fail_code^7 = 0 }
		set_variable = { WA_TEST_launch_day^7 = 0 }
		set_variable = { WA_TEST_end_day^7 = 0 }
	}

	# Test 8
	if = { limit = { check_variable = { WA_TEST_state^8 = @WA_TEST_PASSED } }
		log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST 008: preserving previous PASS"
	}
	else = {
		set_variable = { WA_TEST_state^8 = @WA_TEST_NOT_LAUNCHED }
		set_variable = { WA_TEST_fail_code^8 = 0 }
		set_variable = { WA_TEST_launch_day^8 = 0 }
		set_variable = { WA_TEST_end_day^8 = 0 }
	}

	set_variable = { WA_TEST_suite_start_day = global.num_days }
	add_to_variable = { WA_TEST_suite_run_count = 1 }
}

############################################################################################################
#	MARK PASSED
#	Input: _wt_test_id (temp variable, 1-8)
#	Sets state to PASSED, records end_day
############################################################################################################

WA_TEST_mark_passed = {
	set_variable = { WA_TEST_state^_wt_test_id = @WA_TEST_PASSED }
	set_variable = { WA_TEST_end_day^_wt_test_id = global.num_days }
	log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST [?_wt_test_id]: PASSED"
}

############################################################################################################
#	MARK FAILED
#	Input: _wt_test_id, _wt_fail_code (temp variables)
#	Sets state to FAILED, records fail code and end_day
############################################################################################################

WA_TEST_mark_failed = {
	set_variable = { WA_TEST_state^_wt_test_id = @WA_TEST_FAILED }
	set_variable = { WA_TEST_fail_code^_wt_test_id = _wt_fail_code }
	set_variable = { WA_TEST_end_day^_wt_test_id = global.num_days }
	log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST [?_wt_test_id]: FAILED (code=[?_wt_fail_code])"
}

############################################################################################################
#	MARK SKIPPED
#	Input: _wt_test_id (temp variable)
#	Sets state to FAILED with fail_code=99, records end_day
############################################################################################################

WA_TEST_mark_skipped = {
	set_variable = { WA_TEST_state^_wt_test_id = @WA_TEST_FAILED }
	set_variable = { WA_TEST_fail_code^_wt_test_id = 99 }
	set_variable = { WA_TEST_end_day^_wt_test_id = global.num_days }
	log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST [?_wt_test_id]: SKIPPED (preconditions not met)"
}

############################################################################################################
#	CHECK TIMEOUT
#	Input: _wt_test_id (temp variable)
#	Fails ONGOING tests that have exceeded WA_TEST_TIMEOUT_DAYS
############################################################################################################

WA_TEST_check_timeout = {
	if = {
		limit = { check_variable = { WA_TEST_state^_wt_test_id = @WA_TEST_ONGOING } }

		set_temp_variable = { _wt_elapsed = global.num_days }
		subtract_from_temp_variable = { _wt_elapsed = WA_TEST_launch_day^_wt_test_id }

		if = {
			limit = { check_variable = { _wt_elapsed > @WA_TEST_TIMEOUT_DAYS } }
			set_temp_variable = { _wt_fail_code = 98 }
			WA_TEST_mark_failed = yes
			log = "[GetYear] [GetMonth] | TEST | [This.GetName] | TEST [?_wt_test_id]: TIMEOUT after [?_wt_elapsed] days"
		}
	}
}

############################################################################################################
#	LOG SUMMARY
#	Counts and logs the number of tests in each state for current country
############################################################################################################

WA_TEST_log_summary = {
	set_temp_variable = { _wt_count_passed = 0 }
	set_temp_variable = { _wt_count_failed = 0 }
	set_temp_variable = { _wt_count_skipped = 0 }
	set_temp_variable = { _wt_count_ongoing = 0 }
	set_temp_variable = { _wt_count_not_launched = 0 }

	# Test 1
	if = { limit = { check_variable = { WA_TEST_state^1 = @WA_TEST_PASSED } } add_to_temp_variable = { _wt_count_passed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^1 = @WA_TEST_FAILED } check_variable = { WA_TEST_fail_code^1 = 99 } } add_to_temp_variable = { _wt_count_skipped = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^1 = @WA_TEST_FAILED } } add_to_temp_variable = { _wt_count_failed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^1 = @WA_TEST_ONGOING } } add_to_temp_variable = { _wt_count_ongoing = 1 } }
	else = { add_to_temp_variable = { _wt_count_not_launched = 1 } }

	# Test 2
	if = { limit = { check_variable = { WA_TEST_state^2 = @WA_TEST_PASSED } } add_to_temp_variable = { _wt_count_passed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^2 = @WA_TEST_FAILED } check_variable = { WA_TEST_fail_code^2 = 99 } } add_to_temp_variable = { _wt_count_skipped = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^2 = @WA_TEST_FAILED } } add_to_temp_variable = { _wt_count_failed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^2 = @WA_TEST_ONGOING } } add_to_temp_variable = { _wt_count_ongoing = 1 } }
	else = { add_to_temp_variable = { _wt_count_not_launched = 1 } }

	# Test 3
	if = { limit = { check_variable = { WA_TEST_state^3 = @WA_TEST_PASSED } } add_to_temp_variable = { _wt_count_passed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^3 = @WA_TEST_FAILED } check_variable = { WA_TEST_fail_code^3 = 99 } } add_to_temp_variable = { _wt_count_skipped = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^3 = @WA_TEST_FAILED } } add_to_temp_variable = { _wt_count_failed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^3 = @WA_TEST_ONGOING } } add_to_temp_variable = { _wt_count_ongoing = 1 } }
	else = { add_to_temp_variable = { _wt_count_not_launched = 1 } }

	# Test 4
	if = { limit = { check_variable = { WA_TEST_state^4 = @WA_TEST_PASSED } } add_to_temp_variable = { _wt_count_passed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^4 = @WA_TEST_FAILED } check_variable = { WA_TEST_fail_code^4 = 99 } } add_to_temp_variable = { _wt_count_skipped = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^4 = @WA_TEST_FAILED } } add_to_temp_variable = { _wt_count_failed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^4 = @WA_TEST_ONGOING } } add_to_temp_variable = { _wt_count_ongoing = 1 } }
	else = { add_to_temp_variable = { _wt_count_not_launched = 1 } }

	# Test 5
	if = { limit = { check_variable = { WA_TEST_state^5 = @WA_TEST_PASSED } } add_to_temp_variable = { _wt_count_passed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^5 = @WA_TEST_FAILED } check_variable = { WA_TEST_fail_code^5 = 99 } } add_to_temp_variable = { _wt_count_skipped = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^5 = @WA_TEST_FAILED } } add_to_temp_variable = { _wt_count_failed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^5 = @WA_TEST_ONGOING } } add_to_temp_variable = { _wt_count_ongoing = 1 } }
	else = { add_to_temp_variable = { _wt_count_not_launched = 1 } }

	# Test 6
	if = { limit = { check_variable = { WA_TEST_state^6 = @WA_TEST_PASSED } } add_to_temp_variable = { _wt_count_passed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^6 = @WA_TEST_FAILED } check_variable = { WA_TEST_fail_code^6 = 99 } } add_to_temp_variable = { _wt_count_skipped = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^6 = @WA_TEST_FAILED } } add_to_temp_variable = { _wt_count_failed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^6 = @WA_TEST_ONGOING } } add_to_temp_variable = { _wt_count_ongoing = 1 } }
	else = { add_to_temp_variable = { _wt_count_not_launched = 1 } }

	# Test 7
	if = { limit = { check_variable = { WA_TEST_state^7 = @WA_TEST_PASSED } } add_to_temp_variable = { _wt_count_passed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^7 = @WA_TEST_FAILED } check_variable = { WA_TEST_fail_code^7 = 99 } } add_to_temp_variable = { _wt_count_skipped = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^7 = @WA_TEST_FAILED } } add_to_temp_variable = { _wt_count_failed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^7 = @WA_TEST_ONGOING } } add_to_temp_variable = { _wt_count_ongoing = 1 } }
	else = { add_to_temp_variable = { _wt_count_not_launched = 1 } }

	# Test 8
	if = { limit = { check_variable = { WA_TEST_state^8 = @WA_TEST_PASSED } } add_to_temp_variable = { _wt_count_passed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^8 = @WA_TEST_FAILED } check_variable = { WA_TEST_fail_code^8 = 99 } } add_to_temp_variable = { _wt_count_skipped = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^8 = @WA_TEST_FAILED } } add_to_temp_variable = { _wt_count_failed = 1 } }
	else_if = { limit = { check_variable = { WA_TEST_state^8 = @WA_TEST_ONGOING } } add_to_temp_variable = { _wt_count_ongoing = 1 } }
	else = { add_to_temp_variable = { _wt_count_not_launched = 1 } }

	log = "[GetYear] [GetMonth] | TEST | [This.GetName] | SUMMARY: [?_wt_count_passed] PASSED, [?_wt_count_failed] FAILED, [?_wt_count_skipped] SKIPPED, [?_wt_count_ongoing] ONGOING, [?_wt_count_not_launched] NOT_LAUNCHED"
}

############################################################################################################
#	PRINT ALL
#	Iterates global.WA_TEST_registered_countries and prints formatted results for each country
#	Called from any scope (uses for_each_scope_loop to scope into each country)
############################################################################################################

WA_TEST_print_all = {
	log = "====================================================================="
	log = "  WA TEST RESULTS"
	log = "====================================================================="

	if = {
		limit = { check_variable = { global.WA_TEST_registered_countries^num = 0 } }
		log = "  No countries registered for testing."
		log = "  Run d_WA_TEST_railway to launch the railway test suite."
	}
	else = {
		for_each_scope_loop = { array = global.WA_TEST_registered_countries

			log = "  COUNTRY: [This.GetName] - Suite run #[?WA_TEST_suite_run_count]"
			log = "  Started: day [?WA_TEST_suite_start_day] (days shown relative to start)"
			log = "---------------------------------------------------------------------"
			log = "  #   | Name                    | Status      | Code | +Launch  | +Resolved"

			### Test 001
			set_temp_variable = { _wt_s = WA_TEST_state^1 }
			set_temp_variable = { _wt_fc = WA_TEST_fail_code^1 }
			set_temp_variable = { _wt_ld = WA_TEST_launch_day^1 }
			subtract_from_temp_variable = { _wt_ld = WA_TEST_suite_start_day }
			set_temp_variable = { _wt_ed = WA_TEST_end_day^1 }
			subtract_from_temp_variable = { _wt_ed = WA_TEST_suite_start_day }
			if = { limit = { check_variable = { _wt_s = 2 } }
				log = "  001 | Land War                | PASSED      |    [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } check_variable = { _wt_fc = 99 } }
				log = "  001 | Land War                | SKIPPED     |   [?_wt_fc] | -        | -"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } }
				log = "  001 | Land War                | FAILED      |   [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 1 } }
				log = "  001 | Land War                | ONGOING     |    [?_wt_fc] | +[?_wt_ld]d    | -"
			}
			else = {
				log = "  001 | Land War                | NOT_LAUNCHED |    [?_wt_fc] | -        | -"
			}

			### Test 002
			set_temp_variable = { _wt_s = WA_TEST_state^2 }
			set_temp_variable = { _wt_fc = WA_TEST_fail_code^2 }
			set_temp_variable = { _wt_ld = WA_TEST_launch_day^2 }
			subtract_from_temp_variable = { _wt_ld = WA_TEST_suite_start_day }
			set_temp_variable = { _wt_ed = WA_TEST_end_day^2 }
			subtract_from_temp_variable = { _wt_ed = WA_TEST_suite_start_day }
			if = { limit = { check_variable = { _wt_s = 2 } }
				log = "  002 | Overseas Strategy       | PASSED      |    [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } check_variable = { _wt_fc = 99 } }
				log = "  002 | Overseas Strategy       | SKIPPED     |   [?_wt_fc] | -        | -"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } }
				log = "  002 | Overseas Strategy       | FAILED      |   [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 1 } }
				log = "  002 | Overseas Strategy       | ONGOING     |    [?_wt_fc] | +[?_wt_ld]d    | -"
			}
			else = {
				log = "  002 | Overseas Strategy       | NOT_LAUNCHED |    [?_wt_fc] | -        | -"
			}

			### Test 003
			set_temp_variable = { _wt_s = WA_TEST_state^3 }
			set_temp_variable = { _wt_fc = WA_TEST_fail_code^3 }
			set_temp_variable = { _wt_ld = WA_TEST_launch_day^3 }
			subtract_from_temp_variable = { _wt_ld = WA_TEST_suite_start_day }
			set_temp_variable = { _wt_ed = WA_TEST_end_day^3 }
			subtract_from_temp_variable = { _wt_ed = WA_TEST_suite_start_day }
			if = { limit = { check_variable = { _wt_s = 2 } }
				log = "  003 | Ryukyu Filter           | PASSED      |    [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } check_variable = { _wt_fc = 99 } }
				log = "  003 | Ryukyu Filter           | SKIPPED     |   [?_wt_fc] | -        | -"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } }
				log = "  003 | Ryukyu Filter           | FAILED      |   [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 1 } }
				log = "  003 | Ryukyu Filter           | ONGOING     |    [?_wt_fc] | +[?_wt_ld]d    | -"
			}
			else = {
				log = "  003 | Ryukyu Filter           | NOT_LAUNCHED |    [?_wt_fc] | -        | -"
			}

			### Test 004
			set_temp_variable = { _wt_s = WA_TEST_state^4 }
			set_temp_variable = { _wt_fc = WA_TEST_fail_code^4 }
			set_temp_variable = { _wt_ld = WA_TEST_launch_day^4 }
			subtract_from_temp_variable = { _wt_ld = WA_TEST_suite_start_day }
			set_temp_variable = { _wt_ed = WA_TEST_end_day^4 }
			subtract_from_temp_variable = { _wt_ed = WA_TEST_suite_start_day }
			if = { limit = { check_variable = { _wt_s = 2 } }
				log = "  004 | Pre-War Targets         | PASSED      |    [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } check_variable = { _wt_fc = 99 } }
				log = "  004 | Pre-War Targets         | SKIPPED     |   [?_wt_fc] | -        | -"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } }
				log = "  004 | Pre-War Targets         | FAILED      |   [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 1 } }
				log = "  004 | Pre-War Targets         | ONGOING     |    [?_wt_fc] | +[?_wt_ld]d    | -"
			}
			else = {
				log = "  004 | Pre-War Targets         | NOT_LAUNCHED |    [?_wt_fc] | -        | -"
			}

			### Test 005
			set_temp_variable = { _wt_s = WA_TEST_state^5 }
			set_temp_variable = { _wt_fc = WA_TEST_fail_code^5 }
			set_temp_variable = { _wt_ld = WA_TEST_launch_day^5 }
			subtract_from_temp_variable = { _wt_ld = WA_TEST_suite_start_day }
			set_temp_variable = { _wt_ed = WA_TEST_end_day^5 }
			subtract_from_temp_variable = { _wt_ed = WA_TEST_suite_start_day }
			if = { limit = { check_variable = { _wt_s = 2 } }
				log = "  005 | Queue Data Integrity    | PASSED      |    [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } check_variable = { _wt_fc = 99 } }
				log = "  005 | Queue Data Integrity    | SKIPPED     |   [?_wt_fc] | -        | -"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } }
				log = "  005 | Queue Data Integrity    | FAILED      |   [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 1 } }
				log = "  005 | Queue Data Integrity    | ONGOING     |    [?_wt_fc] | +[?_wt_ld]d    | -"
			}
			else = {
				log = "  005 | Queue Data Integrity    | NOT_LAUNCHED |    [?_wt_fc] | -        | -"
			}

			### Test 006
			set_temp_variable = { _wt_s = WA_TEST_state^6 }
			set_temp_variable = { _wt_fc = WA_TEST_fail_code^6 }
			set_temp_variable = { _wt_ld = WA_TEST_launch_day^6 }
			subtract_from_temp_variable = { _wt_ld = WA_TEST_suite_start_day }
			set_temp_variable = { _wt_ed = WA_TEST_end_day^6 }
			subtract_from_temp_variable = { _wt_ed = WA_TEST_suite_start_day }
			if = { limit = { check_variable = { _wt_s = 2 } }
				log = "  006 | Home Port Selection     | PASSED      |    [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } check_variable = { _wt_fc = 99 } }
				log = "  006 | Home Port Selection     | SKIPPED     |   [?_wt_fc] | -        | -"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } }
				log = "  006 | Home Port Selection     | FAILED      |   [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 1 } }
				log = "  006 | Home Port Selection     | ONGOING     |    [?_wt_fc] | +[?_wt_ld]d    | -"
			}
			else = {
				log = "  006 | Home Port Selection     | NOT_LAUNCHED |    [?_wt_fc] | -        | -"
			}

			### Test 007
			set_temp_variable = { _wt_s = WA_TEST_state^7 }
			set_temp_variable = { _wt_fc = WA_TEST_fail_code^7 }
			set_temp_variable = { _wt_ld = WA_TEST_launch_day^7 }
			subtract_from_temp_variable = { _wt_ld = WA_TEST_suite_start_day }
			set_temp_variable = { _wt_ed = WA_TEST_end_day^7 }
			subtract_from_temp_variable = { _wt_ed = WA_TEST_suite_start_day }
			if = { limit = { check_variable = { _wt_s = 2 } }
				log = "  007 | Supply Chain Analysis   | PASSED      |    [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } check_variable = { _wt_fc = 99 } }
				log = "  007 | Supply Chain Analysis   | SKIPPED     |   [?_wt_fc] | -        | -"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } }
				log = "  007 | Supply Chain Analysis   | FAILED      |   [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 1 } }
				log = "  007 | Supply Chain Analysis   | ONGOING     |    [?_wt_fc] | +[?_wt_ld]d    | -"
			}
			else = {
				log = "  007 | Supply Chain Analysis   | NOT_LAUNCHED |    [?_wt_fc] | -        | -"
			}

			### Test 008
			set_temp_variable = { _wt_s = WA_TEST_state^8 }
			set_temp_variable = { _wt_fc = WA_TEST_fail_code^8 }
			set_temp_variable = { _wt_ld = WA_TEST_launch_day^8 }
			subtract_from_temp_variable = { _wt_ld = WA_TEST_suite_start_day }
			set_temp_variable = { _wt_ed = WA_TEST_end_day^8 }
			subtract_from_temp_variable = { _wt_ed = WA_TEST_suite_start_day }
			if = { limit = { check_variable = { _wt_s = 2 } }
				log = "  008 | Single-Node Detection   | PASSED      |    [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } check_variable = { _wt_fc = 99 } }
				log = "  008 | Single-Node Detection   | SKIPPED     |   [?_wt_fc] | -        | -"
			}
			else_if = { limit = { check_variable = { _wt_s = 3 } }
				log = "  008 | Single-Node Detection   | FAILED      |   [?_wt_fc] | +[?_wt_ld]d    | +[?_wt_ed]d"
			}
			else_if = { limit = { check_variable = { _wt_s = 1 } }
				log = "  008 | Single-Node Detection   | ONGOING     |    [?_wt_fc] | +[?_wt_ld]d    | -"
			}
			else = {
				log = "  008 | Single-Node Detection   | NOT_LAUNCHED |    [?_wt_fc] | -        | -"
			}

			log = "---------------------------------------------------------------------"
			WA_TEST_log_summary = yes
			log = "  Fail codes: 98=TIMEOUT"
			log = "====================================================================="
		}
	}
}
