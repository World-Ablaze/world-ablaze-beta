SPR_the_inevitable_civil_war = {

	SPA_military_plot_nationalists = {

		priority = 10

		icon = generic_ignite_civil_war

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 154

		fire_only_once = yes

		activation = {
			has_country_flag = SPR_spanish_elections_flag
			NOT = { has_global_flag = spanish_civil_war }
		}

		visible = {
			tag = SPR
			has_completed_focus = SPA_a_great_spain
			has_country_flag = SPR_spanish_elections_flag
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			country_event = lar_spain.2
			if = {
				limit = {
					has_idea = SPA_awaiting_the_rebellion
				}
				remove_ideas = SPA_awaiting_the_rebellion
			}
		}
	}

	SPR_military_plot_republicans = {

		priority = 10

		icon = generic_ignite_civil_war

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 154

		fire_only_once = yes

		activation = {
			has_country_flag = SPR_spanish_elections_flag
			NOT = { has_global_flag = spanish_civil_war }
		}

		visible = {
			tag = SPR
			has_completed_focus = SPR_the_popular_front
			has_country_flag = SPR_spanish_elections_flag
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = no

		timeout_effect = {
			country_event = lar_spain.2
		}
	}
}

SPR_opposition_civil_war_preparations = {

	###  ##   ##  #  #  ##     #  #  ##  ### ### ### ###  ##   ##  ### ###  ##  #  #     #   # ###  ##  ## ###  ##  #  #  ##
	#   #  # #  # #  # #       ## # #  #  #   #  #    #  #  # #  #  #   #  #  # ## #     ## ##  #  #   #    #  #  # ## # #
	##  #  # #    #  #  #      # ## #  #  #   #  ##   #  #    ####  #   #  #  # # ##     # # #  #   #   #   #  #  # # ##  #
	#   #  # #  # #  #   #     #  # #  #  #   #  #    #  #  # #  #  #   #  #  # #  #     #   #  #    #   #  #  #  # #  #   #
	#    ##   ##   ##  ##      #  #  ##   #  ### #   ###  ##  #  #  #  ###  ##  #  #     #   # ### ##  ##  ###  ##  #  # ##

	SPA_hand_over_the_ceda_campaign_chest_mission = {

		priority = 10

		name = SPA_hand_over_the_ceda_campaign_chest

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 23

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			set_country_flag = SPA_hand_over_the_ceda_campaign_chest_flag
			hidden_effect = { activate_mission = SPA_negotiate_carlist_support_mission }
		}
	}

	SPA_negotiate_carlist_support_mission = {

		priority = 10

		name = SPA_negotiate_carlist_support

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 28

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			if = {
				limit = {
					difficulty > 1
					is_ai = no
				}
				custom_effect_tooltip = SPA_negotiate_carlist_support_mission_tt_2
				add_to_variable = { var = spa_civil_war_divisions_counter_var value = 10 }
			}
			else = {
				custom_effect_tooltip = SPA_negotiate_carlist_support_mission_tt
				add_to_variable = { var = spa_civil_war_divisions_counter_var value = 5 }
			}
			set_country_flag = SPA_negotiate_carlist_support_flag
			hidden_effect = { activate_mission = SPA_the_army_of_africa_mission }
		}
	}

	SPA_the_army_of_africa_mission = {

		priority = 10

		name = SPA_the_army_of_africa

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 35

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			custom_effect_tooltip = SPA_the_army_of_africa_mission_tt
			set_country_flag = SPA_the_army_of_africa_flag
			add_to_variable = { var = spa_civil_war_divisions_counter_var value = 5 }
			hidden_effect = { activate_mission = SPA_secure_the_northern_garrisons_mission }
		}
	}

	SPA_secure_the_northern_garrisons_mission = {

		priority = 10

		name = SPA_secure_the_northern_garrisons

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 35

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			custom_effect_tooltip = SPA_secure_the_northern_garrisons_mission_tt
			set_country_flag = SPA_secure_the_northern_garrisons_flag
			hidden_effect = {
				random_list = {
					10 = {
						modifier = {
							factor = 0
							is_historical_focus_on = yes
						}
						activate_mission = SPA_sin_paquito_mission
					}
					10 = {
						activate_mission = SPA_con_paquito_mission
					}
				}
				every_owned_state = {
					limit = {
						check_variable = { var = SPA_garrison_control value = 1 compare = equals }
						OR = {
							state = 171
							state = 174
							state = 866
							state = 176
							state = 166
							state = 172
						}
					}
					set_state_flag = SPA_northern_garrisons_state_flag
					add_to_variable = { var = SPA_garrison_control value = 3 }
					SPR = { add_to_variable = { var = spa_civil_war_divisions_counter_var value = 3 } }
					SPR = { subtract_from_variable = { var = spr_civil_war_divisions_counter_var value = 3 } }
					SPR_garrison_control_cost_calculation = yes
				}
				every_owned_state = {
					limit = {
						check_variable = { var = SPA_garrison_control value = 2 compare = equals }
						OR = {
							state = 171
							state = 174
							state = 866
							state = 176
							state = 166
							state = 172
						}
					}
					set_state_flag = SPA_northern_garrisons_state_flag
					add_to_variable = { var = SPA_garrison_control value = 2 }
					SPR = { add_to_variable = { var = spa_civil_war_divisions_counter_var value = 2 } }
					SPR = { subtract_from_variable = { var = spr_civil_war_divisions_counter_var value = 2 } }
					SPR_garrison_control_cost_calculation = yes
				}
				every_owned_state = {
					limit = {
						check_variable = { var = SPA_garrison_control value = 3 compare = equals }
						OR = {
							state = 171
							state = 174
							state = 866
							state = 176
							state = 166
							state = 172
						}
					}
					set_state_flag = SPA_northern_garrisons_state_flag
					add_to_variable = { var = SPA_garrison_control value = 1 }
					SPR = { add_to_variable = { var = spa_civil_war_divisions_counter_var value = 1 } }
					SPR = { subtract_from_variable = { var = spr_civil_war_divisions_counter_var value = 1 } }
					SPR_garrison_control_cost_calculation = yes
				}
			}
		}
	}

	SPA_sin_paquito_mission = {

		priority = 10

		name = SPA_sin_paquito

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 26

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			set_country_flag = SPA_sin_paquito_flag
		}
	}

	SPA_con_paquito_mission = {

		priority = 10

		name = SPA_con_paquito

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 26

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			random_unit_leader = {
				limit = {
					has_id = 1108
				}
				add_unit_leader_trait = trait_SPA_nationalist_sympathies
			}
			set_country_flag = SPA_con_paquito_flag
		}
	}

	SPR_secure_the_guardia_de_asalto_mission = {

		priority = 10

		name = SPR_secure_the_guardia_de_asalto

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 58

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			if = {
				limit = {
					difficulty > 1
					is_ai = no
				}
				custom_effect_tooltip = SPR_secure_the_guardia_de_asalto_mission_tt_2
				add_to_variable = { var = spa_civil_war_divisions_counter_var value = -10 }
				add_to_variable = { var = spr_civil_war_divisions_counter_var value = 5 }
			}
			else = {
				custom_effect_tooltip = SPR_secure_the_guardia_de_asalto_mission_tt
				add_to_variable = { var = spa_civil_war_divisions_counter_var value = -6 }
				add_to_variable = { var = spr_civil_war_divisions_counter_var value = 3 }
			}
			custom_effect_tooltip = SPR_remove_after_civil_war_tt
			hidden_effect = { activate_mission = SPR_train_the_union_youth_mission }
			set_country_flag = SPR_secure_the_guardia_de_asalto_flag
		}
	}

	SPR_secure_the_guardia_civil_mission = {

		priority = 10

		name = SPR_secure_the_guardia_civil

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 58

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			if = {
				limit = {
					difficulty > 1
					is_ai = no
				}
				custom_effect_tooltip = SPR_secure_the_guardia_civil_mission_tt_2
				add_to_variable = { var = spa_civil_war_divisions_counter_var value = -5 }
				add_to_variable = { var = spr_civil_war_divisions_counter_var value = 10 }
			}
			else = {
				custom_effect_tooltip = SPR_secure_the_guardia_civil_mission_tt
				add_to_variable = { var = spa_civil_war_divisions_counter_var value = -3 }
				add_to_variable = { var = spr_civil_war_divisions_counter_var value = 6 }
			}
			custom_effect_tooltip = SPR_remove_after_civil_war_tt
			hidden_effect = { activate_mission = SPR_train_the_union_youth_mission }
			set_country_flag = SPR_secure_the_guardia_civil_flag
		}
	}

	SPR_train_the_union_youth_mission = {

		priority = 10

		name = SPR_train_the_union_youth

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 70

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			if = {
				limit = {
					difficulty > 1
					is_ai = no
				}
				custom_effect_tooltip = SPR_train_the_union_youth_mission_tt_2
				add_to_variable = { var = spr_civil_war_divisions_counter_var value = 10 }
			}
			else = {
				custom_effect_tooltip = SPR_train_the_union_youth_mission_tt
				add_to_variable = { var = spr_civil_war_divisions_counter_var value = 5 }
			}
			hidden_effect = { activate_mission = SPR_enlarge_the_weapon_caches_mission }
			set_country_flag = SPR_train_the_union_youth_flag
		}
	}

	SPR_enlarge_the_weapon_caches_mission = {

		priority = 10

		name = SPR_enlarge_the_weapon_caches

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 70

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			custom_effect_tooltip = SPR_enlarge_the_weapon_caches_mission_tt
			hidden_effect = { activate_mission = SPR_distribute_arms_to_the_people_mission }
			set_country_flag = SPR_enlarge_the_weapon_caches_flag
		}
	}

	SPR_distribute_arms_to_the_people_mission = {

		priority = 10

		name = SPR_distribute_arms_to_the_people

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 70

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			custom_effect_tooltip = SPR_distribute_arms_to_the_people_mission_tt
			hidden_effect = { activate_mission = SPR_disband_the_army_mission }
			add_to_variable = { var = spr_civil_war_divisions_counter_var value = 10 }
			set_country_flag = SPR_distribute_arms_to_the_people_flag
		}
	}

	SPR_disband_the_army_mission = {

		priority = 10

		name = SPR_disband_the_army

		icon = eng_trade_unions_support

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 70

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			NOT = { has_global_flag = spanish_civil_war }
		}

		cancel_if_not_visible = yes

		is_good = yes

		timeout_effect = {
			custom_effect_tooltip = SPR_disband_the_army_mission_tt
			set_country_flag = SPR_disband_the_army_flag
			if = {
				limit = {
					has_idea = SPA_awaiting_the_rebellion
				}
				remove_ideas = SPA_awaiting_the_rebellion
			}
			hidden_effect = {
				country_event = lar_spain.2
			}
		}
	}

	SPR_primo_de_rivera_speech_mission = {
		icon = eng_propaganda_campaigns

		allowed = {
			tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		fire_only_once = no

		days_mission_timeout = 38

		is_good = no

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			has_country_flag = SPR_spanish_elections_flag
			has_completed_focus = SPR_the_popular_front
			NOT = { has_global_flag = spanish_civil_war }
		}

		timeout_effect = {
	#			add_days_mission_timeout = {
	#				mission = SPR_military_plot_republicans
	#				days = -25
	#			}
			add_popularity = {
			    ideology = fascism
			    popularity = 0.05
			}
			add_stability = -0.05
			add_political_power = -15
			if = {
				limit = {
					NOT = { has_country_flag = SPR_primo_de_rivera_first_speech }
				}
				set_country_flag = SPR_primo_de_rivera_first_speech
			}
			hidden_effect = {
				country_event = { id = lar_spain.4 }
			}
		}

	}

	SPA_imprison_primo_de_rivera_mission = {
		icon = generic_independence

		allowed = {
			tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		fire_only_once = yes

		days_mission_timeout = 38

		is_good = yes

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			has_country_flag = SPR_spanish_elections_flag
			has_completed_focus = SPA_a_great_spain
			NOT = { has_global_flag = spanish_civil_war }
		}

		timeout_effect = {
	#			add_days_mission_timeout = {
	#				mission = SPA_military_plot_nationalists
	#				days = 15
	#			}
			add_stability = -0.05
			custom_effect_tooltip = SPR_imprison_primo_de_rivera_tt
			set_country_flag = SPA_primo_de_rivera_imprisoned
			hidden_effect = {
				country_event = { id = lar_spain.3 }
			}
		}

	}

	SPR_political_assassination_mission = {
		icon = spr_political_assassination

		allowed = {
			tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		fire_only_once = no

		days_mission_timeout = 38

		is_good = yes

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			has_country_flag = SPR_spanish_elections_flag
			has_completed_focus = SPR_the_popular_front
			NOT = { has_global_flag = spanish_civil_war }
		}

		timeout_effect = {
			add_stability = -0.1
	#			add_days_mission_timeout = {
	#				mission = SPR_military_plot_republicans
	#				days = -25
	#			}
			set_country_flag = SPA_political_assassination_flag
			hidden_effect = {
				country_event = { id = lar_spain.4 }
			}
		}

	}

	SPA_political_arrest_mission = {
		icon = generic_independence

		allowed = {
			tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		fire_only_once = no

		days_mission_timeout = 38

		is_good = yes

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			has_country_flag = SPR_spanish_elections_flag
			has_completed_focus = SPA_a_great_spain
			NOT = { has_global_flag = spanish_civil_war }
		}

		timeout_effect = {
			add_days_mission_timeout = {
				mission = SPA_military_plot_nationalists
				days = 15
			}
			add_popularity = {
			    ideology = communism
			    popularity = 0.05
			}
			clr_country_flag = SPA_political_assassination_flag
			hidden_effect = {
				country_event = { id = lar_spain.3 }
			}
		}

	}

	SPR_sway_leader_loyalty_mission = {
		icon = generic_army_support

		allowed = {
			tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		fire_only_once = no

		days_mission_timeout = 38

		is_good = yes

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			has_country_flag = SPR_spanish_elections_flag
			has_completed_focus = SPR_the_popular_front
			NOT = { has_global_flag = spanish_civil_war }
		}

		timeout_effect = {
	#			add_days_mission_timeout = {
	#				mission = SPR_military_plot_republicans
	#				days = -25
	#			}
			random_unit_leader = {
				limit = {
					NOT = { has_trait = trait_SPA_nationalist_sympathies }
					NOT = { has_id = 1108 }
				}
				add_unit_leader_trait = trait_SPA_nationalist_sympathies
				set_unit_leader_flag = SPA_swayed_leader_loyalty_flag
			}
			hidden_effect = {
				country_event = { id = lar_spain.4 }
			}
		}

	}

	SPA_reassign_disloyal_leader_mission = {
		icon = generic_army_support

		allowed = {
			tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		fire_only_once = no

		days_mission_timeout = 38

		is_good = yes

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			has_country_flag = SPR_spanish_elections_flag
			has_completed_focus = SPA_a_great_spain
			NOT = { has_global_flag = spanish_civil_war }
		}

		timeout_effect = {
	#			add_days_mission_timeout = {
	#				mission = SPA_military_plot_nationalists
	#				days = 15
	#			}
			random_army_leader = {
				limit = {
					has_trait = trait_SPA_nationalist_sympathies
					NOT = {
						has_unit_leader_flag = SPA_swayed_leader_loyalty_flag
						has_unit_leader_flag = SPR_reassigned_flag
					}
				}
				custom_effect_tooltip = SPR_reassign_disloyal_leader_tt
				set_unit_leader_flag = SPR_reassigned_flag #make them pop up in the civil war with some delay, or require a decision to be taken before they're available (like Franco in the Canarias)
			}
			hidden_effect = {
				country_event = { id = lar_spain.3 }
			}
		}

	}

	SPR_suppress_the_strikes_mission = {
		icon = oppression

		allowed = {
			tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		fire_only_once = no

		days_mission_timeout = 38

		is_good = yes

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			has_country_flag = SPR_spanish_elections_flag
			has_completed_focus = SPR_the_popular_front
			NOT = { has_global_flag = spanish_civil_war }
		}

		timeout_effect = {
	#			add_days_mission_timeout = {
	#				mission = SPR_military_plot_republicans
	#				days = -25
	#			}
			SPR_suppress_the_strikes_increase = yes
			hidden_effect = {
				country_event = { id = lar_spain.4 }
			}
		}

	}

	SPA_concessions_to_the_left_mission = {
		icon = eng_trade_unions_support

		allowed = {
			tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		fire_only_once = no

		days_mission_timeout = 38

		is_good = yes

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPR
			has_country_flag = SPR_spanish_elections_flag
			has_completed_focus = SPA_a_great_spain
			NOT = { has_global_flag = spanish_civil_war }
		}

		timeout_effect = {
	#			add_days_mission_timeout = {
	#				mission = SPA_military_plot_nationalists
	#				days = 15
	#			}
			SPR_concessions_to_the_left_increase = yes
			hidden_effect = {
				country_event = { id = lar_spain.3 }
			}
		}

	}
}

 ##  ### #   # ### #       #   #  ##  ###       ##  ### ### ### #  #  ## ### #   # ###  ##
#  #  #  #   #  #  #       #   # #  # #  #     #  # #   #   #   ## # #    #  #   # #   #
#     #   # #   #  #       # # # #### ###      #  # ##  ##  ##  # ##  #   #   # #  ##   #
#  #  #   # #   #  #       # # # #  # #  #     #  # #   #   #   #  #   #  #   # #  #     #
 ##  ###   #   ### ###      # #  #  # #  #      ##  #   #   ### #  # ##  ###   #   ### ##

SPR_civil_war_offensives = {

	SPA_military_offensive = {
		priority = 30
		icon = hol_draw_up_staff_plans

		allowed = {
			original_tag = SPR
		}

		state_target = yes

		target_trigger = {
			FROM = {
				is_core_of = ROOT
				has_state_flag = SPR_unplanned_offensive_flag
				OR = {
					is_controlled_by = ROOT
					any_neighbor_state = {
						is_fully_controlled_by = ROOT
					}
				}
				NOT = { is_fully_controlled_by = ROOT }
			}
		}

		on_map_mode = map_and_decisions_view

		available = {
			NOT = { has_country_flag = SPR_preparing_offensive_in_progress_flag }
			command_power > 74
			if = {
				limit = {
					has_idea = SPR_disbanded_army_1
				}
				NOT = { has_idea = SPR_disbanded_army_1 }
			}
			if = {
				limit = {
					has_idea = SPR_disbanded_army_2
				}
				NOT = { has_idea = SPR_disbanded_army_2 }
			}
			if = {
				limit = {
					has_idea = SPR_disbanded_army_3
				}
				NOT = { has_idea = SPR_disbanded_army_3 }
			}
		}

		visible = {
			original_tag = SPR
			NOT = { has_global_flag = scw_over }
		}

		cancel_if_not_visible = yes

		custom_cost_trigger = {
			command_power > 74
		}
		custom_cost_text = decision_cost_CP_75

		days_remove = 30

		ai_will_do = {
			base = 1
			modifier = {
				factor = 10
				divisions_in_state = {
					state = FROM
					size > 0
				}
			}
			modifier = {
				factor = 4000
				FROM = { state = 796 }
			}
			modifier = {
				factor = 4000
				date > 1936.10.1
				FROM = { state = 864 }
			}
			modifier = {
				factor = 4000
				date > 1937.3.1
				FROM = { state = 956 }
			}
			modifier = {
				factor = 4000
				date > 1937.8.1
				FROM = { state = 867 }
			}
			modifier = {
				factor = 4000
				date > 1938.1.1
				FROM = { state = 166 }
			}
			modifier = {
				factor = 4000
				date > 1938.6.1
				FROM = { state = 165 }
			}
			modifier = {
				factor = 4000
				date > 1938.11.1
				FROM = { state = 173 }
			}
			modifier = {
				factor = 0
				date < 1936.10.1
				NOT = {
					FROM = { state = 796 }
				}
			}
			modifier = {
				factor = 0.1
				tag = SPA
				NOT = {
					796 = { is_fully_controlled_by = ROOT }
					FROM = { state = 796 }
				}
			}
		}

		complete_effect = {
			hidden_effect = {
				add_command_power = -75
			}
			activate_mission = SPR_preparing_offensive
			set_country_flag = SPR_preparing_offensive_in_progress_flag
		}

		remove_effect = {
			FROM = {
				clr_state_flag = SPR_unplanned_offensive_flag
				remove_province_modifier = {
					static_modifiers = { unplanned_offensive }
					province = {
						all_provinces = yes
					}
				}
			}
			if = {
				limit = {
					has_completed_focus = SPA_tackle_the_vulnerable_fronts
					FROM = { is_controlled_by = SPR }
				}
				add_timed_idea = { idea = SPA_anti_republican_offensive days = 30 }
			}
			if = {
				limit = {
					OR = {
						has_completed_focus = SPA_tackle_the_vulnerable_fronts
						has_completed_focus = SPR_take_the_initiative
					}
					FROM = { is_controlled_by = SPC }
				}
				add_timed_idea = { idea = SPA_anti_anarchist_offensive days = 30 }
			}
			if = {
				limit = {
					OR = {
						has_completed_focus = SPA_tackle_the_vulnerable_fronts
						has_completed_focus = SPR_take_the_initiative
					}
					FROM = { is_controlled_by = SPB }
				}
				add_timed_idea = { idea = SPA_anti_carlist_offensive days = 30 }
			}
			if = {
				limit = {
					has_completed_focus = SPR_take_the_initiative
					FROM = { is_controlled_by = SPA }
				}
				add_timed_idea = { idea = SPR_anti_nationalist_offensive days = 30 }
			}
		}
	}
	SPR_preparing_offensive = {
		icon = hol_draw_up_staff_plans

		allowed = {
			original_tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		fire_only_once = yes

		days_mission_timeout = 120

		is_good = no

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			original_tag = SPR
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_country_flag = SPR_preparing_offensive_in_progress_flag
		}

		timeout_effect = {
			clr_country_flag = SPR_preparing_offensive_in_progress_flag
		}
   	}

### ### ### ### #  #      ##   ##  #   #  # #   # #  #     ###  ###  ##  ###  ## ###  ##  #  #  ##
#    #  #    #  #  #     #  # #  # #   #  # ## ## ## #     #  # #   #  #  #  #    #  #  # ## # #
##   #  ##   #  ####     #    #  # #   #  # # # # # ##     #  # ##  #     #   #   #  #  # # ##  #
#    #  #    #  #  #     #  # #  # #   #  # #   # #  #     #  # #   #  #  #    #  #  #  # #  #   #
#   ### #    #  #  #      ##   ##  ###  ##  #   # #  #     ###  ###  ##  ### ##  ###  ##  #  # ##

	SPA_activate_galicia_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			171 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 171 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			171 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			171 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_asturias_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			796 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 796 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			796 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			796 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_leon_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			174 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 174 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			174 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			174 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_valladolid_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			176 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 176 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			176 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			176 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_burgos_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			865 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 865 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			865 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			865 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_pais_vasco_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			864 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 864 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			864 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			864 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_navarra_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			172 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 172 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			172 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			172 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_western_aragon_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			166 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 166 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			166 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			166 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_catalunya_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			165 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 165 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			165 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			165 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_salamanca_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			866 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 866 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			866 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			866 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_toledo_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			956 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 956 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			956 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			956 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\" start_experience_factor = 0 start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_madrid_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			41 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 41 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			41 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			41 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\" start_experience_factor = 0 start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_guadalajara_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			868 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 868 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			868 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			868 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_valencia_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			167 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 167 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			167 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			167 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_extremadura_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			170 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 170 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			170 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			170 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_ciudad_real_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			175 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 175 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			175 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			175 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_murcia_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			168 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 168 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			168 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			168 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_sevilla_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			169 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 169 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			169 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			169 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_cordoba_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			867 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 867 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			867 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			867 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

	SPA_activate_granada_fifth_columnists = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			173 = {
				NOT = { is_controlled_by = ROOT }
				any_neighbor_state = {
					is_controlled_by = ROOT
				}
			}
		}

		highlight_states = { highlight_state_targets = { state = 173 } }

		on_map_mode = map_only

		cost = 25

		fire_only_once = yes

		days_remove = 30

		modifier = {

		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			173 = { NOT = { is_controlled_by = ROOT } }
			has_completed_focus = SPA_the_fifth_column
		}

		complete_effect = {

		}

		remove_effect = {
			173 = {
				create_unit = {
					division = "division_template = \"Fifth Columnist Brigade\"	start_experience_factor = 0	start_equipment_factor = 1"
					owner = ROOT
					allow_spawning_on_enemy_provs = yes
					count = 2
					country_score = {
						base = 100
						modifier = {
							tag = SPR
							add = 100
						}
						modifier = {
							tag = SPB
							add = 100
						}
						modifier = {
							tag = SPC
							add = 100
						}
					}
				}
			}
		}
	}

}

political_actions = {

	SPR_pay_for_agricultural_equipment = {
		icon = generic_trucks

		allowed = {
			original_tag = SPR
		}

		available = {
			num_of_civilian_factories_available_for_projects > 14
		}
		visible = {
			has_completed_focus = SPA_ensure_agricultural_self_sufficiency
		}

		ai_will_do = {
			factor = 40
		}

		cost = 50
		days_remove = 90
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 15
		}

		remove_effect = {
			hidden_effect = {
				set_country_flag = SPR_paid_for_new_equipment
			}
		}
	}

	SPR_reform_agricultural_laws = {
		icon = generic_decision

		allowed = {
			original_tag = SPR
		}

		available = {
		}
		visible = {
			has_completed_focus = SPA_ensure_agricultural_self_sufficiency
		}

		ai_will_do = {
			factor = 40
		}

		cost = 150
        fire_only_once = yes

		complete_effect = {
			hidden_effect = {
				set_country_flag = SPR_reformed_agricultural_laws
			}
		}

	}

	SPR_subsidize_farmers = {
		icon = ger_mefo_bills

		allowed = {
			original_tag = SPR
		}

		available = {
		}
		visible = {
			has_completed_focus = SPA_ensure_agricultural_self_sufficiency
		}

		ai_will_do = {
			factor = 40
		}

		cost = 50
		days_remove = 90
        fire_only_once = yes

		modifier = {
			consumer_goods_expected_value = 0.05
		}

		remove_effect = {
			hidden_effect = {
				set_country_flag = SPR_subsidized_farmers
			}
		}

	}

	SPA_carlist_uprising_mission = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			if = {
				limit = {
					has_completed_focus = SPA_the_phalanx_ascendant
				}
				hidden_trigger = { always = no }
			}
			if = {
				limit = {
					has_completed_focus = SPA_unify_the_nationalist_front
				}
				has_completed_focus = SPA_fuse_the_parties
			}
		}

		priority = 10

		fire_only_once = yes

		days_mission_timeout = 316

		is_good = no

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPA
			NOT = { has_global_flag = scw_over }
			if = {
				limit = {
					has_completed_focus = SPA_the_phalanx_ascendant
				}
				NOT = { has_completed_focus = SPA_eliminate_the_carlists }
			}
			if = {
				limit = {
					has_completed_focus = SPA_unify_the_nationalist_front
				}
				NOT = { has_completed_focus = SPA_fuse_the_parties }
			}
		}

		timeout_effect = {
			if = {
				limit = {
					num_of_controlled_states > 4
					is_ai = yes
					is_historical_focus_on = yes
				}
				effect_tooltip = {
					country_event = lar_spain.7
				}
			}
			else_if = {
				limit = {
					num_of_controlled_states > 4
				}
				country_event = lar_spain.7
			}
			else = {
				activate_mission = SPA_carlist_uprising_mission
				add_days_mission_timeout = {
					mission = SPA_carlist_uprising_mission
					days = -316
				}
			}
		}
	}

	SPR_anarchist_uprising_mission = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		priority = 10

		fire_only_once = yes

		days_mission_timeout = 246

		is_good = no

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPD
			NOT = { has_global_flag = scw_over }
			NOT = { has_completed_focus = SPR_crush_the_revolution }
		}

		timeout_effect = {
			if = {
				limit = {
					num_of_controlled_states > 1
					is_ai = yes
					is_historical_focus_on = yes
				}
				effect_tooltip = {
					country_event = lar_spain.9
				}
			}
			else_if = {
				limit = {
					num_of_controlled_states > 1
				}
				country_event = lar_spain.9
			}
			else = {
				activate_mission = SPR_anarchist_uprising_mission
				add_days_mission_timeout = {
					mission = SPR_anarchist_uprising_mission
					days = -211
				}
			}
		}
	}

	SPA_fascist_crackdown_mission = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPA
		}

		available = {
			hidden_trigger = { always = no }
		}

		priority = 10

		fire_only_once = yes

		days_mission_timeout = 316

		is_good = no

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPA
			NOT = { has_global_flag = scw_over }
			NOT = { has_completed_focus = SPA_no_compromise_on_carlist_ideals }
		}

		timeout_effect = {
			if = {
				limit = {
					num_of_controlled_states > 4
				}
				country_event = lar_spain.8
			}
			else = {
				activate_mission = SPA_fascist_crackdown_mission
				add_days_mission_timeout = {
					mission = SPA_fascist_crackdown_mission
					days = -316
				}
			}
		}
	}

	SPR_government_crackdown_mission = {
		icon = generic_ignite_civil_war

		allowed = {
			tag = SPR
		}

		available = {
			hidden_trigger = { always = no }
		}

		priority = 10

		fire_only_once = yes

		days_mission_timeout = SPR_communists_uprising_mission_var?246

		is_good = no

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPD
			NOT = { has_global_flag = scw_over }
			NOT = { has_completed_focus = SPR_masters_of_our_own_fate }
		}

		timeout_effect = {
			if = {
				limit = {
					num_of_controlled_states > 1
				}
				country_event = lar_spain.10
			}
			else = {
				activate_mission = SPR_government_crackdown_mission
				add_days_mission_timeout = {
					mission = SPR_government_crackdown_mission
					days = -211
				}
			}
		}
	}

	SPA_save_the_alcazar_mission = {

		name = SPA_save_the_alcazar

		icon = eng_propaganda_campaigns

		allowed = {
			tag = SPA
		}

		available = {
			controls_province = 13401
		}

		fire_only_once = yes

		days_mission_timeout = 420

		cancel_if_not_visible = yes

		activation = {
			always = no
		}

		visible = {
			tag = SPA
			has_global_flag = spanish_civil_war
			has_completed_focus = SPA_save_the_alcazar
		}

		complete_effect = {
			add_war_support = 0.1
			add_stability = 0.1
			add_political_power = 100
			add_days_mission_timeout = {
				mission = SPA_carlist_uprising_mission
				days = 70
			}
		}

		timeout_effect = {
		}
	}

}

SPA_reassert_american_dominance = {

	SPA_reassert_dominance = {
		icon = eng_trade_unions_demand

		allowed = {
			original_tag = SPR
		}

		available = {
			fighting_army_strength_ratio = {
			    tag = FROM
			    ratio > 2
			}
		}

		target_trigger = {
			FROM = {
				capital_scope = {
					OR = {
						is_on_continent = south_america
						is_on_continent = north_america
					}
				}
				NOT = { is_subject_of = ROOT }
				NOT = { is_in_faction_with = ROOT }
				NOT = { has_war_with = ROOT }
				NOT = {
					original_tag = HOL
					original_tag = DEN
					original_tag = FRA
					original_tag = ENG
					original_tag = BRA
					original_tag = BOL
					original_tag = CAN
					original_tag = ARG
					original_tag = CHL
					original_tag = PRU
					original_tag = VEN
					original_tag = COL
					original_tag = MEX
					original_tag = USA
				}
			}
		}

		fire_only_once = yes

		visible = {
			has_completed_focus = SPA_reassert_american_dominance
			tag = SPA
		}

		complete_effect = {
			FROM = { country_event = lar_spain.19 }
		}
	}

}

SPR_expand_resource_extraction = {

	expand_basque_steel_works = { #864

		icon = steel

		highlight_states = { highlight_state_targets = { state = 864 } }

		available = {
			has_tech = construction3
			num_of_civilian_factories_available_for_projects > 2
			owns_state = 864
			controls_state = 864
		}

		visible = {
			owns_state = 864
			controls_state = 864
			864 = {
				NOT = {
					has_state_flag = basque_steel_developed
				}
			}
			#if = {
			#	limit = { original_tag = SPR }
			#	has_completed_focus = SPR_fuel_for_the_war_machine
			#}
		}

		fire_only_once = yes

		cost = 25
		days_remove = 90

		modifier = {
			civilian_factory_use = 3
		}

		remove_effect = {
			864 = { set_state_flag = basque_steel_developed }
			864 = {
				add_building_construction = {
					type = steel_refinery
					level = 1
					instant_build = yes
				}
				add_resource = {
					type = iron
					amount = 8
				}
			}
		}

		ai_will_do = {
			factor = 1
		}
	}

	expand_western_aragon_steel_works = { #166

		icon = steel

		allowed = {

		}

		highlight_states = { highlight_state_targets = { state = 166 } }

		available = {
			has_tech = construction3
			num_of_civilian_factories_available_for_projects > 2
			owns_state = 166
			controls_state = 166
		}

		visible = {
			owns_state = 166
			controls_state = 166
			166 = {
				NOT = {
					has_state_flag = western_aragon_steel_developed
				}
			}
			#if = {
			#	limit = { original_tag = SPR }
			#	has_completed_focus = SPR_fuel_for_the_war_machine
			#}
		}

		fire_only_once = yes

		cost = 25
		days_remove = 90

		modifier = {
			civilian_factory_use = 3
		}

		remove_effect = {
			166 = { set_state_flag = western_aragon_steel_developed }
			166 = {
				add_resource = {
					type = iron
					amount = 8
				}
			}
		}

		ai_will_do = {
			factor = 1
		}
	}

	expand_granada_steel_works = { #173

		icon = steel

		allowed = {

		}

		highlight_states = { highlight_state_targets = { state = 173 } }

		available = {
			has_tech = construction3
			num_of_civilian_factories_available_for_projects > 2
			owns_state = 173
			controls_state = 173
		}

		visible = {
			owns_state = 173
			controls_state = 173
			173 = {
				NOT = {
					has_state_flag = granada_steel_developed
				}
			}
			#if = {
			#	limit = { original_tag = SPR }
			#	has_completed_focus = SPR_fuel_for_the_war_machine
			#}
		}

		fire_only_once = yes

		cost = 25
		days_remove = 90

		modifier = {
			civilian_factory_use = 3
		}

		remove_effect = {
			173 = { set_state_flag = granada_steel_developed }
			173 = {
				add_resource = {
					type = iron
					amount = 8
				}
			}
		}

		ai_will_do = {
			factor = 1
		}
	}
}

SPA_preparing_the_carlist_insurrection = {

	SPA_establish_galicia_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 171
			171 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			171 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 171 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			171 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_asturias_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 796
			796 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			796 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 796 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			796 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_leon_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 174
			174 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			174 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 174 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			174 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_valladolid_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 176
			176 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			176 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 176 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			176 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_burgos_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 865
			865 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			865 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 865 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			865 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_pais_vasco_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 864
			864 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			864 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 864 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			864 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_navarra_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 172
			172 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			172 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 172 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			172 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_western_aragon_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 166
			166 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			166 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 166 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			166 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_catalunya_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 165
			165 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			165 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 165 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			165 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_salamanca_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 866
			866 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			866 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 866 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			866 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_toledo_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 956
			956 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			956 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 956 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			956 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_madrid_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 41
			41 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			41 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 41 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			41 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_guadalajara_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 868
			868 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			868 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 868 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			868 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_valencia_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 167
			167 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			167 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 167 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			167 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_extremadura_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 170
			170 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			170 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 170 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			170 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_ciudad_real_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 175
			175 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			175 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 175 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			175 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_murcia_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 168
			168 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			168 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 168 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			168 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_sevilla_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 169
			169 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			169 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 169 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			169 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_cordoba_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 867
			867 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			867 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 867 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection
			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			867 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

	SPA_establish_granada_carlist_cell = {
		icon = generic_prepare_civil_war

		available = {
			controls_state = 173
			173 = {
				NOT = {
					has_state_flag = SPA_carlist_cell_flag
				}
			}
			173 = {
				NOT = {
					has_state_flag = SPA_union_militar_flag
				}
			}
			NOT = { has_country_flag = SPA_already_establishing_carlist_cell_flag }
		}

		highlight_states = { highlight_state_targets = { state = 173 } }

		on_map_mode = map_only

		cost = 50

		fire_only_once = no

		days_remove = 90

		visible = {
			has_global_flag = spanish_civil_war
			NOT = { has_global_flag = scw_over }
			has_completed_focus = SPA_prepare_the_carlist_insurrection

			NOT = { has_global_flag = SPR_carlist_uprising_flag }
		}

		cancel_if_not_visible = yes

		complete_effect = {
			set_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		remove_effect = {
			173 = { set_state_flag = SPA_carlist_cell_flag }
			clr_country_flag = SPA_already_establishing_carlist_cell_flag
		}

		ai_will_do = {

		}
	}

}

war_measures = {

	SPA_africa_airlift = {
		icon = generic_prepare_civil_war

		allowed = {
			original_tag = SPR
		}

		available = {
			NOT = { controls_state = 169 }
		}

		visible = {
			has_completed_focus = SPA_a_great_spain
		}

		days_mission_timeout = 7

		fire_only_once = no

		activation = {
			always = no
		}

		complete_effect = {
			290 = {
				create_unit = {
					division = "division_template = \"Divisin del Ejrcito de frica\" start_experience_factor = 0.5"
					owner = SPA
					count = SPA_airlift_var
				}
			}
			hidden_effect = {
				if = {
					limit = {
						is_ai = no
					}
					set_division_template_lock = {
						division_template = "Divisin del Ejrcito de frica"
						is_locked = no
					}
				}
			}
		}

		timeout_effect = {
			169 = {
				create_unit = {
					division = "division_template = \"Divisin del Ejrcito de frica\" start_experience_factor = 0.5"
					owner = SPA
				}
			}
			hidden_effect = {
				add_to_variable = { SPA_airlift_var = -1 }
				if = {
					limit = {
						check_variable = { var = SPA_airlift_var value = 0 compare = greater_than }
					}
					activate_mission = SPA_africa_airlift
				}
				else_if = {
					limit = {
						is_ai = no
					}
					set_division_template_lock = {
						division_template = "Divisin del Ejrcito de frica"
						is_locked = no
					}
				}
			}
		}
	}

	SPR_soviet_volunteer_airforce = {
		icon = generic_prepare_civil_war

		allowed = {
			original_tag = SPR
		}

		available = {

		}

		cost = 0

		fire_only_once = yes

		days_remove = 7

		modifier = {

		}

		visible = {
			OR = {
				tag = SPD
				tag = SPC
			}
			SOV = { has_government = communism }
			NOT = { has_global_flag = scw_over }
			SOV = { is_ai = yes }
		}

		complete_effect = {
		}

		remove_effect = {
			SOV = { air_experience = 50 }
			if = {
                limit = {
                    has_dlc = "By Blood Alone"
                }
				add_equipment_to_stockpile = { type = SOV_i_15_airframe amount = 300 producer = SOV }
            }
            else = {
				add_equipment_to_stockpile = { type = sov_fighter_equipment_1 amount = 300 producer = SOV }
            }
		}

	}
}

SPR_foreign_arms_purchases = {

	SPR_purchase_foreign_fighters_GER = {
		icon = generic_air

		allowed = {
			original_tag = SPR
		}

		available = {
			num_of_civilian_factories_available_for_projects > 4
			ROOT = { has_government = GER }
		}
		visible = {
			has_completed_focus = SPR_foreign_arms_purchases
			NOT = { has_country_flag = SPR_fighter_purchase_flag }
		}

		ai_will_do = {
			factor = 40
		}

		cost = 15
		days_remove = 90
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 5
		}

		remove_effect = {
			GER = {
				give_fighter_aircraft_and_licences = yes
			}
			hidden_effect = {
				set_country_flag = SPR_air_purchase_flag
			}
		}
	}

	SPR_purchase_foreign_bombers_GER = {
		icon = generic_air

		allowed = {
			original_tag = SPR
		}

		available = {
			num_of_civilian_factories_available_for_projects > 4
			ROOT = { has_government = GER }
		}
		visible = {
			has_completed_focus = SPR_foreign_arms_purchases
			NOT = { has_country_flag = SPR_bomber_purchase_flag }
		}

		ai_will_do = {
			factor = 40
		}

		cost = 15
		days_remove = 90
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 5
		}

		remove_effect = {
			GER = {
				give_bomber_aircraft_and_licences = yes
			}
			hidden_effect = {
				set_country_flag = SPR_bomber_purchase_flag
			}
		}
	}

	SPR_purchase_foreign_fighters_ITA = {
		icon = generic_air

		allowed = {
			original_tag = SPR
		}

		available = {
			num_of_civilian_factories_available_for_projects > 4
			ROOT = { has_government = ITA }
		}
		visible = {
			has_completed_focus = SPR_foreign_arms_purchases
			NOT = { has_country_flag = SPR_air_purchase_flag }
		}

		ai_will_do = {
			factor = 40
		}

		cost = 15
		days_remove = 90
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 5
		}

		remove_effect = {
			ITA = {
				give_fighter_aircraft_and_licences = yes
			}
			hidden_effect = {
				set_country_flag = SPR_air_purchase_flag
			}
		}
	}

	SPR_purchase_foreign_bombers_ITA = {
		icon = generic_air

		allowed = {
			original_tag = SPR
		}

		available = {
			num_of_civilian_factories_available_for_projects > 4
			ROOT = { has_government = ITA }
		}
		visible = {
			has_completed_focus = SPR_foreign_arms_purchases
			NOT = { has_country_flag = SPR_bomber_purchase_flag }
		}

		ai_will_do = {
			factor = 40
		}

		cost = 15
		days_remove = 90
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 5
		}

		remove_effect = {
			ITA = {
				give_bomber_aircraft_and_licences = yes
			}
			hidden_effect = {
				set_country_flag = SPR_bomber_purchase_flag
			}
		}
	}

	SPR_purchase_foreign_fighters_SOV = {
		icon = generic_air

		allowed = {
			original_tag = SPR
		}

		available = {
			num_of_civilian_factories_available_for_projects > 4
			ROOT = { has_government = SOV }
		}
		visible = {
			has_completed_focus = SPR_foreign_arms_purchases
			NOT = { has_country_flag = SPR_air_purchase_flag }
		}

		ai_will_do = {
			factor = 40
		}

		cost = 15
		days_remove = 90
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 5
		}

		remove_effect = {
			SOV = {
				give_fighter_aircraft_and_licences = yes
			}
			hidden_effect = {
				set_country_flag = SPR_air_purchase_flag
			}
		}
	}

	SPR_purchase_foreign_bombers_SOV = {
		icon = generic_air

		allowed = {
			original_tag = SPR
		}

		available = {
			num_of_civilian_factories_available_for_projects > 4
			ROOT = { has_government = SOV }
		}
		visible = {
			has_completed_focus = SPR_foreign_arms_purchases
			NOT = { has_country_flag = SPR_bomber_purchase_flag }
		}

		ai_will_do = {
			factor = 40
		}

		cost = 15
		days_remove = 90
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 5
		}

		remove_effect = {
			SOV = {
				give_bomber_aircraft_and_licences = yes
			}
			hidden_effect = {
				set_country_flag = SPR_bomber_purchase_flag
			}
		}
	}

	SPR_purchase_foreign_fighters_FRA = {
		icon = generic_air

		allowed = {
			original_tag = SPR
		}

		available = {
			num_of_civilian_factories_available_for_projects > 4
			ROOT = { has_government = FRA }
		}
		visible = {
			has_completed_focus = SPR_foreign_arms_purchases
			NOT = { has_country_flag = SPR_air_purchase_flag }
		}

		ai_will_do = {
			factor = 40
		}

		cost = 15
		days_remove = 90
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 5
		}

		remove_effect = {
			FRA = {
				give_fighter_aircraft_and_licences = yes
			}
			hidden_effect = {
				set_country_flag = SPR_air_purchase_flag
			}
		}
	}

	SPR_purchase_foreign_bombers_FRA = {
		icon = generic_air

		allowed = {
			original_tag = SPR
		}

		available = {
			num_of_civilian_factories_available_for_projects > 4
			ROOT = { has_government = FRA }
		}
		visible = {
			has_completed_focus = SPR_foreign_arms_purchases
			NOT = { has_country_flag = SPR_bomber_purchase_flag }
		}

		ai_will_do = {
			factor = 40
		}

		cost = 15
		days_remove = 90
		fire_only_once = yes

		modifier = {
			civilian_factory_use = 5
		}

		remove_effect = {
			FRA = {
				give_bomber_aircraft_and_licences = yes
			}
			hidden_effect = {
				set_country_flag = SPR_bomber_purchase_flag
			}
		}
	}

	###

	SPA_german_equipment_shipments = {
		icon = generic_prepare_civil_war

		allowed = {
			original_tag = SPR
		}

		available = {
			OR = {
				ROOT = { has_government = GER }
				has_volunteers_amount_from = {
					tag = GER
					count > 0
				}
			}
		}

		cost = 10

		fire_only_once = yes

		days_remove = 30

		ai_will_do = {
			factor = 400
		}

		modifier = {

		}

		visible = {
			has_completed_focus = SPA_equipment_shipments
			NOT = { has_global_flag = scw_over }
		}

		complete_effect = {
		}

		remove_effect = {
			activate_mission = SPA_german_equipment_shipments_mission
			add_equipment_to_stockpile = {
				type = ger_inf_0
				amount = 100
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = ger_hv_inf_1
				amount = 50
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = ger_art_1
				amount = 12
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = ger_at_1
				amount = 24
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = ger_aa_1
				amount = 24
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = support_equipment_1
				amount = 50
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = ger_motorized_equipment_1
				amount = 25
				producer = GER
			}
			if = {
				limit = {
					has_DLC = "No Step Back"
				}
				add_equipment_to_stockpile = {
					type = tank_ger_light_chassis_1
					amount = 10
					producer = GER
				}
			}
			else = {
				add_equipment_to_stockpile = {
					type = ger_light_equipment_0
					amount = 10
					producer = GER
				}
			}
			if = {
                limit = {
                    has_dlc = "By Blood Alone"
                }
				add_equipment_to_stockpile = {
					type = GER_he_51_airframe
					amount = 10
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = GER_ju_86_airframe
					amount = 10
					producer = GER
				}
            }
            else = {
				add_equipment_to_stockpile = {
					type = ger_fighter_equipment_1
					amount = 10
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = ger_tac_bomber_equipment_1
					amount = 10
					producer = GER
				}
            }
		}
	}

	SPA_german_equipment_shipments_mission = {
		icon = generic_prepare_civil_war

		available = {
			NOT = {
				ROOT = { has_government = GER }
				has_volunteers_amount_from = {
					tag = GER
					count > 0
				}
			}
		}

		days_mission_timeout = 30

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			has_completed_focus = SPA_equipment_shipments
			NOT = { has_global_flag = scw_over }
		}

		cancel_if_not_visible = no

		is_good = yes

		timeout_effect = {
			if = {
				limit = {
					NOT = { has_global_flag = scw_over }
				}
				activate_mission = SPA_german_equipment_shipments_mission
			}
			add_equipment_to_stockpile = {
				type = ger_inf_0
				amount = 100
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = ger_hv_inf_1
				amount = 50
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = ger_art_1
				amount = 12
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = ger_at_1
				amount = 24
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = ger_aa_1
				amount = 24
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = support_equipment_1
				amount = 50
				producer = GER
			}
			add_equipment_to_stockpile = {
				type = ger_motorized_equipment_1
				amount = 25
				producer = GER
			}
			if = {
				limit = {
					has_DLC = "No Step Back"
				}
				add_equipment_to_stockpile = {
					type = tank_ger_light_chassis_1
					amount = 10
					producer = GER
				}
			}
			else = {
				add_equipment_to_stockpile = {
					type = ger_light_equipment_0
					amount = 10
					producer = GER
				}
			}
			if = {
                limit = {
                    has_dlc = "By Blood Alone"
                }
				add_equipment_to_stockpile = {
					type = GER_he_51_airframe
					amount = 10
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = GER_ju_86_airframe
					amount = 10
					producer = GER
				}
            }
            else = {
				add_equipment_to_stockpile = {
					type = ger_fighter_equipment_1
					amount = 10
					producer = GER
				}
				add_equipment_to_stockpile = {
					type = ger_tac_bomber_equipment_1
					amount = 10
					producer = GER
				}
            }
		}
	}

	SPA_italian_equipment_shipments = {
		icon = generic_prepare_civil_war

		allowed = {
			original_tag = SPR
		}

		available = {
			OR = {
				ROOT = { has_government = ITA }
				has_volunteers_amount_from = {
					tag = ITA
					count > 0
				}
			}
		}

		cost = 10

		fire_only_once = yes

		days_remove = 30

		ai_will_do = {
			factor = 400
		}

		modifier = {

		}

		visible = {
			has_completed_focus = SPA_equipment_shipments
			NOT = { has_global_flag = scw_over }
		}

		complete_effect = {
		}

		remove_effect = {
			activate_mission = SPA_italian_equipment_shipments_mission
			add_equipment_to_stockpile = {
				type = ita_inf_0
				amount = 100
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = ita_hv_inf_1
				amount = 50
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = ita_art_1
				amount = 12
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = ita_at_1
				amount = 24
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = ita_aa_1
				amount = 24
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = support_equipment_1
				amount = 50
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = ita_motorized_equipment_1
				amount = 25
				producer = ITA
			}
			if = {
				limit = {
					has_DLC = "No Step Back"
				}
				add_equipment_to_stockpile = {
					type = tank_ita_light_chassis_2
					amount = 10
					producer = ITA
				}
			}
			else = {
				add_equipment_to_stockpile = {
					type = ita_light_equipment_1
					amount = 10
					producer = ITA
				}
			}
			if = {
                limit = {
                    has_dlc = "By Blood Alone"
                }
				add_equipment_to_stockpile = {
					type = ITA_cr_32_airframe
					amount = 10
					producer = ITA
				}
				add_equipment_to_stockpile = {
					type = ITA_sm_81_airframe
					amount = 10
					producer = ITA
				}
            }
            else = {
				add_equipment_to_stockpile = {
					type = ita_fighter_equipment_1
					amount = 10
					producer = ITA
				}
				add_equipment_to_stockpile = {
					type = ita_tac_bomber_equipment_1
					amount = 10
					producer = ITA
				}
            }
		}
	}

	SPA_italian_equipment_shipments_mission = {
		icon = generic_prepare_civil_war

		available = {
			NOT = {
				ROOT = { has_government = ITA }
				has_volunteers_amount_from = {
					tag = ITA
					count > 0
				}
			}
		}

		days_mission_timeout = 30

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			has_completed_focus = SPA_equipment_shipments
			NOT = { has_global_flag = scw_over }
		}

		cancel_if_not_visible = no

		is_good = yes

		timeout_effect = {
			if = {
				limit = {
					NOT = { has_global_flag = scw_over }
				}
				activate_mission = SPA_italian_equipment_shipments_mission
			}
			add_equipment_to_stockpile = {
				type = ita_inf_0
				amount = 100
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = ita_hv_inf_1
				amount = 50
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = ita_art_1
				amount = 12
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = ita_at_1
				amount = 24
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = ita_aa_1
				amount = 24
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = support_equipment_1
				amount = 50
				producer = ITA
			}
			add_equipment_to_stockpile = {
				type = ita_motorized_equipment_1
				amount = 25
				producer = ITA
			}
			if = {
				limit = {
					has_DLC = "No Step Back"
				}
				add_equipment_to_stockpile = {
					type = tank_ita_light_chassis_2
					amount = 10
					producer = ITA
				}
			}
			else = {
				add_equipment_to_stockpile = {
					type = ita_light_equipment_1
					amount = 10
					producer = ITA
				}
			}
			if = {
                limit = {
                    has_dlc = "By Blood Alone"
                }
				add_equipment_to_stockpile = {
					type = ITA_cr_32_airframe
					amount = 10
					producer = ITA
				}
				add_equipment_to_stockpile = {
					type = ITA_sm_81_airframe
					amount = 10
					producer = ITA
				}
            }
            else = {
				add_equipment_to_stockpile = {
					type = ita_fighter_equipment_1
					amount = 10
					producer = ITA
				}
				add_equipment_to_stockpile = {
					type = ita_tac_bomber_equipment_1
					amount = 10
					producer = ITA
				}
            }
		}
	}

	SPR_soviet_equipment_shipments = {
		icon = generic_prepare_civil_war

		allowed = {
			original_tag = SPR
		}

		available = {
			OR = {
				ROOT = { has_government = SOV }
				has_volunteers_amount_from = {
					tag = SOV
					count > 0
				}
				any_enemy_country = {
					has_volunteers_amount_from = {
						tag = GER
						count > 0
					}
				}
				any_enemy_country = {
					has_volunteers_amount_from = {
						tag = ITA
						count > 0
					}
				}
			}
		}

		cost = 10

		fire_only_once = yes

		days_remove = 30

		ai_will_do = {
			factor = 400
		}

		modifier = {

		}

		visible = {
			has_completed_focus = SPR_soviet_equipment_shipments
			NOT = { has_global_flag = scw_over }
		}

		complete_effect = {
		}

		remove_effect = {
			activate_mission = SPR_soviet_equipment_shipments_mission
			add_equipment_to_stockpile = {
				type = sov_inf_1
				amount = 100
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_hv_inf_1
				amount = 50
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_art_1
				amount = 12
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_at_1
				amount = 24
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_aa_1
				amount = 24
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = support_equipment_1
				amount = 50
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_motorized_equipment_1
				amount = 25
				producer = SOV
			}
			if = {
				limit = {
					has_DLC = "No Step Back"
				}
				add_equipment_to_stockpile = {
					type = tank_sov_light_chassis_support_1
					amount = 10
					producer = SOV
				}
			}
			else = {
				add_equipment_to_stockpile = {
					type = sov_light_equipment_1
					amount = 10
					producer = SOV
				}
			}
			if = {
                limit = {
                    has_dlc = "By Blood Alone"
                }
				add_equipment_to_stockpile = {
					type = SOV_i_16_type_5_airframe
					amount = 10
					producer = SOV
				}
				add_equipment_to_stockpile = {
					type = SOV_sb_2m100_airframe
					amount = 10
					producer = SOV
				}
            }
            else = {
				add_equipment_to_stockpile = {
					type = sov_fighter_multirole_equipment_1
					amount = 10
					producer = SOV
				}
				add_equipment_to_stockpile = {
					type = sov_strike_bomber_equipment_1
					amount = 10
					producer = SOV
				}
            }
		}
	}

	SPR_soviet_equipment_shipments_mission = {
		icon = generic_prepare_civil_war

		available = {
			NOT = {
				ROOT = { has_government = SOV }
				has_volunteers_amount_from = {
					tag = SOV
					count > 0
				}
				any_enemy_country = {
					has_volunteers_amount_from = {
						tag = GER
						count > 0
					}
				}
				any_enemy_country = {
					has_volunteers_amount_from = {
						tag = ITA
						count > 0
					}
				}
			}
		}

		days_mission_timeout = 30

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			has_completed_focus = SPR_soviet_equipment_shipments
			NOT = { has_global_flag = scw_over }
		}

		cancel_if_not_visible = no

		is_good = yes

		timeout_effect = {
			if = {
				limit = {
					NOT = { has_global_flag = scw_over }
				}
				activate_mission = SPR_soviet_equipment_shipments_mission
			}
			add_equipment_to_stockpile = {
				type = sov_inf_1
				amount = 100
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_hv_inf_1
				amount = 50
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_art_1
				amount = 12
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_at_1
				amount = 24
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_aa_1
				amount = 24
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = support_equipment_1
				amount = 50
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_motorized_equipment_1
				amount = 25
				producer = SOV
			}
			if = {
				limit = {
					has_DLC = "No Step Back"
				}
				add_equipment_to_stockpile = {
					type = tank_sov_light_chassis_support_1
					amount = 10
					producer = SOV
				}
			}
			else = {
				add_equipment_to_stockpile = {
					type = sov_light_equipment_1
					amount = 10
					producer = SOV
				}
			}
			if = {
                limit = {
                    has_dlc = "By Blood Alone"
                }
				add_equipment_to_stockpile = {
					type = SOV_i_16_type_5_airframe
					amount = 10
					producer = SOV
				}
				add_equipment_to_stockpile = {
					type = SOV_sb_2m100_airframe
					amount = 10
					producer = SOV
				}
            }
            else = {
				add_equipment_to_stockpile = {
					type = sov_fighter_multirole_equipment_1
					amount = 10
					producer = SOV
				}
				add_equipment_to_stockpile = {
					type = sov_strike_bomber_equipment_1
					amount = 10
					producer = SOV
				}
            }
		}
	}

	SPR_french_equipment_shipments = {
		icon = generic_prepare_civil_war

		allowed = {
			original_tag = SPR
		}

		available = {
			OR = {
				ROOT = { has_government = FRA }
				has_country_flag = FRA_equipment_shipments_flag
			}
		}

		cost = 10

		fire_only_once = yes

		days_remove = 30

		ai_will_do = {
			factor = 400
		}

		modifier = {

		}

		visible = {
			has_completed_focus = SPR_petition_for_french_aid
			has_country_flag = FRA_equipment_shipments_flag
			NOT = { has_global_flag = scw_over }
		}

		complete_effect = {
		}

		remove_effect = {
			activate_mission = SPR_french_equipment_shipments_mission
			add_equipment_to_stockpile = {
				type = fra_inf_0
				amount = 100
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_hv_inf_1
				amount = 50
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_art_0
				amount = 12
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_at_1
				amount = 24
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_aa_1
				amount = 24
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = support_equipment_1
				amount = 50
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_motorized_equipment_1
				amount = 25
				producer = FRA
			}
			if = {
				limit = {
					has_DLC = "No Step Back"
				}
				add_equipment_to_stockpile = {
					type = FRA_renault_ft_light_tank_chassis
					amount = 10
					producer = FRA
				}
			}
			else = {
				add_equipment_to_stockpile = {
					type = fra_interwar_equipment_1
					amount = 10
					producer = FRA
				}
			}
			add_equipment_to_stockpile = {
				type = fra_fighter_equipment_1
				amount = 10
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_tac_bomber_equipment_1
				amount = 10
				producer = FRA
			}
		}
	}

	SPR_french_equipment_shipments_mission = {
		icon = generic_prepare_civil_war

		available = {
			NOT = {
				ROOT = { has_government = FRA }
				has_country_flag = FRA_equipment_shipments_flag
			}
		}

		days_mission_timeout = 30

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			has_completed_focus = SPR_petition_for_french_aid
			has_country_flag = FRA_equipment_shipments_flag
			NOT = { has_global_flag = scw_over }
		}

		cancel_if_not_visible = no

		is_good = yes

		timeout_effect = {
			if = {
				limit = {
					NOT = { has_global_flag = scw_over }
				}
				activate_mission = SPR_french_equipment_shipments_mission
			}
			add_equipment_to_stockpile = {
				type = fra_inf_0
				amount = 100
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_hv_inf_1
				amount = 50
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_art_0
				amount = 12
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_at_1
				amount = 24
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_aa_1
				amount = 24
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = support_equipment_1
				amount = 50
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_motorized_equipment_1
				amount = 25
				producer = FRA
			}
			if = {
				limit = {
					has_DLC = "No Step Back"
				}
				add_equipment_to_stockpile = {
					type = FRA_renault_ft_light_tank_chassis
					amount = 10
					producer = FRA
				}
			}
			else = {
				add_equipment_to_stockpile = {
					type = fra_interwar_equipment_1
					amount = 10
					producer = FRA
				}
			}
			add_equipment_to_stockpile = {
				type = fra_fighter_equipment_1
				amount = 10
				producer = FRA
			}
			add_equipment_to_stockpile = {
				type = fra_tac_bomber_equipment_1
				amount = 10
				producer = FRA
			}
		}
	}
}

SPR_the_seeds_of_revolution = {

	SPR_integrate_commune_1 = {

		name = SPR_integrate_commune

		icon = generic_nationalism

		allowed = {
			original_tag = SPR
		}

		available = {
			FROM = {
				compliance > 60
				OR = {
					is_island_state = yes
					any_neighbor_state = {
						is_core_of = ROOT
					}
				}
			}
		}

		state_target = yes

		on_map_mode = map_only

		#targets = {  }

		target_array = controlled_states

		target_trigger = {
			has_completed_focus = SPR_global_defense_council
			FROM = {
				NOT = {
					is_core_of = ROOT
				}
				OR = {
					is_island_state = yes
					any_neighbor_state = {
						is_core_of = ROOT
					}
				}
				OR = {
					NOT = {
						is_owned_by = ROOT
					}
					NOT = {
						state = 956
						state = 41
						state = 165
						state = 166
						state = 167
						state = 168
						state = 169
						state = 170
						state = 171
						state = 172
						state = 173
						state = 174
						state = 175
						state = 865
						state = 866
						state = 867
						state = 796
						state = 176
						state = 864
						state = 868
						state = 794
					}
				}
				compliance > 35
			}
		}

		cost = 50

		fire_only_once = yes

		days_remove = 60

		modifier = {
			political_power_gain = -1
		}

		visible = {
			tag = SPC
			has_completed_focus = SPR_global_defense_council
			always = yes
		}

		complete_effect = {

		}

		remove_effect = {
			FROM = {
				add_core_of = ROOT
			}
			transfer_state = FROM
		}
	}

	SPR_integrate_commune_2 = {

		name = SPR_integrate_commune

		icon = generic_nationalism

		allowed = {
			original_tag = SPR
		}

		available = {
			FROM = {
				compliance > 60
				NOT = {
					is_island_state = yes
					any_neighbor_state = {
						is_core_of = ROOT
					}
				}
			}
		}

		state_target = yes

		on_map_mode = map_only

		#targets = {  }

		target_array = controlled_states

		target_trigger = {
			has_completed_focus = SPR_global_defense_council
			FROM = {
				NOT = {
					is_core_of = ROOT
				}
				NOT = {
					is_island_state = yes
					any_neighbor_state = {
						is_core_of = ROOT
					}
				}
				OR = {
					NOT = {
						is_owned_by = ROOT
					}
					NOT = {
						state = 956
						state = 41
						state = 165
						state = 166
						state = 167
						state = 168
						state = 169
						state = 170
						state = 171
						state = 172
						state = 173
						state = 174
						state = 175
						state = 865
						state = 866
						state = 867
						state = 796
						state = 176
						state = 864
						state = 868
						state = 794
					}
				}
				compliance > 35
			}
		}

		cost = 150

		fire_only_once = yes

		days_remove = 90

		modifier = {
			political_power_gain = -1
		}

		visible = {
			tag = SPC
			has_completed_focus = SPR_global_defense_council
			always = yes
		}

		complete_effect = {

		}

		remove_effect = {
			FROM = {
				add_core_of = ROOT
			}
			transfer_state = FROM
		}
	}

	SPR_ignite_uprising = {
		icon = generic_ignite_civil_war

		allowed = {
			original_tag = SPR
		}

		available = {
			FROM = {
				has_civil_war = no
				any_controlled_state = {
					is_in_home_area = yes
					is_capital = no
				}
			}
			has_equipment = {
			    infantry_equipment > 19999
			}
			any_controlled_state = {
				NOT = { has_state_flag = anarchist_uprising }
			}
		}

		target_trigger = {
			FROM = {
				exists = yes
				has_war_with = ROOT
				any_controlled_state = {
					is_in_home_area = yes
					any_neighbor_state = {
						is_controlled_by = ROOT
					}
				}
			}
		}

		cost = 150

		fire_only_once = yes

		days_remove = 90

		modifier = {

		}

		visible = {
			tag = SPC
			has_completed_focus = SPR_plant_the_seeds_of_revolution
			FROM = {
				exists = yes
			}
		}

		complete_effect = {
			add_equipment_to_stockpile = {
			    type = infantry_equipment
			    amount = -20000
			}
			hidden_effect = {
				FROM = {
					set_country_flag = SPR_ignite_uprising_timer_flag
					activate_mission = SPR_ignite_uprising_timer_mission
				}
			}
		}

		remove_effect = {
			if = {
				limit = {
					FROM = {
						any_controlled_state = {
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 750
								}
							}
						}
					}
				}
				random_state = {
					limit = {
						is_controlled_by = FROM
						is_in_home_area = yes
						is_capital = no
						NOT = { has_state_flag = anarchist_uprising }
						any_state = {
							is_controlled_by = ROOT
							NOT = { has_state_flag = anarchist_uprising }
							distance_to = {
								target = PREV
								value < 750
							}
						}
					}
					set_state_flag = anarchist_uprising
					create_unit = {
						division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
						owner = ROOT
						allow_spawning_on_enemy_provs = yes
					}
					create_unit = {
						division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
						owner = ROOT
						allow_spawning_on_enemy_provs = yes
					}
					create_unit = {
						division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
						owner = ROOT
						allow_spawning_on_enemy_provs = yes
					}
				}
			}
			else_if = {
				limit = {
					FROM = {
						any_controlled_state = {
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 1500
								}
							}
						}
					}
				}
				random_state = {
					limit = {
						is_controlled_by = FROM
						is_in_home_area = yes
						is_capital = no
						NOT = { has_state_flag = anarchist_uprising }
						any_state = {
							is_controlled_by = ROOT
							NOT = { has_state_flag = anarchist_uprising }
							distance_to = {
								target = PREV
								value < 1500
							}
						}
					}
					set_state_flag = anarchist_uprising
					create_unit = {
						division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
						owner = ROOT
						allow_spawning_on_enemy_provs = yes
					}
					create_unit = {
						division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
						owner = ROOT
						allow_spawning_on_enemy_provs = yes
					}
					create_unit = {
						division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
						owner = ROOT
						allow_spawning_on_enemy_provs = yes
					}
				}
			}
			else = {
				random_state = {
					limit = {
						is_controlled_by = FROM
						is_in_home_area = yes
						is_capital = no
						NOT = { has_state_flag = anarchist_uprising }
						any_state = {
							is_controlled_by = ROOT
							NOT = { has_state_flag = anarchist_uprising }
						}
					}
					set_state_flag = anarchist_uprising
					create_unit = {
						division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
						owner = ROOT
						allow_spawning_on_enemy_provs = yes
					}
					create_unit = {
						division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
						owner = ROOT
						allow_spawning_on_enemy_provs = yes
					}
					create_unit = {
						division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
						owner = ROOT
						allow_spawning_on_enemy_provs = yes
					}
				}
			}

			if = {
				limit = {
					FROM = { num_of_controlled_states > 4 }
				}
				if = {
					limit = {
						FROM = {
							any_controlled_state = {
								is_in_home_area = yes
								is_capital = no
								NOT = { has_state_flag = anarchist_uprising }
								any_state = {
									is_controlled_by = ROOT
									NOT = { has_state_flag = anarchist_uprising }
									distance_to = {
										target = PREV
										value < 750
									}
								}
							}
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 750
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
				else_if = {
					limit = {
						FROM = {
							any_controlled_state = {
								is_in_home_area = yes
								is_capital = no
								NOT = { has_state_flag = anarchist_uprising }
								any_state = {
									is_controlled_by = ROOT
									NOT = { has_state_flag = anarchist_uprising }
									distance_to = {
										target = PREV
										value < 1500
									}
								}
							}
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 1500
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
				else = {
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
			}
			if = {
				limit = {
					FROM = { num_of_controlled_states > 7 }
				}
				if = {
					limit = {
						FROM = {
							any_controlled_state = {
								is_in_home_area = yes
								is_capital = no
								NOT = { has_state_flag = anarchist_uprising }
								any_state = {
									is_controlled_by = ROOT
									NOT = { has_state_flag = anarchist_uprising }
									distance_to = {
										target = PREV
										value < 750
									}
								}
							}
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 750
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
				else_if = {
					limit = {
						FROM = {
							any_controlled_state = {
								is_in_home_area = yes
								is_capital = no
								NOT = { has_state_flag = anarchist_uprising }
								any_state = {
									is_controlled_by = ROOT
									NOT = { has_state_flag = anarchist_uprising }
									distance_to = {
										target = PREV
										value < 1500
									}
								}
							}
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 1500
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
				else = {
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
			}
			if = {
				limit = {
					FROM = { num_of_controlled_states > 11 }
				}
				if = {
					limit = {
						FROM = {
							any_controlled_state = {
								is_in_home_area = yes
								is_capital = no
								NOT = { has_state_flag = anarchist_uprising }
								any_state = {
									is_controlled_by = ROOT
									NOT = { has_state_flag = anarchist_uprising }
									distance_to = {
										target = PREV
										value < 750
									}
								}
							}
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 750
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 750
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
				else_if = {
					limit = {
						FROM = {
							any_controlled_state = {
								is_in_home_area = yes
								is_capital = no
								NOT = { has_state_flag = anarchist_uprising }
								any_state = {
									is_controlled_by = ROOT
									NOT = { has_state_flag = anarchist_uprising }
									distance_to = {
										target = PREV
										value < 1500
									}
								}
							}
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 1500
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 1500
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
				else = {
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
			}
			if = {
				limit = {
					FROM = { num_of_controlled_states > 19 }
				}
				if = {
					limit = {
						FROM = {
							any_controlled_state = {
								is_in_home_area = yes
								is_capital = no
								NOT = { has_state_flag = anarchist_uprising }
								any_state = {
									is_controlled_by = ROOT
									NOT = { has_state_flag = anarchist_uprising }
									distance_to = {
										target = PREV
										value < 750
									}
								}
							}
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 750
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 750
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
				else_if = {
					limit = {
						FROM = {
							any_controlled_state = {
								is_in_home_area = yes
								is_capital = no
								NOT = { has_state_flag = anarchist_uprising }
								any_state = {
									is_controlled_by = ROOT
									NOT = { has_state_flag = anarchist_uprising }
									distance_to = {
										target = PREV
										value < 1500
									}
								}
							}
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 1500
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
								distance_to = {
									target = PREV
									value < 1500
								}
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
				else = {
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
					random_state = {
						limit = {
							is_controlled_by = FROM
							is_in_home_area = yes
							is_capital = no
							NOT = { has_state_flag = anarchist_uprising }
							any_state = {
								is_controlled_by = ROOT
								NOT = { has_state_flag = anarchist_uprising }
							}
						}
						set_state_flag = anarchist_uprising
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
						create_unit = {
							division = "division_template = \"Anarchist Militia\" start_experience_factor = 0.1"
							owner = ROOT
							allow_spawning_on_enemy_provs = yes
						}
					}
				}
			}
		}

	}

	SPR_ignite_uprising_timer_mission = {
		icon = generic_ignite_civil_war

		available = {
			hidden_trigger = { always = no }
		}

		days_mission_timeout = 90

		fire_only_once = yes

		activation = {
			always = no
		}

		visible = {
			has_country_flag = SPR_ignite_uprising_timer_flag
		}

		cancel_if_not_visible = no

		is_good = yes

		timeout_effect = {
			clr_country_flag = SPR_ignite_uprising_timer_flag
			custom_effect_tooltip = SPR_ignite_uprising_timer_mission_tt
		}
	}

}

SPR_anti_fascist_unity = {

	SPR_concessions_to_the_anarchists = {
		icon = eng_trade_unions_support

		allowed = {
			original_tag = SPR
		}

		available = {
			OR = {
				country_exists = SPA
				country_exists = SPB
			}
		}

		cost = 25

		fire_only_once = yes

		modifier = {

		}

		days_remove = 70

		visible = {
			original_tag = SPR
			has_completed_focus = SPR_anti_fascist_unity
			NOT = { has_global_flag = scw_over }
			NOT = { has_global_flag = scw_early_end }
		}

		complete_effect = {
			add_days_mission_timeout = {
				mission = SPR_anarchist_uprising_mission
				days = 70
			}
		}

		ai_will_do = {
			factor = 400
		}
	}

}

SPR_recovering_from_civil_war = {

	SPA_recovering_from_civil_war_mission = {
		icon = generic_construction

		allowed = {
			original_tag = SPR
		}

		available = {
			always = no
		}

		days_mission_timeout = 60
		is_good = yes
		fire_only_once = yes

		activation = {
			always = no #Triggered from effect
		}

		timeout_effect = {
			SPA_recovering_from_civil_war_down = yes
			hidden_effect = {
				if = {
					limit = {
						OR = {
							has_idea = SPA_recovering_from_civil_war
							has_idea = SPA_recovering_from_civil_war_2
							has_idea = SPA_recovering_from_civil_war_3
							has_idea = SPA_recovering_from_civil_war_4
							has_idea = SPA_recovering_from_civil_war_5
							has_idea = SPA_recovering_from_civil_war_6
							has_idea = SPA_recovering_from_civil_war_7
							has_idea = SPA_recovering_from_civil_war_8
							has_idea = SPA_recovering_from_civil_war_9
							has_idea = SPA_recovering_from_civil_war_10
							has_idea = SPA_recovering_from_civil_war_11
							has_idea = SPA_recovering_from_civil_war_12
							has_idea = SPA_recovering_from_civil_war_13
							has_idea = SPA_recovering_from_civil_war_14
							has_idea = SPA_recovering_from_civil_war_15
							has_idea = SPA_recovering_from_civil_war_16
							has_idea = SPA_recovering_from_civil_war_17
							has_idea = SPA_recovering_from_civil_war_18
							has_idea = SPA_recovering_from_civil_war_19
							has_idea = SPA_recovering_from_civil_war_20
						}
					}
					activate_mission = SPA_recovering_from_civil_war_mission
				}
				else = {
					if = {
						limit = {
							has_idea = SPA_national_recovery_1
						}
						remove_ideas = SPA_national_recovery_1
					}
					if = {
						limit = {
							has_idea = SPA_national_recovery_2
						}
						remove_ideas = SPA_national_recovery_2
					}
					if = {
						limit = {
							has_idea = SPA_national_recovery_3
						}
						remove_ideas = SPA_national_recovery_3
					}
					if = {
						limit = {
							has_idea = SPA_national_recovery_4
						}
						remove_ideas = SPA_national_recovery_4
					}
				}
			}
		}
	}

	SPR_eliminate_guerrillas = {
		icon = generic_civil_support

		allowed = {
			original_tag = SPR
		}

		available = {
			if = {
				limit = {
					is_ai = no
				}
				divisions_in_state = {
					type = infantry
					size > 1
					state = FROM
				}
			}
			has_manpower > 500
			has_equipment = {
			    infantry_equipment > 500
			}
		}

		visible = {
			OR = {
				has_completed_focus = SPA_strengthen_the_supreme_reality_of_spain
				has_completed_focus = SPA_stamp_out_the_maquis
				has_completed_focus = SPR_the_inevitable_counterblow
				has_completed_focus = SPR_all_must_do_their_part
				has_completed_focus = SPR_red_bulwark_in_the_west
				has_completed_focus = SPR_stabilize_the_nation
			}
		}

		state_target = yes

		target_trigger = {
			FROM = {
				has_dynamic_modifier = {
					modifier = SPA_spanish_maquis
				}
			}
		}

		fixed_random_seed = no

		cost = 60

		fire_only_once = no

		days_remove = 210

		ai_will_do = {
			base = 200
		}

		modifier = {
			weekly_manpower = -50
		}

		complete_effect = {
			add_equipment_to_stockpile = {
			    type = infantry_equipment
			    amount = -1500
			}
		}

		remove_effect = {
			country_event = spa_armor.803
				FROM = {
					remove_dynamic_modifier = {
						modifier = SPA_spanish_maquis
					}
				}
		}
	}

}