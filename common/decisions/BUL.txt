### AI ###
#BUL_is_historical_ai
#BUL_is_communist_stalinist_ai
#BUL_is_communist_balkan_ai
#BUL_is_democratic_socialist_ai
#BUL_is_democratic_liberal_ai
#BUL_is_fascist_axis_ai
#BUL_is_monarchist_ferdinand_ai

political_actions = {
	BUL_german_industrial_agreements_GER = {
		name = BUL_german_industrial_agreements

		priority = 58

		icon = generic_factory

		allowed = { always = no }

		ai_will_do = {
			base = 10
		}

		available = {
		}

		visible = {
		}

		days_remove = 365

		fire_only_once = yes

		cost = 25

		complete_effect = {
			add_offsite_building = {
				type = industrial_complex
				level = 4
			}
		}

		remove_effect = {
			add_offsite_building = {
				type = industrial_complex
				level = -4
			}
		}
	}

	BUL_british_industrial_agreements_ENG = {
		name = BUL_british_industrial_agreements

		priority = 58

		icon = generic_factory

		allowed = { always = no }

		ai_will_do = {
			base = 10
		}

		available = {
		}

		visible = {
			country_exists = BUL
			BUL = {
				has_completed_focus = BUL_invest_back_into_the_economy
			}
		}

		days_remove = 365

		fire_only_once = yes

		cost = 25

		complete_effect = {
			add_offsite_building = {
				type = industrial_complex
				level = 4
			}
		}

		remove_effect = {
			add_offsite_building = {
				type = industrial_complex
				level = -4
			}
		}
	}

	BUL_soviet_industrial_agreements_SOV = {
		name = BUL_soviet_industrial_agreements

		priority = 58

		icon = generic_factory

		allowed = { always = no }

		ai_will_do = {
			base = 10
		}

		available = {
		}

		visible = {
		}

		days_remove = 365

		fire_only_once = yes

		cost = 25

		complete_effect = {
			add_offsite_building = {
				type = industrial_complex
				level = 4
			}
		}

		remove_effect = {
			add_offsite_building = {
				type = industrial_complex
				level = -4
			}
		}
	}
	BUL_tackle_civil_unrest = {
		icon = generic_police_action
		allowed = {
			tag = BUL
		}

		available = {
			FROM = {
				OR = {
					state = 764
					state = 107
					state = 108
					state = 851
					state = 106
					state = 731
					state = 184
					state = 77
					state = 898
					state = 341
					state = 899
					state = 900
					state = 46
					state = 81
				}
				NOT = { is_core_of = CONTROLLER }
				CONTROLLER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
						is_in_faction_with = ROOT
					}
					army_manpower_in_state = { state = FROM.ID amount > 21000 }
				}
			}
			has_completed_focus = BUL_contribute_to_the_occupation
		}

		target_trigger = {
			FROM = {
				OR = {
					state = 764
					state = 107
					state = 108
					state = 851
					state = 106
					state = 731
					state = 184
					state = 77
					state = 898
					state = 341
					state = 899
					state = 900
					state = 46
					state = 81
				}
				NOT = { is_core_of = CONTROLLER }
				CONTROLLER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
						is_in_faction_with = ROOT
					}
				}
			}
		}

		visible = {
			FROM = {
				OR = {
					state = 764
					state = 107
					state = 108
					state = 851
					state = 106
					state = 731
					state = 184
					state = 77
					state = 898
					state = 341
					state = 899
					state = 900
					state = 46
					state = 81
				}
				NOT = { is_core_of = CONTROLLER }
				CONTROLLER = {
					OR = {
						tag = ROOT
						is_subject_of = ROOT
						is_in_faction_with = ROOT
					}
				}
			}
			has_completed_focus = BUL_contribute_to_the_occupation
		}

		cost = 0

		fire_only_once = no
		custom_cost_trigger = {
			command_power > 9
		}
		custom_cost_text = custom_cost_10_cp

		ai_will_do = {
			factor = 400
		}

		days_remove = 90
		days_re_enable = 90

		state_target = yes

		cancel_if_not_visible = yes

		on_map_mode = map_and_decisions_view

		modifier = {
			political_power_cost = 0.5
		}

		complete_effect = {
			hidden_effect = {
				add_command_power = -10
			}
			FROM = {
				add_resistance = -10
			}
		}

		remove_effect = {
		}
	}

	BUL_encourage_compliance = {
		icon = generic_christian_orthodox
		allowed = {
			tag = BUL
		}

		available = {
			FROM = {
				OR = {
					is_core_of = SER
					is_core_of = GRE
					is_core_of = MAC
					is_core_of = ROM
					is_core_of = MNT
				}
			    compliance < 95
				NOT = { is_core_of = CONTROLLER }
				CONTROLLER = {
					tag = ROOT
				}
			}
			has_completed_focus = BUL_restore_the_bulgarian_patriarchate
		}

		target_trigger = {
			FROM = {
				OR = {
					is_core_of = SER
					is_core_of = GRE
					is_core_of = MAC
					is_core_of = ROM
					is_core_of = MNT
				}
			    compliance < 95
				NOT = { is_core_of = CONTROLLER }
				CONTROLLER = {
					tag = ROOT
				}
			}
		}

		visible = {
			FROM = {
				OR = {
					is_core_of = SER
					is_core_of = GRE
					is_core_of = MAC
					is_core_of = ROM
					is_core_of = MNT
				}
			    compliance < 95
				NOT = { is_core_of = CONTROLLER }
				CONTROLLER = {
					tag = ROOT
				}
			}
			has_completed_focus = BUL_restore_the_bulgarian_patriarchate
		}

		cost = 25

		fire_only_once = no

		ai_will_do = {
			factor = 400
		}

		days_remove = 90
		days_re_enable = 90

		state_target = yes

		cancel_if_not_visible = yes

		on_map_mode = map_and_decisions_view

		modifier = {
		}

		complete_effect = {
			FROM = {
				add_compliance = 5
			}
		}

		remove_effect = {
		}
	}
}

operations = {

	BUL_outlast_the_invasion = {
		icon = border_war

		allowed = {
			tag = BUL
		}

		days_mission_timeout = 180
		is_good = no

		cancel_trigger = {
			OR = {
				is_in_faction = yes
				NOT = { controls_state = 48 }
			}
		}

		available = {
			OR = {
				all_enemy_country = {
					casualties_k > 60
				}
				custom_trigger_tooltip = {
					tooltip = BUL_outlast_the_invasion_tt
					always = no
				}
			}
		}

		activation = {
			always = no
		}

		complete_effect = {
			every_enemy_country = {
				white_peace = BUL
			}
		}

		timeout_effect = {
			hidden_effect = {
				every_enemy_country = {
					white_peace = BUL
				}
			}
		}
	}
}


########  ########    ###    ########  ##     ##    ###    ##     ## ######## ##    ## ########
##     ## ##         ## ##   ##     ## ###   ###   ## ##   ###   ### ##       ###   ##    ##
##     ## ##        ##   ##  ##     ## #### ####  ##   ##  #### #### ##       ####  ##    ##
########  ######   ##     ## ########  ## ### ## ##     ## ## ### ## ######   ## ## ##    ##
##   ##   ##       ######### ##   ##   ##     ## ######### ##     ## ##       ##  ####    ##
##    ##  ##       ##     ## ##    ##  ##     ## ##     ## ##     ## ##       ##   ###    ##
##     ## ######## ##     ## ##     ## ##     ## ##     ## ##     ## ######## ##    ##    ##


BUL_rearmament = {
	BUL_demonstrate_our_policies_of_peace = {
		icon = GFX_decision_generic_form_nation

		allowed = {
			original_tag = BUL
		}

		available = {
			has_war = no
			NOT = { has_country_flag = BUL_rearmament_negotiations_ongoing_flag }
			custom_trigger_tooltip = {
				tooltip = BUL_not_justifying_wargoals_tt
				NOT = {
					any_country = {
						BUL = {
							is_justifying_wargoal_against = PREV
						}
					}
				}
			}
		}

		visible = {
			has_idea = BUL_treaty_of_neuilly_sur_seine
			has_completed_focus = BUL_negotiate_bulgarian_rearmament
		}

		cancel_trigger = {
			focus_progress = {
				focus = BUL_support_macedonian_organizations
				progress > 0
			}
		}

		cancel_effect = {
			clr_country_flag = BUL_rearmament_negotiations_ongoing_flag
		}

		ai_will_do = {
			base = 100
			modifier = {
				factor = 100
				is_historical_focus_on = yes
			}
			modifier = {
				factor = 0
				has_government = fascism
			}
		}

		cost = 50

		days_remove = 90

		fire_only_once = yes

		complete_effect = {
			set_country_flag = BUL_rearmament_negotiations_ongoing_flag
		}

		remove_effect = {
			unlock_decision_tooltip = BUL_negotiate_bulgarian_rearmament
			clr_country_flag = BUL_rearmament_negotiations_ongoing_flag
			set_country_flag = { flag = BUL_rearmament_flag value = 1 }
		}
	}

	BUL_negotiate_bulgarian_rearmament = {
		icon = GFX_decision_generic_industry

		allowed = {
			original_tag = BUL
		}

		available = {
			has_war = no
			NOT = { has_country_flag = BUL_rearmament_negotiations_ongoing_flag }
			custom_trigger_tooltip = {
				tooltip = BUL_not_justifying_wargoals_tt
				NOT = {
					any_country = {
						BUL = {
							is_justifying_wargoal_against = PREV
						}
					}
				}
			}
		}

		visible = {
			has_idea = BUL_treaty_of_neuilly_sur_seine
			has_completed_focus = BUL_negotiate_bulgarian_rearmament
			has_country_flag = { flag = BUL_rearmament_flag value = 1 }
		}

		cost = 50

		days_remove = 30

		fire_only_once = yes

		ai_will_do = {
			base = 100
			modifier = {
				factor = 100
				is_historical_focus_on = yes
			}
			modifier = {
				factor = 0.5
				has_government = fascism
			}
		}

		complete_effect = {
			set_country_flag = BUL_rearmament_negotiations_ongoing_flag
			set_country_flag = { flag = BUL_rearmament_flag value = 2 }
		}

		remove_effect = {
			clr_country_flag = BUL_rearmament_negotiations_ongoing_flag
			ENG = { country_event = bftb_bulgaria_rearmament.1 }
			custom_effect_tooltip = BUL_rearmament_main_factors_tt
		}
		}

	#	BUL_pressure_to_lift_army_restrictions = {
	#		icon = GFX_decision_eng_trade_unions_support
	#
	#		allowed = {
	#			original_tag = BUL
	#		}
	#
	#		available = {
	#			has_war = no
	#			NOT = { has_country_flag = BUL_rearmament_negotiations_ongoing_flag }
	#			custom_trigger_tooltip = {
	#				tooltip = BUL_not_justifying_wargoals_tt
	#				NOT = {
	#					any_country = {
	#						BUL = {
	#							is_justifying_wargoal_against = PREV
	#						}
	#					}
	#				}
	#			}
	#		}
	#
	#		visible = {
	#			has_idea = BUL_treaty_of_neuilly_sur_seine
	#			has_country_flag = { flag = BUL_rearmament_flag value = 2 }
	#		}
	#
	#		fire_only_once = yes
	#
	#		cost = 50
	#
	#		ai_will_do = {
	#			base = 100
	#			modifier = {
	#				factor = 100
	#				is_historical_focus_on = yes
	#			}
	#			modifier = {
	#				factor = 0.5
	#				has_government = fascism
	#			}
	#		}
	#
	#		complete_effect = {
	#			ENG = { country_event = { id = bftb_bulgaria_rearmament.7 hours = 1 } }
	#			custom_effect_tooltip = BUL_rearmament_main_factors_tt
	#		}
	#	}
}


########  ##     ## ##    ##    ########  #######  ##     ## #### ########  ##     ## ######## ##    ## ########
##     ## ##     ##  ##  ##     ##       ##     ## ##     ##  ##  ##     ## ###   ### ##       ###   ##    ##
##     ## ##     ##   ####      ##       ##     ## ##     ##  ##  ##     ## #### #### ##       ####  ##    ##
########  ##     ##    ##       ######   ##     ## ##     ##  ##  ########  ## ### ## ######   ## ## ##    ##
##     ## ##     ##    ##       ##       ##  ## ## ##     ##  ##  ##        ##     ## ##       ##  ####    ##
##     ## ##     ##    ##       ##       ##    ##  ##     ##  ##  ##        ##     ## ##       ##   ###    ##
########   #######     ##       ########  ##### ##  #######  #### ##        ##     ## ######## ##    ##    ##


BUL_purchase_equipment = {
	BUL_purchase_infantry_equipment = {

		priority = 10

		icon = generic_industry

		allowed = { always = no } #Activated from effect

		available = {
			FROM = {
				has_opinion = {
					target = ROOT
					value > 0
				}
				BUL_is_valid_subject = yes
			}
			FROM = {
				OR = {
					has_tech = infantry_weapons
					has_tech = fra_infantry_weapons_1
					has_tech = ita_infantry_weapons_1
					has_tech = jap_infantry_weapons_1
					has_tech = ger_infantry_weapons_1
					has_tech = sov_infantry_weapons_1
					has_tech = eng_infantry_weapons_1
					has_tech = usa_infantry_weapons_1
				}
			}
			NOT = { has_country_flag = BUL_purchasing_infantry_equipment_flag }


			NOT = { has_war_with = FROM }
			NOT = { is_justifying_wargoal_against = FROM }
			if = {
				limit = {
					FROM = { tag = GER }
				}
				OR = {
					is_in_faction_with = GER
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ITA }
				}
				OR = {
					is_in_faction_with = ITA
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ENG }
				}
				OR = {
					is_in_faction_with = ENG
				}
			}
			else_if = {
				limit = {
					FROM = { tag = SOV }
				}
				OR = {
					is_in_faction_with = SOV
				}
			}
		}

		visible = {
			country_exists = FROM
			NOT = { has_war_with = FROM }
			FROM = { BUL_is_valid_subject = yes }
		}

		cost = BUL_purchase_equipment_cost
		days_remove = 90
		days_re_enable = 90
		fire_only_once = no

		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 2
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 0
				OR = {
					num_of_civilian_factories < 10
					stockpile_ratio = {
		  				archetype = infantry_equipment
		  				ratio > 0.75
		  			}
				}
			}
			modifier = {
				factor = 0
				NOT = { is_in_faction_with = FROM }
			}
		}
		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = BUL_purchasing_infantry_equipment_flag
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = 1
				}
				add_opinion_modifier = {
					target = BUL
					modifier = BUL_bought_guns
				}

			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_sold_guns
			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_arms_trade
			}
		}
		remove_effect = {
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = BUL_quantity_purchased_infantry_equipment
				producer = FROM
			}
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			clr_country_flag = BUL_purchasing_infantry_equipment_flag
		}
	}

	BUL_purchase_artillery = {

		priority = 9

		icon = ger_military_buildup

		allowed = { always = no } #Activated from effect

		available = {
			FROM = {
				has_opinion = {
					target = ROOT
					value > 0
				}
				BUL_is_valid_subject = yes
			}
			FROM = {
				OR = {
					has_tech = artillery_1
					has_tech = fra_artillery_1
					has_tech = ita_artillery_1
					has_tech = jap_artillery_1
					has_tech = ger_artillery_1
					has_tech = sov_artillery_1
					has_tech = eng_artillery_1
					has_tech = usa_artillery_1
				}
			}
			NOT = { has_country_flag = BUL_purchasing_artillery_flag }

			NOT = { has_war_with = FROM }
			NOT = { is_justifying_wargoal_against = FROM }
			if = {
				limit = {
					FROM = { tag = GER }
				}
				OR = {
					is_in_faction_with = GER
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ITA }
				}
				OR = {
					is_in_faction_with = ITA
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ENG }
				}
				OR = {
					is_in_faction_with = ENG
				}
			}
			else_if = {
				limit = {
					FROM = { tag = SOV }
				}
				OR = {
					is_in_faction_with = SOV
				}
			}
		}

		visible = {
			country_exists = FROM
			NOT = { has_war_with = FROM }
			FROM = { BUL_is_valid_subject = yes }
		}

		cost = BUL_purchase_equipment_cost
		days_remove = 90
		days_re_enable = 90
		fire_only_once = no

		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 2
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 0
				OR = {
					num_of_civilian_factories < 10
					AND = {
						stockpile_ratio = {
			  				archetype = artillery_equipment
			  				ratio > 0.75
			  			}
			  			stockpile_ratio = {
			  				archetype = anti_air_equipment
			  				ratio > 0.75
			  			}
			  			stockpile_ratio = {
			  				archetype = anti_tank_equipment
			  				ratio > 0.75
			  			}
					}
				}
			}
			modifier = {
				factor = 0
				NOT = { is_in_faction_with = FROM }
			}
		}

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = BUL_purchasing_artillery_flag
			hidden_effect = {
				set_variable = { BUL_artillery_seller = FROM }
				country_event = bftb_bulgaria_equipment_purchases.1
			}

			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = 1
				}
				add_opinion_modifier = {
					target = BUL
					modifier = BUL_bought_guns
				}

			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_sold_guns
			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_arms_trade
			}
			custom_effect_tooltip = BUL_purchase_artillery_tt
		}
		remove_effect = {
			add_equipment_to_stockpile = {
				type = var:BUL_artillery_type
				amount = BUL_quantity_purchased_artillery
				producer = FROM
			}
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			clear_variable = BUL_artillery_type
			clr_country_flag = BUL_purchasing_artillery_flag
		}
	}

	BUL_purchase_military_vehicles = {

		priority = 8

		icon = generic_decision

		allowed = { always = no } #Activated from effect

		available = {
			FROM = {
				has_opinion = {
					target = ROOT
					value > 0
				}
				BUL_is_valid_subject = yes
			}
			FROM = {
            	OR = {
                	has_tech = motorised_infantry
                	has_tech = fra_motorised_infantry
                	has_tech = ita_motorised_infantry
                	has_tech = jap_motorised_infantry
                	has_tech = ger_motorised_infantry
                	has_tech = sov_motorised_infantry
                	has_tech = eng_motorised_infantry
                	has_tech = usa_motorised_infantry
                }
            }
			NOT = { has_country_flag = BUL_purchasing_military_vehicles_flag }

			NOT = { has_war_with = FROM }
			NOT = { is_justifying_wargoal_against = FROM }
			if = {
				limit = {
					FROM = { tag = GER }
				}
				OR = {
					is_in_faction_with = GER
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ITA }
				}
				OR = {
					is_in_faction_with = ITA
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ENG }
				}
				OR = {
					is_in_faction_with = ENG
				}
			}
			else_if = {
				limit = {
					FROM = { tag = SOV }
				}
				OR = {
					is_in_faction_with = SOV
				}
			}
		}

		visible = {
			country_exists = FROM
			NOT = { has_war_with = FROM }
			FROM = { BUL_is_valid_subject = yes }
		}

		cost = BUL_purchase_equipment_cost
		days_remove = 90
		days_re_enable = 90
		fire_only_once = no

		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 2
				is_in_faction_with = FROM
			}
			modifier = {
				factor = 0
				OR = {
					num_of_civilian_factories < 10
					AND = {
						stockpile_ratio = {
			  				archetype = motorized_equipment
			  				ratio > 0.75
			  			}
			  			stockpile_ratio = {
			  				archetype = mechanized_equipment
			  				ratio > 0.75
			  			}
			  			stockpile_ratio = {
			  				archetype = armoured_car_equipment
			  				ratio > 0.75
			  			}
					}
				}
			}
		}

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = BUL_purchasing_military_vehicles_flag
			hidden_effect = {
				set_variable = { BUL_military_vehicles_seller = FROM }
				country_event = bftb_bulgaria_equipment_purchases.2
			}
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = 1
				}
				add_opinion_modifier = {
					target = BUL
					modifier = BUL_bought_guns
				}

			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_sold_guns
			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_arms_trade
			}
			custom_effect_tooltip = BUL_purchase_vehicles_tt
		}
		remove_effect = {
			if = {
				limit = {
					FROM = { has_country_flag = BUL_producing_motorized_for_bulgaria_flag }
				}
				add_equipment_to_stockpile = {
					type = var:BUL_vehicle_type
					amount = BUL_quantity_purchased_motorized
					producer = FROM
				}
				FROM = { clr_country_flag = BUL_producing_motorized_for_bulgaria_flag }
			}
			else_if = {
				limit = {
					FROM = { has_country_flag = BUL_producing_mechanized_for_bulgaria_flag }
				}
				add_equipment_to_stockpile = {
					type = var:BUL_vehicle_type
					amount = BUL_quantity_purchased_mechanized
					producer = FROM
				}
				FROM = { clr_country_flag = BUL_producing_mechanized_for_bulgaria_flag }
			}
			else = {
				add_equipment_to_stockpile = {
					type = var:BUL_vehicle_type
					amount = BUL_quantity_purchased_armored_car
					producer = FROM
				}
				FROM = { clr_country_flag = BUL_producing_armored_car_for_bulgaria_flag }
			}
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			clear_variable = BUL_vehicle_type
			clr_country_flag = BUL_purchasing_military_vehicles_flag
		}
	}

	BUL_purchase_armor = {

		priority = 7

		icon = generic_tank

		allowed = { always = no } #Activated from effect

		available = {
			FROM = {
				has_opinion = {
					target = ROOT
					value > 0
				}
				BUL_is_valid_subject = yes
			}
			FROM = {
				OR = {
					has_tech = generic_light_tank_1
					has_tech = fra_light_tank_chassis_0
					has_tech = ita_light_tank_chassis_1
					has_tech = jap_light_tank_chassis_1
					has_tech = ger_light_tank_chassis_1
					has_tech = sov_light_tank_chassis_1
					has_tech = eng_light_tank_chassis_1
					has_tech = usa_light_tank_chassis_1
				}
			}
			NOT = { has_country_flag = BUL_purchasing_armor_flag }

			NOT = { has_war_with = FROM }
			NOT = { is_justifying_wargoal_against = FROM }
			if = {
				limit = {
					FROM = { tag = GER }
				}
				OR = {
					is_in_faction_with = GER
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ITA }
				}
				OR = {
					is_in_faction_with = ITA
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ENG }
				}
				OR = {
					is_in_faction_with = ENG
				}
			}
			else_if = {
				limit = {
					FROM = { tag = SOV }
				}
				OR = {
					is_in_faction_with = SOV
				}
			}
		}

		visible = {
			country_exists = FROM
			NOT = { has_war_with = FROM }
			FROM = { BUL_is_valid_subject = yes }
		}

		cost = BUL_purchase_equipment_cost
		days_remove = 90
		days_re_enable = 90
		fire_only_once = no

		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				OR = {
					NOT = { is_in_faction_with = FROM }
					num_of_civilian_factories < 10
					AND = {
						stockpile_ratio = {
			  				archetype = light_tank_chassis
			  				ratio > 0.75
			  			}
			  			stockpile_ratio = {
			  				archetype = medium_tank_chassis
			  				ratio > 0.75
			  			}
			  			stockpile_ratio = {
			  				archetype = heavy_tank_chassis
			  				ratio > 0.75
			  			}
					}
				}
			}
		}

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = BUL_purchasing_armor_flag
			hidden_effect = {
				set_variable = { BUL_armor_seller = FROM }
				country_event = bftb_bulgaria_equipment_purchases.3
			}
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = 1
				}
				add_opinion_modifier = {
					target = BUL
					modifier = BUL_bought_guns
				}

			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_sold_guns
			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_arms_trade
			}
			custom_effect_tooltip = BUL_purchase_armor_tt
		}
		remove_effect = {
			if = {
				limit = {
					FROM = { has_country_flag = BUL_producing_light_armor_for_bulgaria_flag }
				}
				add_equipment_to_stockpile = {
					type = var:BUL_armor_type
					amount = BUL_quantity_purchased_light_armor
					producer = FROM
				}
				FROM = { clr_country_flag = BUL_producing_light_armor_for_bulgaria_flag }
			}
			else_if = {
				limit = {
					FROM = { has_country_flag = BUL_producing_medium_armor_for_bulgaria_flag }
				}
				add_equipment_to_stockpile = {
					type = var:BUL_armor_type
					amount = BUL_quantity_purchased_medium_armor
					producer = FROM
				}
				FROM = { clr_country_flag = BUL_producing_medium_armor_for_bulgaria_flag }
			}
			else = {
				add_equipment_to_stockpile = {
					type = var:BUL_armor_type
					amount = BUL_quantity_purchased_heavy_armor
					producer = FROM
				}
				FROM = { clr_country_flag = BUL_producing_heavy_armor_for_bulgaria_flag }
			}
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			clear_variable = BUL_vehicle_type
			clr_country_flag = BUL_purchasing_armor_flag
		}
	}

	# BUL_purchase_aircraft = {

	# 	priority = 6

	# 	icon = generic_air

	# 	allowed = { always = no } #Activated from effect

	# 	available = {
	# 		FROM = {
	# 			has_opinion = {
	# 				target = ROOT
	# 				value > 0
	# 			}
	# 			BUL_is_valid_subject = yes
	# 		}
	# 		OR = {
	# 			FROM = { has_tech = early_fighter }
	# 			FROM = { has_tech = fra_fighter_2 }
	# 			FROM = { has_tech = ita_fighter_2 }
	# 			FROM = { has_tech = jap_fighter_1 }
	# 			FROM = { has_tech = ger_fighter_3 }
	# 			FROM = { has_tech = sov_fighter_multirole_1 }
	# 			FROM = { has_tech = eng_fighter_2 }
	# 			FROM = { has_tech = usa_fighter_1 }
	# 		}
	# 		NOT = { has_country_flag = BUL_purchasing_aircraft_flag }

	# 		NOT = { has_war_with = FROM }
	# 		NOT = { is_justifying_wargoal_against = FROM }
	# 		if = {
	# 			limit = {
	# 				FROM = { tag = GER }
	# 			}
	# 			OR = {
	# 				is_in_faction_with = GER
	# 			}
	# 		}
	# 		else_if = {
	# 			limit = {
	# 				FROM = { tag = ITA }
	# 			}
	# 			OR = {
	# 				is_in_faction_with = ITA
	# 			}
	# 		}
	# 		else_if = {
	# 			limit = {
	# 				FROM = { tag = ENG }
	# 			}
	# 			OR = {
	# 				is_in_faction_with = ENG
	# 			}
	# 		}
	# 		else_if = {
	# 			limit = {
	# 				FROM = { tag = SOV }
	# 			}
	# 			OR = {
	# 				is_in_faction_with = SOV
	# 			}
	# 		}
	# 	}

	# 	visible = {
	# 		country_exists = FROM
	# 		NOT = { has_war_with = FROM }
	# 		FROM = { BUL_is_valid_subject = yes }
	# 	}

	# 	cost = BUL_purchase_equipment_cost
	# 	days_remove = 90
	# 	days_re_enable = 90
	# 	fire_only_once = no

	# 	ai_will_do = {
	# 		factor = 0.1
	# 		modifier = {
	# 			factor = 2
	# 			is_in_faction_with = FROM
	# 		}
	# 		modifier = {
	# 			factor = 0
	# 			OR = {
	# 				num_of_civilian_factories < 10
	# 				AND = {
	# 					stockpile_ratio = {
	# 		  				archetype = fighter_equipment
	# 		  				ratio > 0.75
	# 		  			}
	# 		  			stockpile_ratio = {
	# 		  				archetype = nav_bomber_equipment
	# 		  				ratio > 0.75
	# 		  			}
	# 		  			stockpile_ratio = {
	# 		  				archetype = tac_bomber_equipment
	# 		  				ratio > 0.75
	# 		  			}
	# 				}
	# 			}
	# 		}
	# 	}

	# 	modifier = {
	# 		civilian_factory_use = 1
	# 	}

	# 	complete_effect = {
	# 		set_country_flag = BUL_purchasing_aircraft_flag
	# 		hidden_effect = {
	# 			set_variable = { BUL_aircraft_seller = FROM }
	# 			country_event = bftb_bulgaria_equipment_purchases.4
	# 		}
	# 		FROM = {
	# 			add_offsite_building = {
	# 				type = industrial_complex
	# 				level = 1
	# 			}
	# 			add_opinion_modifier = {
	# 				target = BUL
	# 				modifier = BUL_bought_guns
	# 			}

	# 		}
	# 		add_opinion_modifier = {
	# 			target = FROM
	# 			modifier = BUL_sold_guns
	# 		}
	# 		add_opinion_modifier = {
	# 			target = FROM
	# 			modifier = BUL_arms_trade
	# 		}
	# 		custom_effect_tooltip = BUL_purchase_aircraft_tt
	# 	}
	# 	remove_effect = {
	# 		if = {
	# 			limit = {
	# 				FROM = { has_country_flag = BUL_producing_fighters_for_bulgaria_flag }
	# 			}
	# 			add_equipment_to_stockpile = {
	# 				type = var:BUL_aircraft_type
	# 				amount = BUL_quantity_purchased_fighter
	# 				producer = FROM
	# 			}
	# 			FROM = { clr_country_flag = BUL_producing_fighters_for_bulgaria_flag }
	# 		}
	# 		else_if = {
	# 			limit = {
	# 				FROM = { has_country_flag = BUL_producing_naval_bombers_for_bulgaria_flag }
	# 			}
	# 			add_equipment_to_stockpile = {
	# 				type = var:BUL_aircraft_type
	# 				amount = BUL_quantity_purchased_naval_bomber
	# 				producer = FROM
	# 			}
	# 			FROM = { clr_country_flag = BUL_producing_naval_bombers_for_bulgaria_flag }
	# 		}
	# 		else = {
	# 			add_equipment_to_stockpile = {
	# 				type = var:BUL_aircraft_type
	# 				amount = BUL_quantity_purchased_tactical_bomber
	# 				producer = FROM
	# 			}
	# 			FROM = { clr_country_flag = BUL_producing_tactical_bombers_for_bulgaria_flag }
	# 		}
	# 		FROM = {
	# 			add_offsite_building = {
	# 				type = industrial_complex
	# 				level = -1
	# 			}
	# 		}
	# 		clear_variable = BUL_vehicle_type
	# 		clr_country_flag = BUL_purchasing_aircraft_flag
	# 	}
	# }

	BUL_purchase_soviet_planes = {
		allowed = {
			original_tag = BUL
		}

		available = {
			SOV = { has_tech = sov_fighter_1 }
			SOV = { has_tech = sov_fighter_multirole_1 }
			num_of_civilian_factories_available_for_projects > 4
		}

		visible = {
			has_completed_focus = BUL_requip_the_airforce
		}

		cancel_trigger = {
			SOV = {
				OR = {
					has_war_with = ROOT
					has_capitulated = yes
				}
			}
		}

		fire_only_once = yes

		days_remove = 60

		modifier = {
			civilian_factory_use = 5
		}

		complete_effect = {
		}

		remove_effect = {
			add_equipment_to_stockpile = {
				type = sov_fighter_equipment_1
				amount = 50
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = sov_fighter_multirole_equipment_1
				amount = 50
				producer = SOV
			}
		}
	}

	BUL_purchase_german_planes = {
		allowed = {
			original_tag = BUL
		}

		available = {
			GER = { has_tech = ger_fighter_1 }
			num_of_civilian_factories_available_for_projects > 4
		}

		visible = {
			has_completed_focus = BUL_requip_the_airforce
		}

		cancel_trigger = {
			GER = {
				OR = {
					has_war_with = ROOT
					has_capitulated = yes
				}
			}
		}

		fire_only_once = yes

		days_remove = 60

		modifier = {
			civilian_factory_use = 5
		}

		complete_effect = {
		}

		remove_effect = {
			add_equipment_to_stockpile = {
				type = ger_fighter_equipment_1
				amount = 100
				producer = GER
			}
		}
	}

	BUL_purchase_modern_planes = {
		allowed = {
			original_tag = BUL
		}

		available = {
			OR = {
				AND = {
					is_in_faction_with = GER
					GER = {
						has_tech = ger_fighter_4
					}
				}
				AND = {
					is_in_faction_with = SOV
					SOV = {
						has_tech = sov_fighter_3
					}
				}
				AND = {
					is_in_faction_with = ITA
					ITA = {
						has_tech = ita_fighter_3
					}
				}
			}
		}

		visible = {
			has_completed_focus = BUL_buy_modern_planes
		}

		cancel_trigger = {
		}

		fire_only_once = yes

		days_remove = 60

		modifier = {
			civilian_factory_use = 12
		}

		complete_effect = {
			country_event = { id = bul_armor.807 }
		}

		remove_effect = {
		}
	}

	BUL_purchase_destroyers = {

		priority = 1

		icon = GFX_decision_generic_naval

		targets = { ITA SOV ENG }

		target_root_trigger = {
			has_completed_focus = BUL_look_for_new_surface_designs
		}

		target_trigger = {
			FROM = {
				has_opinion = {
					target = BUL
					value > 0
				}
				BUL_is_valid_subject = yes
				NOT = { has_war_with = BUL }
				NOT = { is_justifying_wargoal_against = BUL }
			}
		}

		cost = BUL_purchase_equipment_cost
		days_remove = 120
		#ays_re_enable = 7
		fire_only_once = yes

		ai_will_do = {
			factor = 1
			modifier = {
				OR = {
					num_of_civilian_factories < 10
					num_of_naval_factories < 2
				}
				factor = 0
			}
			modifier = {
				has_war = yes
				factor = 2
			}
		}

		modifier = {
			civilian_factory_use = 5
		}

		complete_effect = {
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = 5
				}
			}
		}

		remove_effect = {
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = -5
				}
				country_event = { id = bftb_bulgaria_equipment_purchases.12 hours = 1 }
			}
			if = {
				limit = {
					FROM = { tag = ENG }
				}
				set_technology = { eng_destroyer_1 = 1 }
				create_ship = { type = eng_destroyer_hull_1 equipment_variant = "V/W Class" creator = FROM }
				create_ship = { type = eng_destroyer_hull_1 equipment_variant = "V/W Class" creator = FROM }
				create_ship = { type = eng_destroyer_hull_1 equipment_variant = "V/W Class" creator = FROM }
			}
			else_if = {
				limit = {
					FROM = { tag = ITA }
				}
				set_technology = { ita_destroyer_1 = 1 }
				create_ship = { type = ita_destroyer_hull_1 equipment_variant = "Mirabello Class" creator = FROM }
				create_ship = { type = ita_destroyer_hull_1 equipment_variant = "Mirabello Class" creator = FROM }
				create_ship = { type = ita_destroyer_hull_1 equipment_variant = "Mirabello Class" creator = FROM }
			}
			else_if = {
				limit = {
					FROM = { tag = SOV }
				}
				set_technology = { sov_destroyer_1 = 1 }
				create_ship = { type = sov_destroyer_hull_1 equipment_variant = "Orfey Class" creator = FROM }
				create_ship = { type = sov_destroyer_hull_1 equipment_variant = "Orfey Class" creator = FROM }
				create_ship = { type = sov_destroyer_hull_1 equipment_variant = "Orfey Class" creator = FROM }
			}
		}
	}
	BUL_purchase_submarines = {

		priority = 1

		icon = GFX_decision_generic_naval

		targets = { GER SOV ENG }

		target_root_trigger = {
			has_completed_focus = BUL_look_for_new_undersea_designs
		}

		target_trigger = {
			FROM = {
				has_opinion = {
					target = BUL
					value > 24
				}
				BUL_is_valid_subject = yes
				NOT = { has_war_with = BUL }
				NOT = { is_justifying_wargoal_against = BUL }
			}
		}

		cost = BUL_purchase_equipment_cost

		days_remove = 120
		#ays_re_enable = 7
		fire_only_once = yes

		ai_will_do = {
			factor = 1
			modifier = {
				OR = {
					num_of_civilian_factories < 10
					num_of_naval_factories < 2
				}
				factor = 0
			}
			modifier = {
				has_war = yes
				factor = 2
			}
		}

		modifier = {
			civilian_factory_use = 5
		}

		complete_effect = {
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = 5
				}
			}
		}

		remove_effect = {
			FROM = {
				add_offsite_building = {
					type = industrial_complex
					level = -5
				}
				country_event = { id = bftb_bulgaria_equipment_purchases.11 hours = 1 }
			}
			if = {
				limit = {
					FROM = { tag = ENG }
				}
				set_technology = { eng_submarine_1 = 1 }
				create_ship = { type = eng_submarine_hull_1 equipment_variant = "H Class" creator = FROM }
				create_ship = { type = eng_submarine_hull_1 equipment_variant = "H Class" creator = FROM }
				create_ship = { type = eng_submarine_hull_1 equipment_variant = "H Class" creator = FROM }
			}
			else_if = {
				limit = {
					FROM = { tag = GER }
				}
				set_technology = { ger_submarine_1 = 1 }
				create_ship = { type = ger_submarine_hull_1 equipment_variant = "Type II Class" creator = FROM }
				create_ship = { type = ger_submarine_hull_1 equipment_variant = "Type II Class" creator = FROM }
				create_ship = { type = ger_submarine_hull_1 equipment_variant = "Type II Class" creator = FROM }
			}
			else_if = {
				limit = {
					FROM = { tag = SOV }
				}
				set_technology = { sov_submarine_1 = 1 }
				create_ship = { type = sov_submarine_hull_1 equipment_variant = "Shchuka Class" creator = FROM }
				create_ship = { type = sov_submarine_hull_1 equipment_variant = "Shchuka Class" creator = FROM }
				create_ship = { type = sov_submarine_hull_1 equipment_variant = "Shchuka Class" creator = FROM }
			}
		}
	}
}

#### ##    ## ########  ##     ##  ######  ######## ########  ####    ###    ##
 ##  ###   ## ##     ## ##     ## ##    ##    ##    ##     ##  ##    ## ##   ##
 ##  ####  ## ##     ## ##     ## ##          ##    ##     ##  ##   ##   ##  ##
 ##  ## ## ## ##     ## ##     ##  ######     ##    ########   ##  ##     ## ##
 ##  ##  #### ##     ## ##     ##       ##    ##    ##   ##    ##  ######### ##
 ##  ##   ### ##     ## ##     ## ##    ##    ##    ##    ##   ##  ##     ## ##
#### ##    ## ########   #######   ######     ##    ##     ## #### ##     ## ########


BUL_foreign_agreements = {

	BUL_german_industrial_agreements = {


		priority = 58

		icon = generic_factory

		allowed = { original_tag = BUL }

		ai_will_do = {
			base = 10
		}

		available = {
		}

		visible = {
			country_exists = GER
			has_completed_focus = BUL_ask_for_more_investment
			not = {
				has_country_flag = BUL_refused_GER
			}
		}

		fire_only_once = yes

		days_remove = 365

		modifier = {
			production_speed_arms_factory_factor = 0.2
		}

		complete_effect = {
			GER = {
				country_event = bul_armor.808
			}
		}

		remove_effect = {
		}
	}

	BUL_british_industrial_agreements = {

		priority = 58

		icon = generic_factory

		allowed = { original_tag = BUL } #Activated from effect

		ai_will_do = {
			base = 10
		}

		available = {

		}

		visible = {
			country_exists = ENG
			has_completed_focus = BUL_ask_for_more_investment
			not = {
				has_country_flag = BUL_refused_ENG
			}
		}

		fire_only_once = yes

		days_remove = 365

		modifier = {
			production_speed_steel_refinery_factor = 0.2
			production_speed_aluminium_refinery_factor = 0.2
		}

		complete_effect = {
			ENG = {
				country_event = bul_armor.808
			}
		}

		remove_effect = {
		}
	}

	BUL_soviet_industrial_agreements = {


		priority = 58

		icon = generic_factory

		allowed = { original_tag = BUL } #Activated from effect

		ai_will_do = {
			base = 10
		}

		available = {

		}

		visible = {
			country_exists = SOV
			has_completed_focus = BUL_ask_for_more_investment
			not = {
				has_country_flag = BUL_refused_SOV
			}
		}

		fire_only_once = yes

		days_remove = 365

		modifier = {
			production_speed_industrial_complex_factor = 0.2
		}

		complete_effect = {
			SOV = {
				country_event = bul_armor.808
			}
		}

		remove_effect = {
		}
	}

	BUL_military_agreements = {

		priority = 40

		icon = generic_tank

		allowed = { always = no } #Activated from effect

		ai_will_do = {
			base = 10
		}

		available = {
			FROM = {
				has_opinion = {
					target = ROOT
					value > 49
				}
				BUL_is_valid_subject = yes
			}
			NOT = { has_country_flag = BUL_military_agreements_ongoing_flag }
			NOT = { has_war_with = FROM }
			NOT = { is_justifying_wargoal_against = FROM }
			if = {
				limit = {
					FROM = { tag = GER }
				}
				OR = {
					is_in_faction_with = GER
					AND = {
						BUL_foreign_agreements_in_faction_with_eng = yes
						BUL_foreign_agreements_in_faction_with_sov = yes
						BUL_foreign_agreements_in_faction_with_ita = yes
					}
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ITA }
				}
				OR = {
					is_in_faction_with = ITA
					AND = {
						BUL_foreign_agreements_in_faction_with_ger = yes
						BUL_foreign_agreements_in_faction_with_eng = yes
						BUL_foreign_agreements_in_faction_with_sov = yes
					}
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ENG }
				}
				OR = {
					is_in_faction_with = ENG
					AND = {
						BUL_foreign_agreements_in_faction_with_ger = yes
						BUL_foreign_agreements_in_faction_with_sov = yes
						BUL_foreign_agreements_in_faction_with_ita = yes
					}
				}
			}
			else_if = {
				limit = {
					FROM = { tag = SOV }
				}
				OR = {
					is_in_faction_with = SOV
					AND = {
						BUL_foreign_agreements_in_faction_with_ger = yes
						BUL_foreign_agreements_in_faction_with_eng = yes
						BUL_foreign_agreements_in_faction_with_ita = yes
					}
				}
			}
		}

		visible = {
			country_exists = FROM
			NOT = { has_war_with = FROM }
		}

		cost = BUL_foreign_military_agreements_cost
		days_remove = 30
		fire_only_once = yes

		modifier = {
			political_power_factor = -0.15
			consumer_goods_expected_value = 0.25
		}

		complete_effect = {
			set_country_flag = BUL_military_agreements_ongoing_flag
			FROM = {
				add_opinion_modifier = {
					target = BUL
					modifier = BUL_industrial_investments_in_bulgaria
				}
			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_industrial_investments_in_bulgaria
			}
		}

		remove_effect = {
			if = {
				limit = {
					FROM = { original_tag = GER }
				}
				set_country_flag = BUL_german_military_agreements_flag
				custom_effect_tooltip = available_designer
				show_ideas_tooltip = BUL_german_materiel_designer
				show_ideas_tooltip = BUL_german_tank_designer
			}
			if = {
				limit = {
					FROM = { original_tag = ENG }
				}
				set_country_flag = BUL_british_military_agreements_flag
				custom_effect_tooltip = available_designer
				show_ideas_tooltip = BUL_british_materiel_designer
				show_ideas_tooltip = BUL_british_tank_designer
			}
			if = {
				limit = {
					FROM = { original_tag = SOV }
				}
				set_country_flag = BUL_soviet_military_agreements_flag
				custom_effect_tooltip = available_designer
				show_ideas_tooltip = BUL_soviet_materiel_designer
				show_ideas_tooltip = BUL_soviet_tank_designer
			}
			if = {
				limit = {
					FROM = { original_tag = ITA }
				}
				set_country_flag = BUL_italian_military_agreements_flag
				custom_effect_tooltip = available_designer
				show_ideas_tooltip = BUL_italian_materiel_designer
				show_ideas_tooltip = BUL_italian_tank_designer
			}
			clr_country_flag = BUL_military_agreements_ongoing_flag
		}
	}

	BUL_naval_agreements = {

		priority = 20

		icon = generic_naval

		allowed = { always = no } #Activated from effect

		ai_will_do = {
			base = 10
		}

		available = {
			FROM = {
				has_opinion = {
					target = ROOT
					value > 49
				}
				BUL_is_valid_subject = yes
			}
			NOT = { has_country_flag = BUL_naval_agreements_ongoing_flag }
			NOT = { has_war_with = FROM }
			NOT = { is_justifying_wargoal_against = FROM }
			if = {
				limit = {
					FROM = { tag = ENG }
				}
				OR = {
					is_in_faction_with = ENG
					AND = {
						BUL_foreign_agreements_in_faction_with_sov = yes
						BUL_foreign_agreements_in_faction_with_ita = yes
					}
				}
			}
			else_if = {
				limit = {
					FROM = { tag = SOV }
				}
				OR = {
					is_in_faction_with = SOV
					AND = {
						BUL_foreign_agreements_in_faction_with_eng = yes
						BUL_foreign_agreements_in_faction_with_ita = yes
					}
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ITA }
				}
				OR = {
					is_in_faction_with = ITA
					AND = {
						BUL_foreign_agreements_in_faction_with_eng = yes
						BUL_foreign_agreements_in_faction_with_sov = yes
					}
				}
			}
		}

		visible = {
			country_exists = FROM
			NOT = { has_war_with = FROM }
		}

		cost = BUL_foreign_military_agreements_cost
		days_remove = 30
		fire_only_once = yes

		modifier = {
			political_power_factor = -0.15
			consumer_goods_expected_value = 0.25
		}

		complete_effect = {
			set_country_flag = BUL_naval_agreements_ongoing_flag
			FROM = {
				add_opinion_modifier = {
					target = BUL
					modifier = BUL_industrial_investments_in_bulgaria
				}
			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_industrial_investments_in_bulgaria
			}
		}

		remove_effect = {
			if = {
				limit = {
					FROM = { original_tag = ENG }
				}
				set_country_flag = BUL_british_naval_agreements_flag
				custom_effect_tooltip = available_designer
				show_ideas_tooltip = BUL_british_naval_designer
			}
			if = {
				limit = {
					FROM = { original_tag = SOV }
				}
				set_country_flag = BUL_soviet_naval_agreements_flag
				custom_effect_tooltip = available_designer
				show_ideas_tooltip = BUL_soviet_naval_designer
			}
			if = {
				limit = {
					FROM = { original_tag = ITA }
				}
				set_country_flag = BUL_italian_naval_agreements_flag
				custom_effect_tooltip = available_designer
				show_ideas_tooltip = BUL_italian_naval_designer
			}
			clr_country_flag = BUL_naval_agreements_ongoing_flag
		}
	}

	BUL_aircraft_agreements = {

		priority = 30

		icon = generic_air

		ai_will_do = {
			base = 10
		}

		allowed = { always = no } #Activated from effect

		available = {
			FROM = {
				has_opinion = {
					target = ROOT
					value > 49
				}
				BUL_is_valid_subject = yes
			}
			NOT = { has_country_flag = BUL_aircraft_agreements_ongoing_flag }
			NOT = { has_war_with = FROM }
			NOT = { is_justifying_wargoal_against = FROM }
			if = {
				limit = {
					FROM = { tag = GER }
				}
				OR = {
					is_in_faction_with = GER
					AND = {
						BUL_foreign_agreements_in_faction_with_eng = yes
						BUL_foreign_agreements_in_faction_with_sov = yes
					}
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ENG }
				}
				OR = {
					is_in_faction_with = ENG
					AND = {
						BUL_foreign_agreements_in_faction_with_ger = yes
						BUL_foreign_agreements_in_faction_with_sov = yes
					}
				}
			}
			else_if = {
				limit = {
					FROM = { tag = SOV }
				}
				OR = {
					is_in_faction_with = SOV
					AND = {
						BUL_foreign_agreements_in_faction_with_ger = yes
						BUL_foreign_agreements_in_faction_with_eng = yes
					}
				}
			}
		}

		visible = {
			country_exists = FROM
			NOT = { has_war_with = FROM }
		}

		cost = BUL_foreign_military_agreements_cost
		days_remove = 30
		fire_only_once = yes

		modifier = {
			political_power_factor = -0.15
			consumer_goods_expected_value = 0.25
		}

		complete_effect = {
			set_country_flag = BUL_aircraft_agreements_ongoing_flag
			FROM = {
				add_opinion_modifier = {
					target = BUL
					modifier = BUL_industrial_investments_in_bulgaria
				}
			}
			add_opinion_modifier = {
				target = FROM
				modifier = BUL_industrial_investments_in_bulgaria
			}
		}

		remove_effect = {
			if = {
				limit = {
					FROM = { original_tag = GER }
				}
				set_country_flag = BUL_german_aeronautical_agreements_flag
				custom_effect_tooltip = available_designer
				show_ideas_tooltip = BUL_german_aircraft_designer
			}
			if = {
				limit = {
					FROM = { original_tag = ENG }
				}
				set_country_flag = BUL_british_aeronautical_agreements_flag
				custom_effect_tooltip = available_designer
				show_ideas_tooltip = BUL_british_aircraft_designer
			}
			if = {
				limit = {
					FROM = { original_tag = SOV }
				}
				set_country_flag = BUL_soviet_aeronautical_agreements_flag
				custom_effect_tooltip = available_designer
				show_ideas_tooltip = BUL_soviet_aircraft_designer
			}
			clr_country_flag = BUL_aircraft_agreements_ongoing_flag
		}
	}
}


#### ##     ## ########   #######
 ##  ###   ### ##     ## ##     ##
 ##  #### #### ##     ## ##     ##
 ##  ## ### ## ########  ##     ##
 ##  ##     ## ##   ##   ##     ##
 ##  ##     ## ##    ##  ##     ##
#### ##     ## ##     ##  #######


BUL_macedonian_revolutionary_organizations = {
	BUL_repress_imro_propaganda  = {

		priority = 10

		icon = GFX_decision_eng_propaganda_campaigns

		ai_will_do = {
			base = 10
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_country_flag = BUL_macedonian_affairs_ongoing_flag }
		}

		days_remove = 60

		fire_only_once = yes

		visible = {
			has_completed_focus = BUL_condemn_macedonian_organizations
			has_civil_war = no
		}

		cost = 50

		complete_effect = {
			set_country_flag = BUL_macedonian_affairs_ongoing_flag
			set_country_flag = { flag = BUL_repress_imro_flag value = 1 }
		}

		remove_effect = {
			add_stability = 0.05
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
		}
	}

	BUL_repress_imro_persecute_activists  = {

		priority = 9

		icon = GFX_decision_generic_police_action

		ai_will_do = {
			base = 10
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_country_flag = BUL_macedonian_affairs_ongoing_flag }
			has_manpower > 2000
			has_equipment = { support_equipment > 199 }
			has_equipment = { infantry_equipment > 799 }
		}

		days_remove = 60

		fire_only_once = yes

		visible = {
			has_country_flag = { flag = BUL_repress_imro_flag value = 1 }
			has_civil_war = no
		}

		cost = 25

		complete_effect = {
			set_country_flag = BUL_macedonian_affairs_ongoing_flag
			set_country_flag = { flag = BUL_repress_imro_flag value = 2 }
			add_manpower = -2000
			add_equipment_to_stockpile = {
				type = support_equipment
				amount = -200
				producer = BUL
			}
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = -800
				producer = BUL
			}
		}

		remove_effect = {
			add_political_power = 50
			add_stability = 0.05
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
		}
	}

	BUL_repress_imro_destroy_organization  = {

		priority = 8

		icon = GFX_decision_oppression

		ai_will_do = {
			base = 1
			modifier = {
				factor = 0
				BUL_is_historical_ai = yes
			}
			modifier = {
				factor = 2
				OR = {
					has_government = communism
					has_government = democratic
				}
			}
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			has_completed_focus = BUL_arrest_leaders
			NOT = { has_country_flag = BUL_macedonian_affairs_ongoing_flag }
			has_war = no
			divisions_in_border_state = { #SOFIA - Macedonia
				size > 1
				state = 48
				border_state = 851
			}
			divisions_in_border_state = { #PLOVDIV - Central Macedonia
				size > 3
				state = 905
				border_state = 106
			}
			divisions_in_border_state = { #PLOVDIV - Thrace
				size > 3
				state = 905
				border_state = 184
			}
		}

		days_remove = 60

		visible = {
			has_country_flag = { flag = BUL_repress_imro_flag value = 2 }
			owns_state = 212
			owns_state = 48
		}

		cancel_trigger = {
			OR = {
				custom_trigger_tooltip = { #SOFIA - Macedonia
					tooltip = BUL_destroy_imro_divisions_macedonia_tt
					divisions_in_border_state = {
						size < 2
						state = 48
						border_state = 851
					}
				}
				custom_trigger_tooltip = { #PLOVDIV - Central Macedonia
					tooltip = BUL_destroy_imro_divisions_central_macedonia_tt
					divisions_in_border_state = {
						size < 4
						state = 905
						border_state = 106
					}
				}
				custom_trigger_tooltip = { #PLOVDIV - Thrace
					tooltip = BUL_destroy_imro_divisions_thrace_tt
					divisions_in_border_state = {
						size < 4
						state = 905
						border_state = 184
					}
				}
			}
		}

		cancel_effect = {
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
			48 = {
				remove_dynamic_modifier = { modifier = skirmishes_against_imro }
			}
			212 = {
				remove_dynamic_modifier = { modifier = skirmishes_against_imro }
			}
		}

		cost = 25

		complete_effect = {
			set_country_flag = BUL_macedonian_affairs_ongoing_flag

			48 = {
				add_dynamic_modifier = { modifier = skirmishes_against_imro }
			}
			212 = {
				add_dynamic_modifier = { modifier = skirmishes_against_imro }
			}
		}

		remove_effect = {
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
			set_country_flag = { flag = BUL_repress_imro_flag value = 3 }
			remove_ideas = BUL_imro_02
			add_political_power = 100

			48 = {
				remove_dynamic_modifier = { modifier = skirmishes_against_imro }
			}
			212 = {
				remove_dynamic_modifier = { modifier = skirmishes_against_imro }
			}
		}
	}

	BUL_support_imro_make_contacts = {

		priority = 10

		icon = GFX_decision_generic_political_discourse

		ai_will_do = {
			base = 10
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_country_flag = BUL_macedonian_affairs_ongoing_flag }
		}

		days_remove = 30

		fire_only_once = yes

		visible = {
			has_completed_focus = BUL_support_macedonian_organizations
			has_civil_war = no
			NOT = { has_country_flag = BUL_support_imro_flag }
		}

		cost = 50

		complete_effect = {
			set_country_flag = BUL_macedonian_affairs_ongoing_flag
			set_country_flag = { flag = BUL_support_imro_flag value = 1 }
		}

		remove_effect = {
			swap_ideas = {
				remove_idea = BUL_imro_01
				add_idea = BUL_imro_04
			}
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
		}
	}

	BUL_support_imro_supply_activists = {

		priority = 9

		icon = GFX_decision_generic_industry

		ai_will_do = {
			base = 5
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_country_flag = BUL_macedonian_affairs_ongoing_flag }
			has_equipment = { support_equipment > 99 }
			has_equipment = { infantry_equipment > 999 }
		}

		days_remove = 60

		fire_only_once = yes

		visible = {
			has_country_flag = { flag = BUL_support_imro_flag value = 1 }
			has_civil_war = no
		}

		cost = 50

		complete_effect = {
			set_country_flag = BUL_macedonian_affairs_ongoing_flag
			set_country_flag = { flag = BUL_support_imro_flag value = 2 }
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = -1000
				producer = BUL
			}
			add_equipment_to_stockpile = {
				type = support_equipment
				amount = -100
				producer = BUL
			}
		}

		remove_effect = {
			swap_ideas = {
				remove_idea = BUL_imro_04
				add_idea = BUL_imro_05
			}
			if = {
				limit = {
					any_country = {
						has_opinion_modifier = BUL_supported_imro
					}
				}
				every_country = {
					limit = {
						has_opinion_modifier = BUL_supported_imro
					}
					remove_opinion_modifier = {
						target = BUL
						modifier = BUL_supported_imro
					}
				}
			}
			every_country = {
				limit = {
					BUL_country_seeks_macedonian_stability = yes
				}
				add_opinion_modifier = {
					target = BUL
					modifier = BUL_supplied_imro
				}
			}

			#Set resistance
			every_state = {
				limit = {
					BUL_is_macedonian_state = yes
					NOT = { is_controlled_by = ROOT }
				}
				if = {
					limit = {
						NOT = { is_core_of = BUL }
					}
					add_core_of = BUL
				}
				remove_core_of = controller
				start_resistance = BUL
				hidden_effect = {
					if = {
						limit = { state = 106 }
						set_compliance = 15
						set_resistance = 15
					}
					else = {
						set_compliance = 25
						set_resistance = 10
					}
					if = {
						limit = {
							controller = {
								NOT = { has_country_flag = BUL_imro_awakened_in_country_flag }
							}
						}
						controller = {
							country_event = bftb_bulgaria_imro.1
							set_country_flag = BUL_imro_awakened_in_country_flag
						}
					}
					if = {
						limit = {
							state = 106 #MACEDONIA
						}
						controller = {
							set_country_flag = BUL_imro_awakened_in_macedonia_flag
						}
					}
					else_if = {
						limit = {
							state = 731 #CENTRAL MACEDONIA
						}
						controller = {
							set_country_flag = BUL_imro_awakened_in_central_macedonia_flag
						}
					}
					else = { #THRACE
						controller = {
							set_country_flag = BUL_imro_awakened_in_thrace_flag
						}
					}
				}
				custom_effect_tooltip = BUL_support_imro_supply_activists_resistance_tt
			}
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
		}
	}

	BUL_support_imro_prepare_bulgarian_occupation = {

		priority = 8

		icon = GFX_decision_generic_nationalism

		ai_will_do = {
			base = 10
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_country_flag = BUL_macedonian_affairs_ongoing_flag }
		}

		days_remove = 180

		fire_only_once = yes

		visible = {
			has_country_flag = { flag = BUL_support_imro_flag value = 2 }
			has_civil_war = no
		}

		cost = 50

		complete_effect = {
			set_country_flag = { flag = BUL_support_imro_flag value = 3 }
			set_country_flag = BUL_macedonian_affairs_ongoing_flag
		}

		remove_effect = {
			every_state = {
				limit = {
					BUL_is_macedonian_state = yes
					is_controlled_by = ROOT
				}
				add_dynamic_modifier = { modifier = widespread_bulgarian_sentiment_02 }
			}
			every_state = {
				limit = {
					BUL_is_macedonian_state = yes
					NOT = { is_controlled_by = ROOT }
				}
				add_dynamic_modifier = { modifier = widespread_bulgarian_sentiment_01 }
				hidden_effect = {
					controller = { country_event = bftb_bulgaria_imro.2 }
				}
			}

			custom_effect_tooltip = BUL_widespread_bulgarian_sentiment_tt
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
		}
	}

	BUL_support_imro_militias = {

		priority = 7

		icon = GFX_decision_generic_military

		ai_will_do = { #AI should use the IMRO as garrison instead
			base = 0
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_country_flag = BUL_macedonian_affairs_ongoing_flag }
			has_war = yes
			any_state = {
				BUL_is_macedonian_state = yes
				is_fully_controlled_by = ROOT
			}
		}

		days_remove = 7

		fire_only_once = yes

		visible = {
			has_country_flag = { flag = BUL_support_imro_flag value = 3 }
			has_civil_war = no
		}

		cancel_effect = {
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
		}

		cancel_trigger = {
			NOT = {
				any_state = {
					BUL_is_macedonian_state = yes
					is_fully_controlled_by = ROOT
				}
			}
		}

		cost = 50

		complete_effect = {
			set_country_flag = { flag = BUL_support_imro_flag value = 4 }
		}

		remove_effect = {
			division_template = {
				name = "Makedonska Revolyutsionna Militsiya"
				is_locked = yes
				template_counter = 6
				division_names_group = BUL_INF_05
				regiments = {
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 0 y = 2 }
					infantry = { x = 1 y = 0 }
					infantry = { x = 1 y = 1 }
					infantry = { x = 1 y = 2 }
				}
			}
			if = {
				limit = {
					106 = {	is_fully_controlled_by = ROOT }
				}
				106 = {
					create_unit = {
						division = "division_template = \"Makedonska Revolyutsionna Militsiya\" start_experience_factor = 0.4"
						owner = ROOT
					}
					create_unit = {
						division = "division_template = \"Makedonska Revolyutsionna Militsiya\" start_experience_factor = 0.4"
						owner = ROOT
					}
					create_unit = {
						division = "division_template = \"Makedonska Revolyutsionna Militsiya\" start_experience_factor = 0.4"
						owner = ROOT
					}
				}
				every_state = {
					limit = {
						BUL_is_macedonian_state = yes
						is_fully_controlled_by = BUL
						NOT = { state = 106 }
					}
					create_unit = {
						division = "division_template = \"Makedonska Revolyutsionna Militsiya\" start_experience_factor = 0.4"
						owner = ROOT
					}
				}
			}
			else = {
				random_state = {
					limit = {
						BUL_is_macedonian_state = yes
						is_fully_controlled_by = ROOT
					}
					create_unit = {
						division = "division_template = \"Makedonska Revolyutsionna Militsiya\" start_experience_factor = 0.4"
						owner = ROOT
					}
					create_unit = {
						division = "division_template = \"Makedonska Revolyutsionna Militsiya\" start_experience_factor = 0.4"
						owner = ROOT
					}
					create_unit = {
						division = "division_template = \"Makedonska Revolyutsionna Militsiya\" start_experience_factor = 0.4"
						owner = ROOT
					}
					random_state = {
						limit = {
							BUL_is_macedonian_state = yes
							is_fully_controlled_by = ROOT
							NOT = { state = PREV }
						}
						create_unit = {
							division = "division_template = \"Makedonska Revolyutsionna Militsiya\" start_experience_factor = 0.4"
							owner = ROOT
						}
					}
				}
			}
			if = {
				limit = {
					NOT = {
						any_state = {
							BUL_is_macedonian_state = yes
							is_fully_controlled_by = ROOT
						}
					}
				}
				custom_effect_tooltip = BUL_support_imro_militias_tt
			}
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
		}
	}

	BUL_support_imro_garrisons = {

		priority = 7

		icon = GFX_decision_generic_prepare_civil_war

		ai_will_do = {
			base = 1
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_country_flag = BUL_macedonian_affairs_ongoing_flag }
			any_state = {
				BUL_is_macedonian_state = yes
				is_fully_controlled_by = ROOT
			}
		}

		days_remove = 7

		fire_only_once = yes

		visible = {
			has_country_flag = { flag = BUL_support_imro_flag value = 3 }
			has_civil_war = no
		}

		cost = 50

		complete_effect = {
			hidden_effect = {
				set_country_flag = { flag = BUL_support_imro_flag value = 4 }
				set_variable = { BUL_total_mp_from_macedonian_states = 0 }
				every_state = {
					limit = {
						BUL_is_macedonian_state = yes
						is_fully_controlled_by = ROOT
					}
					BUL = {
						add_to_variable = { BUL_total_mp_from_macedonian_states = BUL_imro_garrisons_mp_value  }
					}
				}
			}
		}

		remove_effect = {
			custom_effect_tooltip = BUL_support_imro_garrisons_tt
			if = {
				limit = {
					check_variable = { BUL_total_mp_from_macedonian_states = 0 }
				}
				hidden_effect = {
					add_manpower = BUL_total_mp_from_macedonian_states
				}
			}
			else = {
				add_manpower = BUL_total_mp_from_macedonian_states
			}
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
			clear_variable = BUL_total_mp_from_macedonian_states
		}
	}
}

BUL_macedonian_revolutionary_organizations_foreign = {
	BUL_repress_imro_foreign = {

		priority = 9

		icon = GFX_decision_generic_police_action

		ai_will_do = {
			base = 0.01
			modifier = {
				factor = 10
				difficulty > 1
			}
			modifier = {
				factor = 10
				difficulty > 2
			}
		}

		available = {
			NOT = { has_country_flag = BUL_macedonian_affairs_ongoing_flag }
			has_manpower > 2000
			has_equipment = { support_equipment > 249 }
			has_equipment = { infantry_equipment > 999 }
		}

		days_remove = 60

		fire_only_once = yes

		visible = {
			has_country_flag = BUL_imro_awakened_in_country_flag
		}

		cost = 25

		complete_effect = {
			set_country_flag = BUL_macedonian_affairs_ongoing_flag
			set_country_flag = BUL_repress_imro_flag
			add_manpower = -2000
			add_equipment_to_stockpile = {
				type = support_equipment
				amount = -250
				producer = ROOT
			}
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = -1000
				producer = ROOT
			}
		}

		remove_effect = {
			unlock_decision_tooltip = BUL_destroy_imro_foreign
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
		}
	}

	BUL_destroy_imro_foreign = {

		priority = 8

		icon = GFX_decision_oppression

		ai_will_do = {
			base = 0.1
			modifier = {
				factor = 10
				difficulty > 1
			}
			modifier = {
				factor = 10
				difficulty > 2
			}
		}

		available = {
			has_country_flag = BUL_repress_imro_flag
			NOT = { has_country_flag = BUL_macedonian_affairs_ongoing_flag }
			OR = {
				has_full_control_of_state = 106
				has_full_control_of_state = 731
				has_full_control_of_state = 184
			}
			OR = {
				NOT = { has_full_control_of_state = 106 }
				divisions_in_state = {
					type = infantry
					size > 8
					state = 106
				}
			}
			OR = {
				NOT = { has_full_control_of_state = 731 }
				divisions_in_state = {
					type = infantry
					size > 3
					state = 731
				}
			}
			OR = {
				NOT = { has_full_control_of_state = 184 }
				divisions_in_state = {
					type = infantry
					size > 2
					state = 184
				}
			}
		}

		days_remove = 90

		visible = {
			has_country_flag = BUL_imro_awakened_in_country_flag
		}

		cancel_trigger = {
			custom_trigger_tooltip = {
				tooltip = BUL_destroy_imro_foreign_cancel_trigger_tt

				OR = {
					AND = {
						has_country_flag = BUL_imro_awakened_in_macedonia_flag
						106 = {
							has_dynamic_modifier = { modifier = skirmishes_against_imro }
							OR = {
								NOT = { is_fully_controlled_by = ROOT }
								custom_trigger_tooltip = {
									tooltip = BUL_destroy_imro_divisions_macedonia_foreign_tt
									ROOT = {
										divisions_in_state = {
											type = infantry
											size < 9
											state = 106
										}
									}
								}
							}
						}
					}
					AND = {
						has_country_flag = BUL_imro_awakened_in_central_macedonia_flag
						731 = {
							has_dynamic_modifier = { modifier = skirmishes_against_imro }
							OR = {
								NOT = { is_fully_controlled_by = ROOT }
								custom_trigger_tooltip = {
									tooltip = BUL_destroy_imro_divisions_central_macedonia_foreign_tt
									ROOT = {
										divisions_in_state = {
											type = infantry
											size < 4
											state = 731
										}
									}
								}
							}
						}
					}
					AND = {
						has_country_flag = BUL_imro_awakened_in_thrace_flag
						184 = {
							has_dynamic_modifier = { modifier = skirmishes_against_imro }
							OR = {
								NOT = { is_fully_controlled_by = ROOT }
								custom_trigger_tooltip = {
									tooltip = BUL_destroy_imro_divisions_thrace_foreign_tt
									ROOT = {
										divisions_in_state = {
											type = infantry
											size < 3
											state = 184
										}
									}
								}
							}
						}
					}
				}
			}
		}

		cancel_effect = {
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
			every_controlled_state = {
				limit = {
					has_dynamic_modifier = { modifier = skirmishes_against_imro }
				}
				remove_dynamic_modifier = { modifier = skirmishes_against_imro }
			}
		}

		cost = 25

		complete_effect = {
			set_country_flag = BUL_macedonian_affairs_ongoing_flag

			every_controlled_state = {
				limit = {
					BUL_is_macedonian_state = yes
					is_fully_controlled_by = ROOT
				}
				effect_tooltip = {
					add_dynamic_modifier = { modifier = skirmishes_against_imro }
				}
				hidden_effect = {
					add_dynamic_modifier = { modifier = skirmishes_against_imro days = 91 } #This is a fallback with one extra day so that it has time to remove widespread_bulgarian_sentiment
				}
			}
		}

		remove_effect = {
			clr_country_flag = BUL_macedonian_affairs_ongoing_flag
			clr_country_flag = BUL_repress_imro_flag
			clr_country_flag = BUL_imro_awakened_in_country_flag
			add_stability = 0.1
			if = {
				limit = {
					NOT = {
						any_state = {
							has_dynamic_modifier = { modifier = skirmishes_against_imro }
						}
					}
				}
				custom_effect_tooltip = BUL_destroy_imro_foreign_tt
			}
			every_controlled_state = {
				limit = {
					has_dynamic_modifier = { modifier = skirmishes_against_imro }
				}
				remove_dynamic_modifier = { modifier = skirmishes_against_imro }
				if = {
					limit = {
						has_dynamic_modifier = { modifier = widespread_bulgarian_sentiment_01 }
					}
					remove_dynamic_modifier = { modifier = widespread_bulgarian_sentiment_01 }
				}
				remove_core_of = BUL
				add_core_of = ROOT
			}
		}
	}
}


 #######  ######## ##     ## ######## ########
##     ##    ##    ##     ## ##       ##     ##
##     ##    ##    ##     ## ##       ##     ##
##     ##    ##    ######### ######   ########
##     ##    ##    ##     ## ##       ##   ##
##     ##    ##    ##     ## ##       ##    ##
 #######     ##    ##     ## ######## ##     ##


prospect_for_resources = {
	BUL_mineral_extraction_in_the_rhodopes = { #212

		icon = chromium

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			has_dlc = "Battle for the Bosporus"
		}

		highlight_states = {
			highlight_state_targets = {
				state = 212
			}
		}

		available = {
			has_tech = excavation3
			num_of_civilian_factories_available_for_projects > 1
		}

		visible = {
			owns_state = 212
			controls_state = 212
			has_tech = excavation2
			212 = {
				NOT = {
					has_state_flag = {
						flag = BUL_chromium_deposits_flag
						value = 3
					}
				}
			}
		}

		cost = 25
		days_remove = BUL_plovdiv_chromium_duration

		modifier = {
			civilian_factory_use = 1
		}

		remove_effect = {
			add_to_variable = { var = BUL_plovdiv_chromium_duration value = 30 }
			212 = {
				if = {
					limit = {
						NOT = {
							has_state_flag = BUL_chromium_deposits_flag
						}
					}
					set_state_flag = {
						flag = BUL_chromium_deposits_flag
						value = 1
					}
				}
				else = {
					modify_state_flag = {
						flag = BUL_chromium_deposits_flag
						value = 1
					}
				}
			}
			212 = {
				add_resource = {
					type = chromium
					amount = 3
				}
			}
		}

		complete_effect = {
		}
	}
}

war_measures = {
	secure_romanian_border = {
		allowed = {
			original_tag = BUL
		}

		visible = {
			has_completed_focus = BUL_fund_new_border_forts
		}

		available = {
			num_of_civilian_factories_available_for_projects > 5
		}

		modifier = {
			civilian_factory_use = 6
		}

		days_remove = 60

		fire_only_once = yes

		remove_effect = {
			875 = {
				add_building_construction = {
					type = bunker
					level = 3
					instant_build = yes
					province = {
						all_provinces = yes
						limit_to_border_country  = ROM
					}
				}
			}
			211 = {
				add_building_construction = {
					type = bunker
					level = 3
					instant_build = yes
					province = {
						all_provinces = yes
						limit_to_border_country  = ROM
					}
				}
			}
		}
	}

	secure_greek_border = {
		allowed = {
			original_tag = BUL
		}

		visible = {
			has_completed_focus = BUL_fund_new_border_forts
		}

		available = {
			num_of_civilian_factories_available_for_projects > 5
		}

		modifier = {
			civilian_factory_use = 6
		}

		days_remove = 60

		fire_only_once = yes

		remove_effect = {
			905 = {
				add_building_construction = {
					type = bunker
					level = 3
					instant_build = yes
					province = {
						all_provinces = yes
						limit_to_border = yes
					}
				}
			}
			212 = {
				add_building_construction = {
					type = bunker
					level = 3
					instant_build = yes
					province = {
						all_provinces = yes
						limit_to_border = yes
					}
				}
			}
			211 = {
				add_building_construction = {
					type = bunker
					level = 3
					instant_build = yes
					province = {
						all_provinces = yes
						limit_to_border_country  = TUR
					}
				}
			}
		}
	}
}


########     ###    ##       ##    ##    ###    ##    ##    ######## ######## ########  ######## ########     ###    ######## ####  #######  ##    ##
##     ##   ## ##   ##       ##   ##    ## ##   ###   ##    ##       ##       ##     ## ##       ##     ##   ## ##      ##     ##  ##     ## ###   ##
##     ##  ##   ##  ##       ##  ##    ##   ##  ####  ##    ##       ##       ##     ## ##       ##     ##  ##   ##     ##     ##  ##     ## ####  ##
########  ##     ## ##       #####    ##     ## ## ## ##    ######   ######   ##     ## ######   ########  ##     ##    ##     ##  ##     ## ## ## ##
##     ## ######### ##       ##  ##   ######### ##  ####    ##       ##       ##     ## ##       ##   ##   #########    ##     ##  ##     ## ##  ####
##     ## ##     ## ##       ##   ##  ##     ## ##   ###    ##       ##       ##     ## ##       ##    ##  ##     ##    ##     ##  ##     ## ##   ###
########  ##     ## ######## ##    ## ##     ## ##    ##    ##       ######## ########  ######## ##     ## ##     ##    ##    ####  #######  ##    ##


BUL_the_balkan_federation_dream = {
	BUL_develop_balkan_federation_project  = { #Bulgaria is developing a project for a Federation of Balkan Republics.

		priority = 100

		icon = GFX_decision_eng_trade_unions_support

		ai_will_do = {
			base = 100
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_war_with = YUG }
		}

		days_remove = 120

		visible = {
			has_completed_focus = BUL_treaty_of_perpetual_friendship
			has_government = communism
			NOT = { has_war_with = YUG }
		}

		cancel_if_not_visible = yes

		cost = 15

		fire_only_once = yes

		complete_effect = {
		}

		modifier = {
			political_power_gain = -0.5
		}

		remove_effect = {
			add_political_power = 70
			set_country_flag = BUL_balkan_federation_project_ready_flag
			add_popularity = {
				ideology = communism
				popularity = 0.1
			}
			country_event = bftb_bulgaria_balkan_federation.1
			YUG = {
				effect_tooltip = {
					add_popularity = {
						ideology = communism
						popularity = 0.1
					}
				}
				country_event = bftb_bulgaria_balkan_federation.2
			}
		}
	}

	BUL_balkan_federation_propaganda = {

		icon = GFX_decision_eng_propaganda_campaigns


		target_trigger = {
			FROM = {
				BUL_is_balkan_nation = yes
				OR = {
					NOT = { is_in_faction_with = ROOT }
					NOT = { has_government = communism }
				}
				NOT = { tag = ROOT }
				has_capitulated = no
			}
		}

		ai_will_do = {
			base = 0.01
			modifier = {
				factor = 10
				FROM = {
					communism > 0.2
					NOT = { is_in_faction_with = ROOT }
				}
			}
			modifier = {
				factor = 10
				FROM = {
					tag = YUG
				}
			}
			modifier = {
				factor = 10
				FROM = {
					tag = YUG
					NOT = { is_in_faction_with = ROOT }
				}
			}
			modifier = {
				factor = 2
				FROM = {
					OR = {
						tag = GRE
						tag = TUR
					}
				}
			}
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_war_with = FROM }
			FROM = { NOT = { has_country_flag = banned_communism_flag } }
		}

		visible = {
			FROM = {
				country_exists = FROM
				NOT = { has_idea = BUL_balkan_federation_project_propaganda }
				OR = {
					NOT = { is_in_faction_with = ROOT }
					NOT = { has_government = communism }
				}
				has_capitulated = no
			}
			OR = {
				AND = {
					FROM = { original_tag = YUG }
					has_completed_focus = BUL_treaty_of_perpetual_friendship
				}
				AND = {
					FROM = {
						BUL_is_balkan_nation = yes
						NOT = { original_tag = YUG }
						NOT = { original_tag = ROOT }
					}
					has_completed_focus = BUL_balkan_federation_of_socialist_republics
				}
			}
		}

		days_re_enable = 180

		cost = 50

		complete_effect = {
			FROM = {
				effect_tooltip = {
					add_timed_idea = {
						idea = BUL_balkan_federation_project_propaganda
						days = 180
					}
				}
				hidden_effect = {
					country_event = bftb_bulgaria_balkan_federation.3
				}
			}
		}
	}

	BUL_destabilize_country = {

		icon = GFX_decision_revolt


		target_trigger = {
			FROM = {
				BUL_is_balkan_nation = yes
				NOT = { is_in_faction_with = ROOT }
				NOT = { tag = ROOT }
				has_capitulated = no
				NOT = { has_government = communism }
			}
		}

		ai_will_do = {
			base = 0
			modifier = {
				add = 0.01
				has_manpower > 5000
				has_equipment = { infantry_equipment > 3000 }
			}
			modifier = {
				add = 1
				FROM = {
					communism > 0.4
				}
			}
			modifier = {
				factor = 10
				FROM = {
					tag = YUG
				}
			}
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_war_with = FROM }
			has_manpower > 250
			has_equipment = { infantry_equipment > 999 }
			FROM = {
				NOT = { has_country_flag = banned_communism_flag }
				NOT = { has_government = communism }
			}
		}

		visible = {
			country_exists = FROM
			OR = {
				AND = {
					FROM = {
						original_tag = YUG
						NOT = { is_in_faction_with = ROOT }
						has_capitulated = no
						NOT = { has_government = communism }
					}
					has_completed_focus = BUL_treaty_of_perpetual_friendship
				}
				AND = {
					FROM = {
						BUL_is_balkan_nation = yes
						NOT = { original_tag = YUG }
						NOT = { original_tag = ROOT }
						has_capitulated = no
						NOT = { is_in_faction_with = ROOT }
						NOT = { has_government = communism }
					}
					has_completed_focus = BUL_balkan_federation_of_socialist_republics
				}
			}
		}

		cost = 50

		days_re_enable = 180

		days_remove = 30

		complete_effect = {
			add_manpower = -250
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = -1000
				producer = BUL
			}
		}

		remove_effect = {
			FROM = {
				effect_tooltip = {
					add_stability = -0.05
					add_popularity = {
						ideology = communism
						popularity = 0.1
					}
				}
				hidden_effect = {
					country_event = bftb_bulgaria_balkan_federation.4
				}
			}
		}
	}

	BUL_fight_alongside_country_comrades = {

		icon = GFX_decision_generic_prepare_civil_war

		target_trigger = {
			FROM = {
				BUL_is_balkan_nation = yes
				NOT = { tag = ROOT }
				has_civil_war = yes
				has_government = communism
				NOT = { has_war_with = ROOT }
			}
		}

		ai_will_do = {
			base = 0
			modifier = {
				add = 0.01
				has_war = no
				has_stability > 0.4
				FROM = { is_neighbor_of = ROOT }
				NOT = { has_idea = BUL_army_restrictions }
				NOT = {
					FROM = { has_war_with = GER }
					FROM = { has_war_with = ITA }
					FROM = { has_war_with = SOV }
					FROM = { has_war_with = ENG }
				}
			}
			modifier = {
				factor = 10
				has_manpower > 10000
				has_equipment = { infantry_equipment > 3000 }
			}
			modifier = {
				factor = 10
				FROM = {
					tag = YUG
				}
			}
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			has_war_support > 0.15
			has_stability > 0.25
		}

		visible = {
			country_exists = FROM
			has_government = communism
			OR = {
				AND = {
					FROM = { original_tag = YUG }
					has_completed_focus = BUL_treaty_of_perpetual_friendship
				}
				AND = {
					FROM = {
						BUL_is_balkan_nation = yes
						NOT = { original_tag = YUG }
						NOT = { original_tag = ROOT }
					}
					has_completed_focus = BUL_balkan_federation_of_socialist_republics
				}
			}
		}

		fire_only_once = yes

		complete_effect = {
			hidden_effect = {
				random_country = {
					limit = {
						original_tag = FROM
						has_civil_war = yes
						NOT = { has_government = communism }
					}
					ROOT = { add_to_war = { targeted_alliance = FROM enemy = PREV hostility_reason = asked_to_join } }
				}
			}
			custom_effect_tooltip = BUL_fight_alongside_country_comrades_join_cw_tt

			effect_tooltip = {
				give_military_access = FROM
				FROM = { give_military_access = ROOT }
			}
			hidden_effect = {
				diplomatic_relation = {
					country = FROM
					relation = military_access
					active = yes
				}
				FROM = {
					diplomatic_relation = {
						country = ROOT
						relation = military_access
						active = yes
					}
				}
			}
		}
	}

	BUL_balkan_federation_industrial_aid = {

		icon = GFX_decision_generic_factory

		ai_will_do = {
			base = 10
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_war_with = FROM }
			num_of_civilian_factories_available_for_projects > 5
		}

		visible = {
			country_exists = FROM
			NOT = { has_war_with = FROM }
			has_government = communism
			FROM = {
				NOT = {
					tag = ROOT
					has_government = fascism
				}
			}
		}

		cancel_if_not_visible = yes

		cost = 15

		days_remove = 180

		modifier = {
			civilian_factory_use = 6
		}

		complete_effect = {
		}

		remove_effect = {
			FROM = {
				random_owned_controlled_state = {
					limit = {
						free_building_slots = {
							building = industrial_complex
							size > 1
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 2
					add_building_construction = {
						type = industrial_complex
						level = 2
						instant_build = yes
					}
					set_state_flag = BUL_industrial_aid_flag
				}
				random_owned_controlled_state = {
					limit = {
						NOT = { has_state_flag = BUL_industrial_aid_flag }
						free_building_slots = {
							building = industrial_complex
							size > 0
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}
				random_owned_controlled_state = {
					limit = {
						has_state_flag = BUL_industrial_aid_flag
					}
					clr_state_flag = BUL_industrial_aid_flag
				}
				every_unit_leader = {
					set_nationality = BUL
				}
			}
			annex_country = { target = FROM transfer_troops = yes }
		}
	}

	BUL_balkan_federation_economic_aid = {

		icon = GFX_decision_hol_attract_foreign_investors

		ai_will_do = {
			base = 10
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_war_with = FROM }
		}

		visible = {
			country_exists = FROM
			NOT = { has_war_with = FROM }
			NOT = { tag = ROOT }
			has_government = communism
			FROM = {
				NOT = {
					tag = ROOT
					has_government = fascism
				}
			}
		}

		cancel_if_not_visible = yes

		cost = 15

		days_remove = 90

		modifier = {
			consumer_goods_expected_value = 0.05
		}

		complete_effect = {
		}

		remove_effect = {
			FROM = {
				every_owned_state = {
					limit = {
						is_in_home_area = yes
						infrastructure < 10
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				every_unit_leader = {
					set_nationality = BUL
				}
			}
			annex_country = { target = FROM transfer_troops = yes }
		}
	}

	BUL_balkan_federation_military_aid = {

		icon = GFX_decision_generic_military

		ai_will_do = {
			base = 10
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_war_with = FROM }
			has_army_experience > 49
		}

		visible = {
			country_exists = FROM
			NOT = { has_war_with = FROM }
			NOT = { tag = ROOT }
			has_government = communism
			FROM = {
				NOT = {
					tag = ROOT
					has_government = fascism
				}
			}
		}

		cancel_if_not_visible = yes

		cost = 15

		days_remove = 90

		modifier = {
			weekly_manpower = -300
		}

		complete_effect = {
			army_experience = -50
		}

		remove_effect = {
			add_war_support = 0.1
			FROM = {
				add_manpower = 3600 #90 days of -300 weekly MP
				every_unit_leader = {
					set_nationality = BUL
				}
			}
			annex_country = { target = FROM transfer_troops = yes }
		}
	}

	BUL_balkan_federation_demand_turkish_territory = {

		icon = GFX_decision_generic_military

		ai_will_do = {
			base = 0
			modifier = {
				add = 0.01
				strength_ratio = {
					tag = TUR
					ratio > 1.5
				}
			}
			modifier = {
				factor = 5
				strength_ratio = {
					tag = TUR
					ratio > 2
				}
			}
			modifier = {
				factor = 10
				strength_ratio = {
					tag = TUR
					ratio > 3
				}
			}
			modifier = {
				factor = 100
				TUR = { is_in_faction = no }
			}
		}

		allowed = {
			original_tag = BUL
		}

		available = {
			NOT = { has_war_with = FROM }
			strength_ratio = {
				tag = TUR
				ratio > 1
			}
		}

		visible = {
			country_exists = TUR
			TUR = {
				OR = {
					controls_state = 341
					controls_state = 797
				}
			}
			NOT = { is_in_faction_with = TUR }
			has_government = communism
			has_completed_focus = BUL_the_unification_of_the_balkans
		}

		cancel_if_not_visible = yes

		cost = 75

		fire_only_once = yes

		complete_effect = {
			TUR = {
				country_event = bftb_bulgaria_balkan_federation.16
			}
		}
	}
}