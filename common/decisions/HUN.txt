HUN_regency_powers = {

	HUN_enact_statute_XIX = {
		icon = eng_trade_unions_demand

		fire_only_once = yes

		cost = 75

		visible = {
			has_country_leader = {
				name = "Miklós Horthy"
			}
		}

		available = {
		}
		ai_will_do = {
			factor = 1
		}

		complete_effect = {
			add_country_leader_trait = consolidator
		}
	}

	HUN_enact_statute_XXIII = {
		icon = eng_trade_unions_demand

		fire_only_once = yes

		cost = 75

		visible = {
			has_country_leader = {
				name = "Miklós Horthy"
			}
		}

		available = {
		}

		days_remove = 1825

		modifier = {
			MONTHLY_POPULATION = 0.2
		}
		ai_will_do = {
			factor = 1
		}

		complete_effect = {
			add_stability = 0.05
			add_popularity = { ideology = neutrality popularity = 0.1 }
		}
	}

	HUN_counter_fanatics = {
		icon = eng_trade_unions_support

		fire_only_once = no

		cost = 50

		visible = {
			has_country_leader = {
				name = "Miklós Horthy"
			}
		}

		available = {
		}

		days_remove = 360
		days_re_enable = 360

		modifier = {
			communism_drift = -0.02
			fascism_drift = -0.02
			democratic_drift = -0.02
		}
		ai_will_do = {
			factor = 1
		}
	}

	HUN_public_speeches = {

		icon = generic_speech

		fire_only_once = no

		cost = 75

		days_remove = 90

		days_re_enable = 90

		visible = {
			has_country_leader = {
				name = "Miklós Horthy"
			}
		}

		available = {
			has_war = yes
		}

		modifier = {
			industrial_capacity_factory = 0.1
			industrial_capacity_dockyard = 0.1
		}
	}

	HUN_war_speeches = {

		icon = generic_speech

		fire_only_once = no

		cost = 75

		days_remove = 90

		days_re_enable = 90

		visible = {
			has_country_leader = {
				name = "Miklós Horthy"
			}
		}

		available = {
			has_war = yes
		}

		modifier = {
			mobilization_speed = 0.2
			training_time_factor = -0.1
		}
	}

	HUN_hungarian_irredentism = {

		icon = generic_speech

		fire_only_once = no

		cost = 100

		days_remove = 90

		days_re_enable = 90

		visible = {
			has_country_leader = {
				name = "Miklós Horthy"
			}
			NOT = { has_completed_focus = HUN_greater_hungary }
		}

		available = {
			NOT = { has_completed_focus = HUN_greater_hungary }
			OR = {
				AND = {
					has_war_with = CZE
					CZE = { has_capitulated = no }
				}
				AND = {
					has_war_with = YUG
					YUG = { has_capitulated = no }
				}
				AND = {
					has_war_with = ROM
					ROM = { has_capitulated = no }
				}
				is_faction_leader = yes
			}
		}

		modifier = {
			army_attack_factor = 0.05
			army_defence_factor = 0.05
			army_speed_factor = 0.1
			org_loss_when_moving = -0.1
		}
	}

	HUN_horthys_succession = {
		icon = eng_trade_unions_demand

		fire_only_once = yes

		cost = 100

		visible = {
			has_country_leader = {
				name = "Miklós Horthy"
			}
		}

		available = {
			has_completed_focus = HUN_the_national_saviour
		}

		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0
				date < 1945.5.1
			}
		}

		complete_effect = {
			country_event = hun_armor.806
			custom_effect_tooltip = HUN_horthys_succession_tt
		}
	}
}

HUN_change_sides = {

	HUN_change_sides_to_allies = {
		icon = decision_generic_nationalism

        allowed = { tag = HUN }

		available = {
			is_faction_leader = no
			is_subject = no
			has_capitulated = no
			any_country = {
				is_faction_leader = yes
				has_war_with = HUN
				OR = {
					has_government = democratic
					original_tag = ENG
					original_tag = USA
				}
			}
			has_completed_focus = HUN_the_national_saviour
			surrender_progress > 0.01
			OR = {
				has_government = neutrality
				has_government = democratic
			}
			NOT = {
				FACTION_LEADER  = {
					has_government = democratic
				}
			}
			hidden_trigger = {
				NOT = { has_country_flag = HUN_changing_sides_mission }
				NOT = { has_country_flag = hungary_has_flipped_sides }
			}
		}

		visible = {
			is_faction_leader = no
			original_tag = HUN
			NOT = { has_country_flag = hungary_has_flipped_sides }
			has_completed_focus = HUN_the_national_saviour
		}

		cost = 0

		fire_only_once = yes

		cancel_trigger = {
			is_subject = yes
		}

		days_remove = 21
		is_good = yes

		ai_will_do = {
			factor = 0
		}

		complete_effect = {
			hidden_effect = {
				random_country = {
					limit = {
						is_in_faction_with = ROOT
						is_faction_leader = yes
					}
					set_country_flag = hungary_is_flipping_sides
					save_global_event_target_as = hungary_former_ally_target
				}
				set_country_flag = HUN_changing_sides_mission
			}
		}

		remove_effect = {
			#save current faction leader for use in the event
			hidden_effect = {
				random_country = {
					limit = {
						is_in_faction_with = ROOT
						is_faction_leader = yes
					}
					save_global_event_target_as = hungary_former_ally_target
				}
			}
			#top priority is joining the Allies if they still exist
			if = {
				limit = {
					any_country = {
						is_faction_leader = yes
						has_war_with = HUN
						has_government = democratic
						OR = {
							original_tag = ENG
							is_in_faction_with = ENG
						}
					}
				}
				random_enemy_country = {
					limit = {
						is_faction_leader = yes
						has_war_with = HUN
						has_government = democratic
						OR = {
							original_tag = ENG
							is_in_faction_with = ENG
						}
					}
					save_event_target_as = hungary_new_ally_target
				}
			}
			#then attempts to join the USA's faction
			else_if = {
				limit = {
					any_country = {
						is_faction_leader = yes
						has_war_with = ROM
						has_government = democratic
						OR = {
							original_tag = USA
							is_in_faction_with = USA
						}
					}
				}
				random_enemy_country = {
					limit = {
						is_faction_leader = yes
						has_war_with = ROM
						has_government = democratic
						OR = {
							original_tag = USA
							is_in_faction_with = USA
						}
					}
					save_event_target_as = hungary_new_ally_target
				}
			}
			#then attempts to join any democratic faction
			else = {
				random_enemy_country = {
					limit = {
						is_faction_leader = yes
						has_war_with = ROM
						has_government = democratic
					}
					save_event_target_as = hungary_new_ally_target
				}
			}
			event_target:hungary_new_ally_target = {
				country_event = { id = DOD_romania.16 }
			}
			hidden_effect = {
				set_country_flag = hungary_has_flipped_sides
			}
		}
	}

	# Commintern

	HUN_change_sides_to_commintern = {
		icon = decision_generic_nationalism

        allowed = { tag = HUN }

		available = {
			is_faction_leader = no
			is_subject = no
			has_capitulated = no
			any_country = {
				is_faction_leader = yes
				has_war_with = HUN
				OR = {
					has_government = communism
					original_tag = SOV
				}
			}
			has_completed_focus = HUN_the_national_saviour
			surrender_progress > 0.01
			OR = {
				has_government = neutrality
				has_government = communism
			}
			NOT = {
				FACTION_LEADER  = {
					has_government = communism
				}
			}
			hidden_trigger = {
				NOT = { has_country_flag = HUN_changing_sides_mission }
				NOT = { has_country_flag = hungary_has_flipped_sides }
			}
		}

		visible = {
			is_faction_leader = no
			original_tag = HUN
			NOT = { has_country_flag = hungary_has_flipped_sides }
			has_completed_focus = HUN_the_national_saviour
		}

		cost = 0

		fire_only_once = yes

		cancel_trigger = {
			is_subject = yes
		}

		days_remove = 21
		is_good = yes

		ai_will_do = {
			factor = 4000
			modifier = {
				is_historical_focus_on = yes
				date < 1943.8.1
				factor = 0
			}
		}

		complete_effect = {
			hidden_effect = {
				random_country = {
					limit = {
						is_in_faction_with = ROOT
						is_faction_leader = yes
					}
					set_country_flag = hungary_is_flipping_sides
				}
				set_country_flag = HUN_changing_sides_mission
			}
		}

		remove_effect = {
			#save current faction leader for use in the event
			hidden_effect = {
				random_country = {
					limit = {
						is_in_faction_with = ROOT
						is_faction_leader = yes
					}
					save_global_event_target_as = hungary_former_ally_target
					country_event = { id = ger_armor.710 }
				}
			}
			#top priority is joining the Commintern if they still exist
			if = {
				limit = {
					any_country = {
						is_faction_leader = yes
						has_war_with = HUN
						has_government = communism
						OR = {
							original_tag = SOV
							is_in_faction_with = SOV
						}
					}
				}
				random_enemy_country = {
					limit = {
						is_faction_leader = yes
						has_war_with = HUN
						has_government = communism
						OR = {
							original_tag = SOV
							is_in_faction_with = SOV
						}
					}
					save_event_target_as = hungary_new_ally_target
				}
			}
			#then attempts to join any communist faction
			else = {
				random_enemy_country = {
					limit = {
						is_faction_leader = yes
						has_war_with = HUN
						has_government = communism
					}
					save_event_target_as = hungary_new_ally_target
				}
			}
			event_target:hungary_new_ally_target = {
				country_event = { id = sov_armor.856 }
			}
			hidden_effect = {
				set_country_flag = hungary_has_flipped_sides
			}
		}
	}

	# Axis

	HUN_change_sides_to_axis = {
		icon = decision_generic_nationalism

        allowed = { tag = HUN }

		available = {
			is_faction_leader = no
			is_subject = no
			has_capitulated = no
			any_country = {
				is_faction_leader = yes
				has_war_with = HUN
				OR = {
					has_government = fascism
					original_tag = GER
					original_tag = ITA
				}
			}
			has_completed_focus = HUN_the_national_saviour
			surrender_progress > 0.01
			OR = {
				has_government = neutrality
				has_government = fascism
			}
			NOT = {
				FACTION_LEADER  = {
					has_government = fascism
				}
			}
			hidden_trigger = {
				NOT = { has_country_flag = HUN_changing_sides_mission }
				NOT = { has_country_flag = hungary_has_flipped_sides }
			}
		}

		visible = {
			is_faction_leader = no
			original_tag = HUN
			NOT = { has_country_flag = hungary_has_flipped_sides }
			has_completed_focus = HUN_the_national_saviour
		}

		cost = 0

		fire_only_once = yes

		cancel_trigger = {
			is_subject = yes
		}

		days_remove = 21
		is_good = yes

		ai_will_do = {
			factor = 0
		}

		complete_effect = {
			hidden_effect = {
				random_country = {
					limit = {
						is_in_faction_with = ROOT
						is_faction_leader = yes
					}
					set_country_flag = hungary_is_flipping_sides
				}
				set_country_flag = HUN_changing_sides_mission
			}
		}

		remove_effect = {
			#save current faction leader for use in the event
			hidden_effect = {
				random_country = {
					limit = {
						is_in_faction_with = ROOT
						is_faction_leader = yes
					}
					save_global_event_target_as = hungary_former_ally_target
				}
			}
			#top priority is joining the Axis if they still exist
			if = {
				limit = {
					any_country = {
						is_faction_leader = yes
						has_war_with = HUN
						has_government = fascism
						OR = {
							original_tag = GER
							is_in_faction_with = GER
						}
					}
				}
				random_enemy_country = {
					limit = {
						is_faction_leader = yes
						has_war_with = HUN
						has_government = fascism
						OR = {
							original_tag = GER
							is_in_faction_with = GER
						}
					}
					save_event_target_as = hungary_new_ally_target
				}
			}
			#then attempts to join Italy's faction
			else_if = {
				limit = {
					any_country = {
						is_faction_leader = yes
						has_war_with = ROM
						has_government = fascism
						OR = {
							original_tag = ITA
							is_in_faction_with = ITA
						}
					}
				}
				random_enemy_country = {
					limit = {
						is_faction_leader = yes
						has_war_with = ROM
						has_government = fascism
						OR = {
							original_tag = ITA
							is_in_faction_with = ITA
						}
					}
					save_event_target_as = hungary_new_ally_target
				}
			}
			#then attempts to join any fascist faction
			else = {
				random_enemy_country = {
					limit = {
						is_faction_leader = yes
						has_war_with = HUN
						has_government = fascism
					}
					save_event_target_as = hungary_new_ally_target
				}
			}
			event_target:hungary_new_ally_target = {
				country_event = { id = DOD_romania.16 }
			}
			hidden_effect = {
				set_country_flag = hungary_has_flipped_sides
			}
		}
	}
}

war_measures = {

	HUN_war_for_transylvania = {
		icon = generic_prepare_civil_war

		allowed = {
			tag = HUN
		}

		available = {
			OR = {
				AND = {
					controls_state = 76
					controls_state = 84
					controls_state = 82
					controls_state = 83
					surrender_progress < 0.1
				}
				surrender_progress > 0.2
			}
		}

		visible = {
		}

		days_mission_timeout = 120
		is_good = yes

		activation = {
			always = no
		}

		complete_effect = {
			if = {
				limit = {
					surrender_progress > 0.2
				}
				country_event = hun_armor.856
			}
			else = {
				ROM = { country_event = { id = hun_armor.857 } }
			}
		}

		timeout_effect = {
			HUN = { country_event = { id = hun_armor.858 } }
		}
	}

	ROM_war_for_transylvania = {
		icon = generic_prepare_civil_war

		allowed = {
			tag = ROM
		}

		available = {
			OR = {
				NOT = {
					controls_state = 76
					controls_state = 84
					controls_state = 82
					controls_state = 83
					HUN = { surrender_progress < 0.1 }
				}
				HUN = { surrender_progress > 0.2 }
			}
		}

		visible = {
		}

		days_mission_timeout = 120
		is_good = no

		activation = {
			always = no
		}

		complete_effect = {
			if = {
				limit = {
					HUN = { surrender_progress > 0.2 }
				}
				effect_tooltip = {
					HUN = {country_event = hun_armor.856 }
				}
			}
			else = {
				effect_tooltip = {
					country_event = { id = hun_armor.857 }
				}
			}
		}

		timeout_effect = {
			effect_tooltip = {
				country_event = { id = hun_armor.858 }
			}
		}
	}

	HUN_retake_slovak_territory = {
		icon = generic_operation
		available = {
			OR = {
				has_war_with = CZE
				has_war_with = SLO
			}
		}
		visible = {
			has_completed_focus = HUN_incorporate_the_turan_hunters
		}
		ai_will_do = {
			factor = 1
		}
		fire_only_once = yes
		days_remove = 180
		targeted_modifier = {
			tag = CZE
			attack_bonus_against = 0.1
			defense_bonus_against = 0.1
		}
		targeted_modifier = {
			tag = SLO
			attack_bonus_against = 0.1
			defense_bonus_against = 0.1
		}
	}

	HUN_retake_yugoslav_territory = {
		icon = generic_operation
		available = {
			has_war_with = YUG
		}
		visible = {
			has_completed_focus = HUN_incorporate_the_turan_hunters
		}
		ai_will_do = {
			factor = 1
		}
		fire_only_once = yes
		days_remove = 180
		targeted_modifier = {
			tag = YUG
			attack_bonus_against = 0.1
			defense_bonus_against = 0.1
		}
	}

	HUN_retake_romanian_territory = {
		icon = generic_operation
		available = {
			has_war_with = ROM
		}
		visible = {
			has_completed_focus = HUN_incorporate_the_turan_hunters
		}
		ai_will_do = {
			factor = 1
		}
		fire_only_once = yes
		days_remove = 180
		targeted_modifier = {
			tag = ROM
			attack_bonus_against = 0.1
			defense_bonus_against = 0.1
		}
	}
}

special_projects = {
	HUN_margit_line = {
		icon = generic_bunker
		available = {
			has_full_control_of_state = 155
			has_full_control_of_state = 43
			has_full_control_of_state = 889
		}
		fire_only_once = yes
		cost = 0
		visible = {
			has_completed_focus = HUN_arpad_line
		}
		ai_will_do = {
			factor = 10
		}
		days_remove = 30
		modifier = {
			civilian_factory_use = 5
		}
		remove_effect = {
			custom_effect_tooltip = HUN_margit_line_tt
			hidden_effect = {
				155 = {
					add_building_construction = {
						type = bunker
						level = 3
						province = 3670
						instant_build = yes
					}
					add_building_construction = {
						type = bunker
						level = 3
						province = 6703
						instant_build = yes
					}
					add_building_construction = {
						type = bunker
						level = 3
						province = 701
						instant_build = yes
					}
					add_building_construction = {
						type = bunker
						level = 3
						province = 9676
						instant_build = yes
					}
				}
				43 = {
					add_building_construction = {
						type = bunker
						level = 3
						province = 13312
						instant_build = yes
					}
					add_building_construction = {
						type = bunker
						level = 3
						province = 684
						instant_build = yes
					}
					add_building_construction = {
						type = bunker
						level = 3
						province = 6716
						instant_build = yes
					}
					add_building_construction = {
						type = bunker
						level = 3
						province = 3713
						instant_build = yes
					}
					add_building_construction = {
						type = bunker
						level = 3
						province = 11520
						instant_build = yes
					}
				}
			}
		}
	}

	HUN_szent_laezlo_allas_line = {
		icon = generic_bunker
		available = {
			has_full_control_of_state = 73
		}
		fire_only_once = yes
		cost = 0
		visible = {
			has_completed_focus = HUN_arpad_line
		}
		ai_will_do = {
			factor = 10
		}
		days_remove = 60
		modifier = {
			civilian_factory_use = 5
		}
		remove_effect = {
			custom_effect_tooltip = HUN_szent_laezlo_allas_line_tt
			hidden_effect = {
				73 = {
					add_building_construction = {
						type = bunker
						level = 3
						province = 11536
						instant_build = yes
					}
					add_building_construction = {
						type = bunker
						level = 3
						province = 9563
						instant_build = yes
					}
					add_building_construction = {
						type = bunker
						level = 3
						province = 6571
						instant_build = yes
					}
				}
			}
		}
	}
}

political_actions = {
	HUN_abandon_the_huba_plan = {
		icon = generic_break_treaty

		allowed = { tag = HUN }

		visible = {
			NOT = {
				has_completed_focus = HUN_complete_huba_i
			}
		}

		available = {
			NOT = {
				has_completed_focus = HUN_complete_huba_i
			}
			NOT = {
				has_idea = disarmed_nation
			}
		}

		ai_will_do = {
			factor = 10
		}

		cost = 25

		fire_only_once = yes

		complete_effect = {
			custom_effect_tooltip = HUN_abandon_the_huba_plan_tt
			hidden_effect = {
				set_country_flag = HUM_huba_bypass_flag
			}
		}
	}

	HUN_attract_german_investors = {
		icon = gre_investment_decisions

		allowed = { tag = HUN }
		visible = {
			country_exists = GER
			NOT = {
				has_war_with = GER
				GER = { is_subject = yes }
			}
		}

		available = {
			OR = {
				has_government = fascism
				has_completed_focus = HUN_cave_to_german_demands
			}
			has_war = no
		}
		ai_will_do = {
			factor = 10
		}

		cost = 100

		fire_only_once = yes

		days_remove = 720

		modifier = {
			consumer_goods_expected_value = -0.05
		}

		cancel_trigger = {
			has_war = yes
		}

		complete_effect = {

		}
	}

	HUN_attract_italian_investors = {
		icon = gre_investment_decisions

		allowed = { tag = HUN }
		visible = {
			country_exists = ITA
			NOT = {
				has_war_with = ITA
				ITA = { is_subject = yes }
			}
		}

		available = {
			OR = {
				has_government = fascism
				has_completed_focus = HUN_cave_to_italian_demands
			}
			has_war = no
		}
		ai_will_do = {
			factor = 10
		}

		cost = 100

		fire_only_once = yes

		days_remove = 720

		modifier = {
			consumer_goods_expected_value = -0.05
		}

		cancel_trigger = {
			has_war = yes
		}

		complete_effect = {

		}
	}

	HUN_buy_german_trucks = {
		icon = gre_investment_decisions

		allowed = { tag = HUN }
		visible = {
			country_exists = GER
			NOT = {
				has_war_with = GER
				GER = { is_subject = yes }
			}
		}

		available = {
		}
		ai_will_do = {
			factor = 10
		}

		cost = 100

		fire_only_once = yes

		days_remove = 182

		remove_effect = {
			add_equipment_to_stockpile = {
				type = ger_motorized_equipment_1
				amount = 1000
				producer = GER
			}
		}
	}
	HUN_buy_german_artillery = {
		icon = gre_investment_decisions

		allowed = { tag = HUN }
		visible = {
			country_exists = GER
			NOT = {
				has_war_with = GER
				GER = { is_subject = yes }
			}
		}

		available = {
		}
		ai_will_do = {
			factor = 10
		}

		cost = 50

		fire_only_once = yes

		days_remove = 182

		remove_effect = {
			add_equipment_to_stockpile = {
				type = ger_art_1
				amount = 100
				producer = GER
			}
		}
	}

	HUN_buy_italian_tanks = {
		icon = gre_investment_decisions

		allowed = { tag = HUN }
		visible = {
			country_exists = ITA
			NOT = {
				has_war_with = ITA
				ITA = { is_subject = yes }
			}
		}

		available = {
		}
		ai_will_do = {
			factor = 10
		}

		cost = 50

		fire_only_once = yes

		days_remove = 365

		remove_effect = {
			add_equipment_to_stockpile = {
				type = tank_ita_light_chassis_2
				amount = 120
				producer = ITA
			}
		}
	}

	HUN_core_southern_slovakia = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 0

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 664 = { is_core_of = ROOT } }
		}

		available = {
			664 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			664 = { add_core_of = ROOT }
		}
	}

	HUN_core_carpathian_ruthenia = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 50

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 73 = { is_core_of = ROOT } }
		}

		available = {
			73 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			73 = { add_core_of = ROOT }
		}
	}

	HUN_core_burgenland = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 30

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 997 = { is_core_of = ROOT } }
		}

		available = {
			997 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			997 = { add_core_of = ROOT }
		}
	}

	HUN_core_prekmurje = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 30

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 888 = { is_core_of = ROOT } }
		}

		available = {
			888 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			888 = { add_core_of = ROOT }
		}
	}

	HUN_core_vojvodina = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 0

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 45 = { is_core_of = ROOT } }
		}

		available = {
			45 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			45 = { add_core_of = ROOT }
		}
	}

	HUN_core_west_banat = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 0

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 764 = { is_core_of = ROOT } }
		}

		available = {
			764 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			764 = { add_core_of = ROOT }
		}
	}

	HUN_core_north_transylvania = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 0

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 76 = { is_core_of = ROOT } }
		}

		available = {
			76 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			76 = { add_core_of = ROOT }
		}
	}

	HUN_core_transylvania = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 20

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 84 = { is_core_of = ROOT } }
		}

		available = {
			84 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			84 = { add_core_of = ROOT }
		}
	}

	HUN_core_crisana = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 20

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 83 = { is_core_of = ROOT } }
		}

		available = {
			83 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			83 = { add_core_of = ROOT }
		}
	}

	HUN_core_banat = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 20

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 82 = { is_core_of = ROOT } }
		}

		available = {
			82 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			82 = { add_core_of = ROOT }
		}
	}

	HUN_core_croatia = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 70

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 109 = { is_core_of = ROOT } }
			if = {
				limit = {
					109 = {
						has_dynamic_modifier = {
							modifier = YUG_organized_partisan_activity
						}
					}
				}
				109 = {
					NOT = {
						has_dynamic_modifier = {
							modifier = YUG_organized_partisan_activity
						}
					}
				}
			}
			if = {
				limit = {
					109 = {
						has_dynamic_modifier = {
							modifier = YUG_dispersed_partisan_activity
						}
					}
				}
				109 = {
					NOT = {
						has_dynamic_modifier = {
							modifier = YUG_dispersed_partisan_activity
						}
					}
				}
			}
		}

		available = {
			109 = { is_fully_controlled_by = ROOT }
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			109 = { add_core_of = ROOT }
		}
	}

	HUN_core_northern_dalmatia = {
		icon = generic_nationalism

		fire_only_once = yes

		cost = 100

		visible = {
			OR = {
				has_completed_focus = HUN_our_fate_in_other_hands
				has_completed_focus = HUN_hungarian_irredentism
				has_completed_focus = HUN_our_fate_tied_to_another
			}
			NOT = { 1022 = { is_core_of = ROOT } }
			NOT = { 999 = { is_core_of = ROOT } }
		}

		available = {
			#if = {
			#	limit = {
			#		has_completed_focus = HUN_our_fate_in_other_hands
			#	}
			#	999 = { is_fully_controlled_by = ROOT }
			#	owns_state = 999
			#}
			#else = {
			#	999 = { is_fully_controlled_by = ROOT }
			#}
			1022 = { is_fully_controlled_by = ROOT }
			999 = { is_fully_controlled_by = ROOT }
			if = {
				limit = {
					1022 = {
						has_dynamic_modifier = {
							modifier = YUG_organized_partisan_activity
						}
					}
				}
				1022 = {
					NOT = {
						has_dynamic_modifier = {
							modifier = YUG_organized_partisan_activity
						}
					}
				}
			}
			if = {
				limit = {
					1022 = {
						has_dynamic_modifier = {
							modifier = YUG_dispersed_partisan_activity
						}
					}
				}
				1022 = {
					NOT = {
						has_dynamic_modifier = {
							modifier = YUG_dispersed_partisan_activity
						}
					}
				}
			}
			if = {
				limit = {
					999 = {
						has_dynamic_modifier = {
							modifier = YUG_organized_partisan_activity
						}
					}
				}
				999 = {
					NOT = {
						has_dynamic_modifier = {
							modifier = YUG_organized_partisan_activity
						}
					}
				}
			}
			if = {
				limit = {
					999 = {
						has_dynamic_modifier = {
							modifier = YUG_dispersed_partisan_activity
						}
					}
				}
				999 = {
					NOT = {
						has_dynamic_modifier = {
							modifier = YUG_dispersed_partisan_activity
						}
					}
				}
			}
		}
		ai_will_do = {
			factor = 10
		}

		complete_effect = {
			1022 = { add_core_of = ROOT }
			999 = { add_core_of = ROOT }
		}
	}

	HUN_the_price_of_secrecy = {
		icon = generic_political_discourse

		allowed = {
			always = no
		}

		days_mission_timeout = 90

		selectable_mission = yes

		cost = 50

		ai_will_do = {
			factor = 0
			modifier = {
				add = 400
				has_completed_focus = HUN_demand_a_referendum
			}
		}

		complete_effect = {
			set_global_flag = HUN_habsburg_revealed
			custom_effect_tooltip = HUN_the_price_of_secrecy_tt_2
			hidden_effect = {
				remove_dynamic_modifier = {
					modifier = HUN_the_secret_habsburg_king
				}
			}
			add_naval_commander_role = {
				character = HUN_miklos_horthy
				traits = { gunnery_expert navy_media_personality superior_tactician }
				skill = 3
				legacy_id = 556 #Navy Miklos
				attack_skill = 2
				defense_skill = 2
				maneuvering_skill = 2
				coordination_skill = 4
			}
			promote_character = HUN_otto_von_habsburg
			set_politics = {
				ruling_party = neutrality
				elections_allowed = no
			}
			hidden_effect = {
				news_event = { id = news.290 }
			}
			if = {
				limit = {
					hidden_trigger = {
						is_ai = no
					}
				}
				if = {
					limit = {
						NOT = {
							has_completed_focus = HUN_redeem_the_empire
						}
						OR = {
							strength_ratio = {
								tag = CZE
								ratio < 1
							}
							strength_ratio = {
								tag = YUG
								ratio < 1
							}
						}
					}
					custom_effect_tooltip = HUN_the_price_of_secrecy_tt_3
					CZE = {
						declare_war_on = {
							target = HUN
							type = topple_government
						}
					}
					YUG = {
						declare_war_on = {
							target = HUN
							type = topple_government
						}
					}
					activate_mission = HUN_outlast_the_invasion
					hidden_effect = {
						CZE = {
							give_military_access = YUG
						}
						YUG = {
							give_military_access = CZE
						}
					}
				}
			}
		}

		timeout_effect = {
			custom_effect_tooltip = HUN_the_price_of_secrecy_tt
			add_to_variable = { HUN_secret_political_power_cost = 0.1 }
			add_to_variable = { HUN_secret_sability_factor = -0.02 }
			add_to_variable = { HUN_secret_neutrality_drift = -0.01}
			hidden_effect = {
				activate_mission = HUN_the_price_of_secrecy
			}
		}
	}
}

operations = {

	HUN_outlast_the_invasion = {
		icon = border_war

		allowed = {
			always = no
		}

		days_mission_timeout = 120
		is_good = no

		cancel_trigger = {
			NOT = { controls_state = 889 }
		}

		available = {
			OR = {
				# AND = {
				# 	CZE = {
				# 		casualties_k > 60
				# 	}
				# 	YUG = {
				# 		casualties_k > 60
				# 	}
				# }
				all_enemy_country = {
					casualties_k > 60
				}
				custom_trigger_tooltip = {
					tooltip = HUN_outlast_the_invasion_tt
					always = no
				}
			}
		}

		complete_effect = {
			# white_peace = CZE
			# white_peace = YUG
			every_enemy_country = {
				white_peace = HUN
			}
		}

		# cancel_effect = {

		# }

		timeout_effect = {
			hidden_effect = {
				# white_peace = CZE
				# white_peace = YUG
				every_enemy_country = {
					white_peace = HUN
				}
			}
		}
	}
	#first border incident
	HUN_probe_the_romanians = {
		icon = border_war
		allowed = {
			original_tag = HUN
		}

		available = {
			has_completed_focus = HUN_probe_the_romanians
			NOT = {
				has_war_with = ROM
				is_in_faction_with = ROM
				has_non_aggression_pact_with = ROM
				ROM = { is_puppet_of = HUN }
			}
			76 = {
				any_neighbor_state = {
					is_controlled_by = ROM
				}
			}
		}

		visible = {
		}

		highlight_states = {
	 		highlight_state_targets = {
				state = 76
				state = 154
			}
		}

		fire_only_once = yes
		ai_will_do = {
			factor = 1
		}
		cost = 50
		days_remove = 30
		war_with_on_remove = ROM
		complete_effect = {
			154 = {
				save_event_target_as = HUN_ROM_attacker_state
				set_state_flag = border_incident_active
			}
			76 = {
				save_event_target_as = HUN_ROM_defender_state
				set_state_flag = border_incident_active
			}
			ROM = {
				country_event = { id = hun_armor.835 days = 1 }
				activate_targeted_decision = { target = HUN decision = HUN_border_conflict_warning_ROM }
			}
		}
		remove_effect = {
			activate_targeted_decision = { target = ROM decision = HUN_border_incident_forgotten }
			activate_targeted_decision = { target = ROM decision = HUN_escalate_incident_to_border_conflict_ROM }
		}
	}

	#Mission for defender warning that a conflict with FROM is coming
	HUN_border_conflict_warning_ROM = {

		icon = border_war

		allowed = { always = no } #Activated from effect

		available = {
			hidden_trigger = { always = no }
		}

		war_with_target_on_timeout = yes
		ai_will_do = {
			base = 0
			modifier = {

			}
		}

		days_mission_timeout = 30

		fire_only_once = yes

		is_good = no

		timeout_effect = {
			custom_effect_tooltip = escalation_possible_tooltip_for_defender
			custom_effect_tooltip = effects_if_border_conflict_is_lost
			effect_tooltip = {
				HUN = {
					add_doctrine_cost_reduction = {
						name = rom_hun_border_conflict_won
						category = land_doctrine
						cost_reduction = 0.5
					}
					add_tech_bonus = {
						name = rom_hun_border_conflict_won
						category = armor
						bonus = 1.0
					}
				}
			}
			hidden_effect = {
				remove_targeted_decision = { target = HUN decision = HUN_border_conflict_warning_ROM }
				activate_targeted_decision = { target = HUN decision = HUN_border_conflict_escalation_warning_ROM }
			}
		}
	}

	#Mission for defender warning FROM can escalate to war at any point is coming
	HUN_border_conflict_escalation_warning_ROM = {

		icon = border_war

		allowed = { always = no } #Activated from effect
		visible = { hidden_trigger = { NOT = { has_border_war_with = HUN } } }
		cancel_if_not_visible = yes

		available = {
			#var:ROOT.defender_state_vs_@FROM = {
			#	has_ROOT_at_least_1_div_in_current_state_scope = yes
			#}
			hidden_trigger = { always = no }
		}

		war_with_target_on_timeout = yes
		ai_will_do = {
			base = 0
			modifier = {

			}
		}

		days_mission_timeout = 30

		fire_only_once = yes

		is_good = no

		timeout_effect = {
			custom_effect_tooltip = from_cannot_escalate
			custom_effect_tooltip = effects_if_border_conflict_is_lost
			effect_tooltip = {
				HUN = {
					add_doctrine_cost_reduction = {
						name = rom_hun_border_conflict_won
						category = land_doctrine
						cost_reduction = 0.5
					}
					add_tech_bonus = {
						name = rom_hun_border_conflict_won
						category = armor
						bonus = 1.0
					}
				}
			}
		}
	}
	#Mission for attacker to escalate or incident is forgotten
	HUN_border_incident_forgotten = {

		icon = border_war

		allowed = { always = no } #Activated from effect

		available = {
			has_border_war_with = ROM # Japan shouldn't lose war support if they actually use the window of opportunity
		}

		highlight_states = {
			highlight_state_targets = {
				state = 154
				state = 76
			}
		}

		ai_will_do = {
			base = 0
			modifier = {

			}
		}

		days_mission_timeout = 30

		fire_only_once = yes

		is_good = no

		timeout_effect = {
			remove_targeted_decision = { target = ROM decision = HUN_escalate_incident_to_border_conflict_ROM }
			add_political_power = -100
			add_war_support = -0.1 #Shameful Display
			hidden_effect = {
				ROM = { remove_targeted_decision = { target = HUN decision = HUN_border_conflict_escalation_warning_ROM } }
				ROM = {
					154 = {
						clr_state_flag = border_incident_active
					}
					76 = {
						clr_state_flag = border_incident_active
					}
				}
			}
		}
	}

	#Decision to escalate incident on border with ROM to border conflict
	HUN_escalate_incident_to_border_conflict_ROM = {

		icon = border_war

		allowed = { always = no } #Activated from effect

		available = {
			154 = {
				OR = {
					is_fully_controlled_by = ROOT
					CONTROLLER = {
						is_subject_of = ROOT
					}
					CONTROLLER = {
						is_in_faction_with = ROOT
					}
				}
			}
			divisions_in_border_state = {
				state = 154
				border_state = 76
				size > 0
			}
		}

		highlight_states = {
			highlight_state_targets = {
				state = 154
				state = 76
			}
		}

		ai_will_do = {
			base = 10
			modifier = {
				has_war = no
				factor = 10
			}
		}

		fire_only_once = yes #Reactivation handled in effect

		complete_effect = {
			remove_targeted_decision = { target = ROM decision = HUN_border_incident_forgotten }
			start_border_war = {
				change_state_after_war = no
				attacker = {
					state = 154
					num_provinces = 4
					on_win = hun_armor.836
					on_lose = hun_armor.837
					on_cancel = hun_armor.838
				}

				defender = {
					state = 76
					num_provinces = 3
					on_win = hun_armor.837
					on_lose = hun_armor.836
					on_cancel = hun_armor.838
				}
			}
			ROM = {
				activate_targeted_decision = { target = HUN decision = HUN_border_conflict_escalate_conflict }
				activate_targeted_decision = { target = HUN decision = HUN_border_conflict_time_until_cancelled }
			}
			activate_targeted_decision = { target = ROM decision = HUN_border_conflict_escalate_conflict }
			activate_targeted_decision = { target = ROM decision = HUN_border_conflict_time_until_cancelled }
		}
	}
	#Mission for attacker to win border war against FROM in X days
	HUN_border_conflict_time_until_cancelled = {

		icon = border_war

		allowed = { always = no } #Activated from effect

		available = {
			154 = { has_border_war = no }
			76 = { has_border_war = no }
		}

		highlight_states = {
			highlight_state_targets = {
				state = 76
				state = 154
			}
		}

		ai_will_do = {
			base = 0
			modifier = {

			}
		}

		days_mission_timeout = 90
		is_good = no

		fire_only_once = yes #Reactivation handled in effect

		complete_effect = {

		}

		timeout_effect = {
			cancel_border_war = {
				defender = 76
				attacker = 154
			}
			hidden_effect = {
				remove_targeted_decision = { target = ROM decision = HUN_border_conflict_escalate_conflict }
				remove_targeted_decision = { target = HUN decision = HUN_border_conflict_escalate_conflict }
			}
		}
	}

	#Decision to escalate conflict further
	HUN_border_conflict_escalate_conflict = {

		icon = generic_ignite_civil_war

		allowed = { always = no } #Activated from effect

		visible = {
			has_border_war_with = FROM
		}

		highlight_states = {
			highlight_state_targets = {
				state = 154
				state = 76
			}
		}

		cost = 200

		ai_will_do = {
			base = 0
		}

		fire_only_once = yes #Reactivation handled in effect

		complete_effect = {
			if = {
				limit = { original_tag = ROM }
				set_border_war_data = {
					attacker = 154
					defender = 76
					defender_modifier = 0.15
					combat_width = 100
				}
				HUN = {
					set_country_flag = {
						flag = WTT_border_conflict_escalate_to_war_cooldown
						days = 60
						value = 1
					}
					remove_targeted_decision = { target = ROM decision = HUN_border_conflict_escalate_conflict }
				}
				set_country_flag = {
					flag = WTT_border_conflict_escalate_to_war_cooldown
					days = 60
					value = 1
				}
				custom_effect_tooltip = in_60_days
				activate_targeted_decision = { target = HUN decision = HUN_border_conflict_escalate_to_war }
			}
			else = {
				set_border_war_data = {
					attacker = 154
					defender = 76
					attacker_modifier = 0.15
					combat_width = 100
				}
				ROM = {
					set_country_flag = {
						flag = WTT_border_conflict_escalate_to_war_cooldown
						days = 60
						value = 1
					}
					remove_targeted_decision = { target = HUN decision = HUN_border_conflict_escalate_conflict }
				}
				set_country_flag = {
					flag = WTT_border_conflict_escalate_to_war_cooldown
					days = 60
					value = 1
				}
				custom_effect_tooltip = in_60_days
				activate_targeted_decision = { target = ROM decision = HUN_border_conflict_escalate_to_war }
			}

		}
	}

	#Decision to escalate conflict further
	HUN_border_conflict_escalate_to_war = {

		icon = generic_ignite_civil_war

		allowed = { always = no } #Activated from effect

		visible = {
			NOT = { has_country_flag = WTT_border_conflict_escalate_to_war_cooldown }
			has_border_war_with = FROM
		}
		cancel_trigger = {
			NOT = { has_border_war = yes }
		}

		highlight_states = {
 			highlight_state_targets = {
				state = 76
				state = 154
			}
		}

		cost = 150

		ai_will_do = {
			base = 0
		}

		days_remove = 10

		fire_only_once = yes #Reactivation handled in effect

		war_with_target_on_remove = yes

		complete_effect = {
			if = {
				limit = { original_tag = ROM }
				76 = { save_event_target_as = their_state }
				154 = { save_event_target_as = our_state }
				HUN = {
					country_event = { id = hun_armor.840 hours = 1 }
					hidden_effect = {
						remove_targeted_decision = { target = ROM decision = HUN_border_conflict_escalate_to_war }
					}
			 	}
			}
			else = {
				154 = { save_event_target_as = our_state }
				76 = { save_event_target_as = their_state }
				ROM = {
					country_event = { id = hun_armor.839 hours = 1 }
					hidden_effect = {
						remove_targeted_decision = { target = HUN decision = HUN_border_conflict_escalate_to_war }
					}
			 	}
			}

		}

		remove_effect = {
			cancel_border_war = {
				dont_fire_events = yes
				defender = 76
				attacker = 154
			}
			declare_war_on = { target = FROM type = annex_everything }
			if = {
				limit = { original_tag = ROM }
				154 = {
					clr_state_flag = border_incident_active
				}
				76 = {
					clr_state_flag = border_incident_active
				}

			}
			else = {
				FROM = {
					154 = {
						clr_state_flag = border_incident_active
					}
					76 = {
						clr_state_flag = border_incident_active
					}
				}
			}
		}
	}

	#Decision to back down from conflict
	HUN_border_conflict_back_out_of_conflict = {

		allowed = { always = no } #Activated from effect

		visible = {
			has_border_war_with = FROM
		}

		highlight_states = {
			highlight_state_targets = {
				state = 154
				state = 76
			}
		}

		ai_will_do = {
			base = 0
			modifier = {

			}
		}

		fire_only_once = yes #Reactivation handled in effect

		complete_effect = {
			if = {
				limit = { original_tag = ROM }
				finalize_border_war = {
					attacker_win = yes
					attacker = 154
					defender = 76
				}
			}
			else = {
				finalize_border_war = {
					attacker = 154
					defender = 76
					defender_win = yes
				}
			}
		}
	}
}