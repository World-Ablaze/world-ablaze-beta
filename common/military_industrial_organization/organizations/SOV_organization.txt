##################
#### CONSTANTS ###
##################
# Used for the Merge Plant traits for easier maintenance

### TANKS
#POSITION
@tank_1_X = 9
@tank_1_Y = 2
@tank_2_X = 9
@tank_2_Y = 3
@tank_3_X = 9
@tank_3_Y = 4
#BONUSES
@tank_build_cost_ic = -0.02
@tank_production_capacity_factor = 0.05
@tank_production_efficiency_gain_factor = 0.02


### SHIPS
#POISTION
@ship_1_X = 9
@ship_1_Y = 3
@ship_2_X = 9
@ship_2_Y = 4
@ship_3_X = 8
@ship_3_Y = 4
#BONUSES
@ship_cruiser_production_cost_factor = -0.02
@ship_destroyer_production_cost_factor = -0.02
@ship_submarine_production_cost_factor = -0.03
@ship_production_capacity_factor = 0.05
@ship_mines_sweeping = 0.05
@ship_mines_planting = 0.05


### AIRCRAFT
#POSITION
@aircraft_1_X = 9
@aircraft_1_Y = 2
@aircraft_2_X = 9
@aircraft_2_Y = 3
@aircraft_3_X = 9
@aircraft_3_Y = 4
#BONUSES
@aircraft_production_cost_factor = -0.02
@aircraft_production_capacity_factor = 0.05
@aircraft_production_efficiency_gain_factor = 0.02
@aircraft_production_efficiency_cap_factor = 0.1


### MATERIEL
#POSITION
@materiel_1_X = 9
@materiel_1_Y = 2
@materiel_2_X = 9
@materiel_2_Y = 3
@materiel_3_X = 9
@materiel_3_Y = 4
#BONUSES
@artillery_production_cost_factor = -0.03
@infantry_equipment_production_cost_factor = -0.02
@infantry_equipment_production_efficiency_gain_factor = 0.02
@motorized_production_cost_factor = -0.02
@materiel_production_efficiency_cap_factor = 0.05
@materiel_production_capacity_factor = 0.05
@materiel_production_resource_penalty_factor = -0.1


########    ###    ##    ## ##    ##  ######
   ##      ## ##   ###   ## ##   ##  ##    ##
   ##     ##   ##  ####  ## ##  ##   ##
   ##    ##     ## ## ## ## #####     ######
   ##    ######### ##  #### ##  ##         ##
   ##    ##     ## ##   ### ##   ##  ##    ##
   ##    ##     ## ##    ## ##    ##  ######


SOV_morozov_design_bureau_organization = {
	include = generic_medium_tank_organization
	icon = GFX_idea_morozov_design_bureau

	allowed = {
		original_tag = SOV
	}

	available = {
	}

	equipment_type = {
		mio_cat_eq_all_bt_tank
		mio_cat_eq_all_t34_tank
		mio_cat_eq_all_modern_tank_and_variants
	}

	research_categories = {
		cat_bt
		cat_t34
	}

	override_trait = {
		token = mio_suspension_improvements

		limit_to_equipment_type = {
			mio_cat_eq_all_bt_tank
			mio_cat_eq_all_medium_tank
			mio_cat_eq_all_modern_tank
		}
	}

	initial_trait = {

		limit_to_equipment_type = {
			mio_cat_eq_all_bt_tank
		}
		production_bonus = {
			production_efficiency_cap_factor = 0.15
		}
	}

	add_trait = {	# Plant 183 T34
		token = SOV_mio_trait_merge_plant_no_183
		name = SOV_mio_trait_merge_plant_no_183
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@tank_1_X y=@tank_1_Y }

		available = { #Two owner blocs to provide two different check marks in the UI
			FROM = {
				has_full_control_of_state = 653 #SVERDLOVSK
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { tank_sov_medium_chassis_3_2 tank_sov_medium_chassis_3_3 }

		production_bonus = {
			production_capacity_factor = @tank_production_capacity_factor
		}
	}

	add_trait = {	# PLant 112 T34 85
		token = SOV_mio_trait_merge_plant_no_112
		name = SOV_merge_tank_plant_2
		icon = GFX_generic_mio_trait_icon_production_capacity
		special_trait_background = yes

		position = { x=@tank_2_X y=@tank_2_Y }

		available = {
			FROM = {
				has_full_control_of_state = 252 #GORKY
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = tank_plant_ready2
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { tank_sov_medium_chassis_3_3 tank_sov_medium_chassis_3_4 }

		equipment_bonus = {
			build_cost_ic = @tank_build_cost_ic
		}
	}

	add_trait = {	# Ural Heavy Machine Building Plant SU 85 100 122
		token = SOV_mio_trait_merge_ural_heavy_machine_building_plant
		name = SOV_merge_tank_plant_3
		icon = GFX_generic_mio_trait_icon_soft_attack
		special_trait_background = yes

		position = { x=@tank_3_X y=@tank_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 653 #SVERDLOVSK
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = tank_plant_ready3
			}
			#Only exists in this MIO
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_ural_heavy_machine_building_plant_flag
			}
		}

		limit_to_equipment_type = { tank_sov_medium_chassis_assault_3 tank_sov_medium_chassis_td_3_2 tank_sov_medium_chassis_td_3_3 }

		production_bonus = {
			production_efficiency_gain_factor = @tank_production_efficiency_gain_factor
		}
	}
}

SOV_uralvagonzavod_organization = {
	include = generic_modern_tank_organization
	icon = GFX_idea_uralvagonzavod

	allowed = {
		original_tag = SOV
		has_dlc = "Arms Against Tyranny"
	}

	available = {
		FROM = {
			has_completed_focus = SOV_national_specialists
		}
	}

	equipment_type = {
		mio_cat_eq_all_t34_tank
		mio_cat_eq_all_t43_tank
		mio_cat_eq_all_modern_tank_and_variants
	}

	research_categories = {
		cat_t43
		cat_modern_armor
	}
}

SOV_astrov_design_bureau_organization = {
	include = generic_light_tank_organization
	icon = GFX_idea_astrov_design_bureau

	allowed = {
		original_tag = SOV
		has_dlc = "Arms Against Tyranny"
	}

	available = {
		FROM = {
			has_completed_focus = SOV_national_specialists
		}
	}

	tree_header_text = {
		text = mio_header_armor
		x = 1
	}

	tree_header_text = {
		text = mio_header_weapons
		x = 5
	}

	tree_header_text = {
		text = mio_header_mechanized
		x = 7
	}

	equipment_type = {
		mio_cat_eq_all_light_tank
		light_tank_assault_chassis
	}

	research_categories = {
		cat_light_armor
		cat_light_assault_spg
		cat_light_spg
		cat_light_td
		cat_light_spaa
		cat_light_infantry_support
	}

	add_trait = {	# Plant 174 T 50 mediums
		token = SOV_mio_trait_merge_plant_no_174
		name = SOV_merge_tank_plant
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_trait_icon_maximum_speed
		special_trait_background = yes

		position = { x=@tank_1_X y=@tank_1_Y }



		available = { #Two owner blocs to provide two different check marks in the UI
			FROM = {
				has_full_control_of_state = 571 #OMSK
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = tank_plant_ready
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_174_flag2 }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_174_flag
			}
		}

		limit_to_equipment_type = { tank_sov_light_chassis_support_2 mio_cat_eq_all_medium_tank }

		production_bonus = {
			production_capacity_factor = @tank_production_capacity_factor
		}
	}

	add_trait = {	# PLant 37 Light Tanks
		token = SOV_mio_trait_merge_plant_no_37
		name = SOV_mio_trait_merge_plant_no_37
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@tank_2_X y=@tank_2_Y }

		available = {
			FROM = {
				has_full_control_of_state = 653 #SVERDLOVSK
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { light_tank_chassis }

		production_bonus = {
			production_capacity_factor = @tank_production_capacity_factor
		}
	}
}

SOV_okmo_organization = {
	include = generic_infantry_tank_organization
	icon = GFX_idea_okmo

	allowed = {
		tag = SOV
	}

	equipment_type = {
		mio_cat_eq_all_t26_tank
		mio_cat_eq_all_t50_tank
	}

	research_categories = {
		cat_t26
		cat_t50
	}

	remove_trait = { mio_standardize_turrets_and_hulls }

	remove_trait = { mio_integrated_variant_turret_and_hulls }

	add_trait = {
		token = mio_standardize_turrets_and_hulls_2
		name = standardize_turrets_and_hulls
		icon = GFX_generic_mio_trait_icon_build_cost_ic

		all_parents = { mio_simplified_parts_and_systems }
		position = { x = -1 y = 1 }
		relative_position_id = mio_simplified_parts_and_systems

		production_bonus = {
			production_cost_factor = -0.04
		}
	}

	initial_trait = {
		name = generic_mio_initial_trait_infantry_tanks_designer

		limit_to_equipment_type = {
			mio_cat_eq_all_t26_tank
			mio_cat_eq_all_t50_tank
		}
		production_bonus = {
			production_efficiency_cap_factor = 0.15
		}
	}

	add_trait = {	# Plant 174 T 50 mediums
		token = SOV_mio_trait_merge_plant_no_174
		name = SOV_merge_tank_plant
		icon = GFX_generic_mio_trait_icon_maximum_speed
		special_trait_background = yes

		position = { x=@tank_1_X y=@tank_1_Y }

		available = { #Two owner blocs to provide two different check marks in the UI
			FROM = {
				has_full_control_of_state = 571 #OMSK
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_country_flag = tank_plant_ready
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_174_flag }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_174_flag2
			}
		}

		limit_to_equipment_type = { tank_sov_light_chassis_support_2 mio_cat_eq_all_medium_tank }

		production_bonus = {
			production_capacity_factor = @tank_production_capacity_factor
		}
	}

	add_trait = {	#Plant 185 Heavy Tanks
		token = SOV_mio_trait_merge_plant_no_185
		name = SOV_mio_trait_merge_plant_no_185
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@tank_2_X y=@tank_2_Y }

		available = {
			FROM = {
				has_full_control_of_state = 572 #Chelyabinsk
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { mio_cat_eq_all_heavy_tank }

		production_bonus = {
			production_capacity_factor = @tank_production_capacity_factor
		}
	}

	add_trait = {	# Plant 75 Heavy Tanks
		token = SOV_mio_trait_merge_plant_no_75
		name = SOV_mio_trait_merge_plant_no_75
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@tank_3_X y=@tank_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 572 #Chelyabinsk
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_75_flag2 }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_75_flag
			}
		}

		limit_to_equipment_type = { mio_cat_eq_all_heavy_tank }

		equipment_bonus = {
			build_cost_ic = @tank_build_cost_ic
		}
	}
}

SOV_mytishchy_machine_building_plant_organization = {
	include = generic_tank_refurbishment_plant_organization
	icon = GFX_idea_SOV_mytishchy_machine_building_plant

	allowed = {
		tag = SOV
	}

	equipment_type = {
		mio_cat_eq_all_infantry_support_tanks
		mio_cat_eq_all_tank_destroyers
		mio_cat_eq_all_assault_guns
		mio_cat_eq_all_artillery_tanks
		mio_cat_eq_all_anti_air_tanks
	}

	research_categories = {
		cat_light_assault_spg
		cat_medium_assault_spg
		cat_modern_assault_spg
		cat_heavy_assault_spg
		cat_light_td
		cat_medium_td
		cat_modern_td
		cat_heavy_td
		cat_light_spg
		cat_medium_spg
		cat_modern_spg
		cat_heavy_spg
		cat_light_spaa
		cat_medium_spaa
		cat_modern_spaa
		cat_heavy_spaa
	}

	add_trait = {	# NKMZ heavy arty armoured trains
		token = SOV_mio_trait_merge_nkmz_plant
		name = SOV_merge_materiel_plant_2
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_trait_icon_efficiency_cap
		special_trait_background = yes

		position = { x=0 y=-1 }
		relative_position_id = SOV_mio_trait_merge_plant_no_78


		available = {
			FROM = {
				has_full_control_of_state = 582 #Orsk
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = materiel_plant2_ready
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_nkmz_plant_flag }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_nkmz_plant_flag2
			}
		}

		limit_to_equipment_type = { train_equipment_4 }

		production_bonus = {
			production_efficiency_cap_factor = @materiel_production_efficiency_cap_factor
		}
	}

	add_trait = {	# PLant 78
		token = SOV_mio_trait_merge_plant_no_78
		name = SOV_mio_trait_merge_plant_no_78
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@tank_1_X y=@tank_1_Y }

		available = { #Two owner blocs to provide two different check marks in the UI
			FROM = {
				has_full_control_of_state = 572 #Chelyabinsk
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_meerge_plant_no_78_flag
			}
		}

		production_bonus = {
			production_resource_need_factor = -0.05
		}
	}

	add_trait = {	# Ust-Katav Wagon Plant
		token = SOV_mio_trait_merge_ust_katav_wagon_plant
		name = SOV_mio_trait_merge_ust_katav_wagon_plant
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_trait_icon_production_capacity
		special_trait_background = yes

		position = { x=@tank_2_X y=@tank_2_Y }

		available = {
			FROM = {
				has_full_control_of_state = 252 #GORKY
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { train_equipment }

		production_bonus = {
			production_capacity_factor = @tank_production_capacity_factor
		}
	}

	add_trait = {	# Kharkov Locomotive Plant
		token = SOV_mio_trait_merge_kharkov_locomotive_plant
		name = SOV_mio_trait_merge_kharkov_locomotive_plant
		icon = GFX_generic_mio_trait_icon_soft_attack
		special_trait_background = yes

		position = { x=@tank_3_X y=@tank_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 653 #SVERDLOVSK
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { train_equipment }

		equipment_bonus = {
			build_cost_ic = @tank_build_cost_ic
		}
	}
}

SOV_kirov_organization = {
	include = generic_heavy_tank_organization
	icon = GFX_idea_SOV_kirov

	allowed = {
		original_tag = SOV
	}

	available = {
	}

	equipment_type = {
		mio_cat_eq_all_t28_tank
		mio_cat_eq_all_heavy_tank
		heavy_tank_assault_chassis
	}

	research_categories = {
		cat_t28
		cat_heavy_armor
	}

	add_trait = {	# Plant 100 SU 152 ISU 122 ISU 152
		token = SOV_mio_trait_merge_plant_no_100
		name = SOV_mio_trait_merge_plant_no_100
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@tank_1_X y=@tank_1_Y }

		available = {
			FROM = {
				has_full_control_of_state = 572 #Chelyabinsk
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
		}

		limit_to_equipment_type = { tank_sov_heavy_chassis_assault_3 tank_sov_heavy_chassis_td_4 tank_sov_heavy_chassis_assault_4 }

		production_bonus = {
			production_efficiency_gain_factor = @tank_production_efficiency_gain_factor
		}
	}

	add_trait = {	# Plant 75 Heavy Tanks
		token = SOV_mio_trait_merge_plant_no_75
		name = SOV_mio_trait_merge_plant_no_75
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@tank_2_X y=@tank_2_Y }

		available = {
			FROM = {
				has_full_control_of_state = 572 #Chelyabinsk
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_75_flag }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_75_flag2
			}
		}

		limit_to_equipment_type = { mio_cat_eq_all_heavy_tank }

		equipment_bonus = {
			build_cost_ic = @tank_build_cost_ic
		}
	}

	add_trait = {	# Magnitogorsk Metallurgical Plant Support Equipment - Steel
		token = SOV_mio_trait_merge_magnitogorsk_metallurgical_plant
		name = SOV_merge_materiel_plant_3
		icon = GFX_generic_mio_trait_icon_resources
		special_trait_background = yes

		position = { x=@tank_3_X y=@tank_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 876 #MAGNITOGORSK
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = materiel_plant3_ready
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_magnitogorsk_metallurgical_plant_flag2 }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_magnitogorsk_metallurgical_plant_flag
			}
		}

		production_bonus = {
			production_resource_penalty_factor = @materiel_production_resource_penalty_factor
		}
	}
}

SOV_izhorskiye_zavody_organization = {
	include = generic_armored_car_organization
	icon = GFX_idea_izhorskiye_zavody

	allowed = {
		original_tag = SOV
	}
}

########  ##          ###    ##    ## ########  ######
##     ## ##         ## ##   ###   ## ##       ##    ##
##     ## ##        ##   ##  ####  ## ##       ##
########  ##       ##     ## ## ## ## ######    ######
##        ##       ######### ##  #### ##             ##
##        ##       ##     ## ##   ### ##       ##    ##
##        ######## ##     ## ##    ## ########  ######

SOV_mig_design_bureau_organization = {
	include = generic_light_aircraft_organization
	icon = GFX_idea_mig_design_bureau

	allowed = {
		tag = SOV
	}
	available = {
		FROM = { has_completed_focus = SOV_expand_the_aircraft_industry }
	}
	equipment_type = {
		mio_cat_eq_all_mig
	}

	research_categories = {
		cat_mig_planes
		jet_technology
	}

	add_trait = {	# Plant 1 CAS - MIGs
		token = SOV_mio_trait_merge_plant_no_1
		name = SOV_mio_trait_merge_plant_no_1
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@aircraft_1_X y=@aircraft_1_Y }



		available = {
			FROM = {
				has_full_control_of_state = 251 #KUYBYSHEV
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_1_flag2 }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_1_flag
			}
		}

		limit_to_equipment_type = { small_bomber_airframe }

		production_bonus = {
			production_cost_factor = @aircraft_production_cost_factor
		}
	}

	add_trait = {	# Plant 18 tactical strategic CAS
		token = SOV_mio_trait_merge_plant_no_18
		name = SOV_mio_trait_merge_plant_no_18
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@aircraft_2_X y=@aircraft_2_Y }



		available = {
			FROM = {
				has_full_control_of_state = 251 #KUYBYSHEV
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready
			}
			hidden_trigger = {
				FROM = {
					OR = {
						NOT = { has_country_flag = SOV_merge_plant_no_18_flag2 }
						NOT = { has_country_flag = SOV_merge_plant_no_18_flag3 }
					}
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_18_flag
			}
		}

		production_bonus = {
			production_capacity_factor = @aircraft_production_capacity_factor
		}
	}

	add_trait = {	# Plant 150 general Planes
		token = SOV_mio_trait_merge_plant_no_150
		name = SOV_merge_aircraft_plant_2
		icon = GFX_generic_mio_trait_icon_air_agility
		special_trait_background = yes

		position = { x=@aircraft_3_X y=@aircraft_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 219 #MOSCOW
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready2
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_150_flag2 }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_150_flag
			}
		}

		production_bonus = {
			production_efficiency_cap_factor = @aircraft_production_efficiency_cap_factor
		}
	}
}

SOV_yakovlev_design_bureau_organization = {
	include = generic_light_aircraft_organization
	icon = GFX_idea_yakovlev_design_bureau

	allowed = {
		original_tag = SOV
	}

	equipment_type = {
		mio_cat_eq_all_yak
		medium_multirole_scout_airframe
	}

	research_categories = {
		cat_yak_planes
	}

	add_trait = {	# Plant 153 YaKs
		token = SOV_mio_trait_merge_plant_no_153
		name = SOV_mio_trait_merge_plant_no_153
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@aircraft_1_X y=@aircraft_1_Y }

		available = {
			FROM = {
				has_full_control_of_state = 570 #Novosibirsk
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
		}

		limit_to_equipment_type = { small_fighter_airframe }

		production_bonus = {
			production_cost_factor = @aircraft_production_cost_factor
		}
	}

	add_trait = {	# Plant 82 Yaks
		token = SOV_mio_trait_merge_plant_no_82
		name = SOV_mio_trait_merge_plant_no_82
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@aircraft_2_X y=@aircraft_2_Y }

		available = {
			FROM = {
				has_full_control_of_state = 219 #MOSCOW
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready2
			}
		}

		on_complete = {
			FROM = {
				219 = {
					add_building_construction = {
						type = aluminium_refinery
						level = 1
						instant_build = yes
					}
				}
			}
		}

		limit_to_equipment_type = { small_fighter_airframe }

		production_bonus = {
			production_capacity_factor = @aircraft_production_capacity_factor
		}
	}

	add_trait = {	# Plant 166 YaKs - Tu strike and jet bombers
		token = SOV_mio_trait_merge_plant_no_166
		name = SOV_mio_trait_merge_plant_no_166
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@aircraft_3_X y=@aircraft_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 571 #OMSK
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready3
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_166_flag2 }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_166_flag
			}
		}

		limit_to_equipment_type = { small_fighter_airframe }

		production_bonus = {
			production_efficiency_gain_factor = @aircraft_production_efficiency_gain_factor
		}
	}
}

SOV_lavochkin_design_bureau_organization = {
	include = generic_light_multi_role_aircraft_organization
	icon = GFX_idea_lavochkin
	allowed = {
		original_tag = SOV
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		#FROM = { has_completed_focus = SOV_expand_the_aircraft_industry }
	}

	equipment_type = {
		mio_cat_eq_all_la
	}

	research_categories = {
		cat_la_planes
		jet_technology
	}

	add_trait = {	# Plant 21 La
		token = SOV_mio_trait_merge_plant_no_21
		name = SOV_mio_trait_merge_plant_no_21
		icon = GFX_generic_mio_trait_icon_air_agility
		special_trait_background = yes

		position = { x=@aircraft_3_X y=@aircraft_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 252 #Gorky
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
		}

		production_bonus = {
			production_capacity_factor = @aircraft_production_capacity_factor
		}
	}
}

SOV_ilyushin_design_bureau_organization = {
	include = generic_cas_aircraft_organization
	icon = GFX_idea_ilyushin_design_bureau

	allowed = {
		tag = SOV
	}

	equipment_type = {
		small_bomber_airframe
		naval_bomber
		medium_plane_airframe
		transport_plane_equipment
	}

	research_categories = {
		cas_bomber
		tactical_bomber
		cat_transport
		naval_bomber
	}

	add_trait = {	# Plant 1 CAS - MIGs
		token = SOV_mio_trait_merge_plant_no_1
		name = SOV_mio_trait_merge_plant_no_1
		icon = GFX_generic_mio_trait_icon_build_cost_ic
		special_trait_background = yes

		position = { x=0 y=-1 }
		relative_position_id = SOV_mio_trait_merge_plant_no_18

		available = {
			FROM = {
				has_full_control_of_state = 251 #KUYBYSHEV
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_1_flag }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_1_flag2
			}
		}

		limit_to_equipment_type = { small_bomber_airframe }

		production_bonus = {
			production_cost_factor = @aircraft_production_cost_factor
		}
	}

	add_trait = {	# Plant 18 tactical strategic CAS
		token = SOV_mio_trait_merge_plant_no_18
		name = SOV_mio_trait_merge_plant_no_18
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_trait_icon_build_cost_ic
		special_trait_background = yes

		position = { x=@aircraft_1_X y=@aircraft_1_Y }

		available = {
			FROM = {
				has_full_control_of_state = 251 #KUYBYSHEV
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready
			}
			hidden_trigger = {
				FROM = {
					OR = {
						NOT = { has_country_flag = SOV_merge_plant_no_18_flag }
						NOT = { has_country_flag = SOV_merge_plant_no_18_flag3 }
					}
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_18_flag2
			}
		}

		production_bonus = {
			production_capacity_factor = @aircraft_production_capacity_factor
		}
	}

	add_trait = {	# Plant 35 CAS
		token = SOV_mio_trait_merge_plant_no_35
		name = SOV_mio_trait_merge_plant_no_35
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_trait_icon_air_agility
		special_trait_background = yes

		position = { x=@aircraft_2_X y=@aircraft_2_Y }

		available = {
			FROM = {
				has_full_control_of_state = 219 #MOSCOW
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready2
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_150_flag
				219 = {
					add_building_construction = {
						type = aluminium_refinery
						level = 1
						instant_build = yes
					}
				}
			}
		}

		limit_to_equipment_type = { small_bomber_airframe }

		production_bonus = {
			production_efficiency_gain_factor = @aircraft_production_efficiency_gain_factor
		}
	}

	add_trait = {	# Plant 150 general Planes
		token = SOV_mio_trait_merge_plant_no_150
		name = SOV_merge_aircraft_plant_2
		icon = GFX_generic_mio_trait_icon_air_agility
		special_trait_background = yes

		position = { x=@aircraft_3_X y=@aircraft_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 219 #MOSCOW
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready2
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_150_flag }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_150_flag2
			}
		}

		production_bonus = {
			production_efficiency_cap_factor = @aircraft_production_efficiency_cap_factor
		}
	}
}

SOV_okb_organization = {
	include = generic_medium_aircraft_organization
	icon = GFX_idea_okb

	allowed = {
		tag = SOV
	}

	equipment_type = {
		heavy_fighter_airframe
	}

	research_categories = {	cat_heavy_fighter cat_attacker }
}

SOV_tupolev_design_bureau_organization = {
	include = generic_heavy_aircraft_organization
	icon = GFX_idea_tupolev_design_bureau
	allowed = {
		original_tag = SOV
		has_dlc = "Arms Against Tyranny"
	}

	available = {
		FROM = {
			NOT = { has_country_flag = SOV_tupolev_design_bureau_dissolved_flag }
		}
	}

	equipment_type = {
		medium_multirole_plane_airframe
		large_plane_airframe
	}

	add_trait = {	# Plant 18 tactical strategic CAS
		token = SOV_mio_trait_merge_plant_no_18
		name = SOV_mio_trait_merge_plant_no_18
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@aircraft_1_X y=@aircraft_1_Y }

		available = {
			FROM = {
				has_full_control_of_state = 251 #KUYBYSHEV
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready
			}
			hidden_trigger = {
				FROM = {
					OR = {
						NOT = { has_country_flag = SOV_merge_plant_no_18_flag }
						NOT = { has_country_flag = SOV_merge_plant_no_18_flag2 }
					}
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_18_flag3
			}
		}

		production_bonus = {
			production_capacity_factor = @aircraft_production_capacity_factor
		}
	}

	add_trait = {	# Plant 23 strike planes
		token = SOV_mio_trait_merge_plant_no_23
		name = SOV_mio_trait_merge_plant_no_23
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@aircraft_2_X y=@aircraft_2_Y }

		available = {
			FROM = {
				has_full_control_of_state = 219 #MOSCOW
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready2
			}
		}

		on_complete = {
			FROM = {
				219 = {
					add_building_construction = {
						type = aluminium_refinery
						level = 1
						instant_build = yes
					}
				}
			}
		}

		limit_to_equipment_type = { medium_multirole_plane_airframe }

		production_bonus = {
			production_efficiency_cap_factor = @aircraft_production_efficiency_cap_factor
		}
	}

	add_trait = {	# Plant 166 YaKs - Tu strike and jet bombers
		token = SOV_mio_trait_merge_plant_no_166
		name = SOV_mio_trait_merge_plant_no_166
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@aircraft_3_X y=@aircraft_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 571 #OMSK
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = aircraft_plant_ready3
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_166_flag }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_166_flag2
			}
		}

		limit_to_equipment_type = { large_plane_airframe mio_cat_eq_only_tactical_bomber }

		production_bonus = {
			production_efficiency_gain_factor = @aircraft_production_efficiency_gain_factor
		}
	}
}




##     ##    ###    ######## ######## ########  #### ######## ##
###   ###   ## ##      ##    ##       ##     ##  ##  ##       ##
#### ####  ##   ##     ##    ##       ##     ##  ##  ##       ##
## ### ## ##     ##    ##    ######   ########   ##  ######   ##
##     ## #########    ##    ##       ##   ##    ##  ##       ##
##     ## ##     ##    ##    ##       ##    ##   ##  ##       ##
##     ## ##     ##    ##    ######## ##     ## #### ######## ########

SOV_tula_arms_plant_organization = {
	include = generic_infantry_equipment_organization
	icon = GFX_idea_tula_arms_plant

	allowed = {
		original_tag = SOV
	}

	available = {
	}

	equipment_type = {
		mio_cat_eq_all_infantry_equipment
		#support_equipment
	}

	add_trait = {	# Plant 622 all heavy arms
		token = SOV_mio_trait_merge_plant_no_622
		name = SOV_merge_materiel_plant_1_infantry
		icon = GFX_generic_mio_department_icon_infantry_production
		special_trait_background = yes

		position = { x=@materiel_1_X y=@materiel_1_Y }



		available = {
			FROM = {
				has_full_control_of_state = 399 #UDMURTIA (Izhevsk)
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = infantry_plant_ready
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { heavy_infantry_equipment }

		production_bonus = {
			production_efficiency_gain_factor = @infantry_equipment_production_efficiency_gain_factor
		}
	}

	add_trait = { # Plant 74 small arms
		token = SOV_mio_trait_merge_plant_no_74
		name = SOV_mio_trait_merge_plant_no_74
		icon = GFX_generic_mio_department_icon_infantry_production
		special_trait_background = yes

		position = { x=@materiel_2_X y=@materiel_2_Y }

		available = {
			FROM = {
				has_full_control_of_state = 399 #UDMURTIA (Izhevsk)
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = infantry_plant_ready
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { infantry_equipment }

		production_bonus = {
			production_cost_factor = @infantry_equipment_production_cost_factor
		}
	}
}

SOV_kolomna_organization = {
	include = generic_support_equipment_organization
	icon = GFX_idea_kolomna

	allowed = {
		original_tag = SOV
	}

	add_trait = {	# Magnitogorsk Metallurgical Plant Support Equipment - Steel
		token = SOV_mio_trait_merge_magnitogorsk_metallurgical_plant
		name = SOV_merge_materiel_plant_3
		icon = GFX_generic_mio_trait_icon_resources
		special_trait_background = yes

		position = { x=@materiel_1_X y=@materiel_1_Y }

		available = {
			FROM = {
				has_full_control_of_state = 876 #MAGNITOGORSK
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = materiel_plant3_ready
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_magnitogorsk_metallurgical_plant_flag }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_magnitogorsk_metallurgical_plant_flag2
			}
		}

		limit_to_equipment_type = { support_equipment }

		production_bonus = {
			production_resource_penalty_factor = @materiel_production_resource_penalty_factor
		}
	}
}


SOV_grabin_design_bureau_organization = {
	include = generic_artillery_organization
	icon = GFX_idea_gau

	allowed = {
		original_tag = SOV
	}

	equipment_type = {
		mio_cat_eq_all_artillery
		mio_cat_eq_all_antitank
		mio_cat_eq_all_antiair
		mio_cat_eq_all_rocket_artillery
	}

	add_trait = {	# Plant 172 AT
		token = SOV_mio_trait_merge_plant_no_172
		name = SOV_merge_materiel_plant_1_artillery
		icon = GFX_generic_mio_department_icon_artillery_production
		special_trait_background = yes

		position = { x=@materiel_1_X y=@materiel_1_Y }

		available = {
			FROM = {
				has_full_control_of_state = 398 #PERM
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = artillery_plant_ready
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { mio_cat_eq_all_antitank }

		production_bonus = {
			production_cost_factor = @artillery_production_cost_factor
		}
	}

	add_trait = {	# NKMZ heavy arty armoured trains
		token = SOV_mio_trait_merge_nkmz_plant
		name = SOV_merge_materiel_plant_2
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_trait_icon_efficiency_cap
		special_trait_background = yes

		position = { x=@materiel_2_X y=@materiel_2_Y }


		available = {
			FROM = {
				has_full_control_of_state = 582 #Orsk
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = materiel_plant2_ready
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_nkmz_plant_flag2 }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_nkmz_plant_flag
			}
		}

		limit_to_equipment_type = { heavy_artillery_equipment }
		production_bonus = {
			production_efficiency_cap_factor = @materiel_production_efficiency_cap_factor
		}
	}

	add_trait = {	# Kirov Plant 98 rocket arty
		token = SOV_mio_trait_merge_kirov_plant_no_98
		name = SOV_mio_trait_merge_kirov_plant_no_98
		icon = GFX_generic_mio_trait_icon_production_capacity
		special_trait_background = yes

		position = { x=@materiel_3_X y=@materiel_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 398 #Perm
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_kirov_plant_no_98_flag2 }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_kirov_plant_no_98_flag
			}
		}

		limit_to_equipment_type = { mio_cat_eq_all_rocket_artillery }

		production_bonus = {
			production_capacity_factor = @materiel_production_capacity_factor
		}
	}
}

SOV_gaz_organization = {
	include = generic_motorized_mechanized_organization
	icon = GFX_idea_gaz

	allowed = {
		original_tag = SOV
	}

	available = {
	#	FROM = {
	#		has_completed_focus = SOV_gaz_automobile_plants
	#	}
	}

	add_trait = {	# Automobile Tool Plant trucks
		token = SOV_mio_trait_merge_automobile_tool_plant
		name = SOV_merge_materiel_plant_1_motorized
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_department_icon_motorized_mechanized_production
		special_trait_background = yes

		position = { x=@materiel_1_X y=@materiel_1_Y }

		available = {
			FROM = {
				has_full_control_of_state = 252 #GORKY
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			FROM = {
				has_country_flag = motorized_plant_ready
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { motorized_equipment }

		production_bonus = {
			production_cost_factor = @motorized_production_cost_factor
		}
	}

	add_trait = {	# PLant 177 scout car
		token = SOV_mio_trait_merge_plant_no_177
		name = SOV_mio_trait_merge_plant_no_177
		icon = GFX_generic_mio_department_icon_facilities
		special_trait_background = yes

		position = { x=@materiel_2_X y=@materiel_2_Y }

		available = {
			FROM = {
				has_full_control_of_state = 252 #GORKY
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { scout_car_chassis }

		production_bonus = {
			production_capacity_factor = @materiel_production_capacity_factor
		}
	}

	add_trait = {	# Kirov Plant 98 rocket arty
		token = SOV_mio_trait_merge_kirov_plant_no_98
		name = SOV_mio_trait_merge_kirov_plant_no_98
		icon = GFX_generic_mio_trait_icon_production_capacity
		special_trait_background = yes

		position = { x=@materiel_3_X y=@materiel_3_Y }

		available = {
			FROM = {
				has_full_control_of_state = 398 #Perm
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_kirov_plant_no_98_flag }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_kirov_plant_no_98_flag2
			}
		}

		limit_to_equipment_type = { motorized_rocket_equipment }

		production_bonus = {
			production_capacity_factor = @materiel_production_capacity_factor
		}
	}
}

 ######  ##     ## #### ########   ######
##    ## ##     ##  ##  ##     ## ##    ##
##       ##     ##  ##  ##     ## ##
 ######  #########  ##  ########   ######
      ## ##     ##  ##  ##              ##
##    ## ##     ##  ##  ##        ##    ##
 ######  ##     ## #### ##         ######

SOV_nevskoye_design_bureau_organization = {
	include = generic_heavy_task_force_ship_organization
	icon = GFX_idea_nevskoye_design_bureau

	allowed = {
		tag = SOV
	}

	equipment_type = {
		mio_cat_eq_all_carrier
		ship_hull_heavy_cruiser
		ship_hull_light
	}

	add_trait = { #MTG version
		token = SOV_mio_trait_merge_plant_no_370
		name = SOV_merge_ship_plant_4_baltic
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_trait_icon_mines
		special_trait_background = yes

		position = { x = 9 y = 1 }

		available = {
			FROM = {
				has_full_control_of_state = 195 #LENINGRAD
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_completed_focus = SOV_new_shipyards
			}
			FROM = {
				has_country_flag = ship_plant_baltic_ready4
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_370_flag }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_370_flag2
				if = {
					limit = {
						has_dlc = "Man the Guns"
					}
					add_tech_bonus = {
						name = SOV_merge_ship_plant_2_baltic
						bonus = 1
						uses = 1
						category = naval_mines
					}
				}
			}
		}

		limit_to_equipment_type = { screen_ship }

		production_bonus = {
			production_capacity_factor = @ship_production_capacity_factor
		}

		equipment_bonus = {
			mines_planting = @ship_mines_planting
		}
	}

	add_trait = {
		token = SOV_mio_trait_merge_plant_no_5
		name = SOV_merge_ship_plant_1_baltic
		icon = GFX_generic_mio_department_icon_ship_screen_ship_production
		special_trait_background = yes

		position = { x = 9 y = 2 }

		available = {
			FROM = {
				has_full_control_of_state = 195 #LENINGRAD
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_completed_focus = SOV_new_shipyards
			}
			FROM = {
				has_country_flag = ship_plant_baltic_ready
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { mio_cat_eq_all_cruiser }

		production_bonus = {
			production_cost_factor = @ship_cruiser_production_cost_factor
		}
	}
}

SOV_black_sea_shipyard_organization = {
	include = generic_heavy_battle_line_ship_organization
	icon = GFX_idea_SOV_black_sea_shipyard

	allowed = {
		original_tag = SOV
	}

	add_trait = { #MTG version
		token = SOV_mio_trait_merge_mariupol_plant
		name = SOV_merge_ship_plant_4_black_sea
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_trait_icon_mines
		special_trait_background = yes

		position = { x = 9 y = 1 }

		available = {
			FROM = {
				has_full_control_of_state = 227 #STALINO
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_completed_focus = SOV_new_shipyards
			}
			FROM = {
				has_country_flag = ship_plant_black_sea_ready4
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_mariupol_plant_flag2 }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_mariupol_plant_flag
				if = {
					limit = {
						has_dlc = "Man the Guns"
					}
					add_tech_bonus = {
						name = SOV_merge_ship_plant_2_baltic
						bonus = 0.5
						uses = 1
						category = naval_mines
					}
				}
			}
		}

		limit_to_equipment_type = { screen_ship }

		production_bonus = {
			production_capacity_factor = @ship_production_capacity_factor
		}

		equipment_bonus = {
			mines_planting = @ship_mines_planting
		}
	}

	add_trait = {
		token = SOV_mio_trait_merge_leninskaya_kuznitsa_plant
		name = SOV_merge_ship_plant_2_black_sea
		icon = GFX_generic_mio_department_icon_ship_screen_ship_production
		special_trait_background = yes

		position = { x = 8 y = 2 }

		mutually_exclusive = { SOV_mio_trait_merge_plant_no_340 }

		available = {
			FROM = {
				has_full_control_of_state = 202 #KIEV
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_completed_focus = SOV_new_shipyards
			}
			FROM = {
				has_country_flag = ship_plant_black_sea_ready2
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { mio_cat_eq_all_destroyer }

		production_bonus = {
			production_cost_factor = @ship_destroyer_production_cost_factor
		}
	}

	add_trait = {
		token = SOV_mio_trait_merge_plant_no_340
		name = SOV_merge_ship_plant_3_black_sea
		icon = GFX_generic_mio_department_icon_ship_submarine_production
		special_trait_background = yes

		position = { x = 9 y = 2 }

		mutually_exclusive = { SOV_mio_trait_merge_leninskaya_kuznitsa_plant }



		available = {
			FROM = {
				has_full_control_of_state = 227 #STALINO
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_completed_focus = SOV_submarine_warfare
			}
			FROM = {
				has_country_flag = ship_plant_black_sea_ready3
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { ship_hull_submarine }

		production_bonus = {
			production_cost_factor = @ship_submarine_production_cost_factor
		}
	}
}

SOV_sevastopol_marine_plant_organization = {
	include = generic_medium_ship_organization
	icon = GFX_idea_SOV_sevastopol_marine_plant

	allowed = {
		original_tag = SOV
	}

	add_trait = { #MTG version
		token = SOV_mio_trait_merge_mariupol_plant
		name = SOV_merge_ship_plant_4_black_sea
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_trait_icon_mines
		special_trait_background = yes

		position = { x = 9 y = 1 }

		available = {
			FROM = {
				has_full_control_of_state = 227 #STALINO
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_completed_focus = SOV_new_shipyards
			}
			FROM = {
				has_country_flag = ship_plant_black_sea_ready4
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_mariupol_plant_flag }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_mariupol_plant_flag2
				if = {
					limit = {
						has_dlc = "Man the Guns"
					}
					add_tech_bonus = {
						name = SOV_merge_ship_plant_2_baltic
						bonus = 0.5
						uses = 1
						category = naval_mines
					}
				}
			}
		}

		limit_to_equipment_type = { screen_ship }

		production_bonus = {
			production_capacity_factor = @ship_production_capacity_factor
		}

		equipment_bonus = {
			mines_planting = @ship_mines_planting
		}
	}

	add_trait = {
		token = SOV_mio_trait_merge_plant_no_200
		name = SOV_merge_ship_plant_1_black_sea
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_department_icon_ship_screen_ship_production
		special_trait_background = yes

		position = { x = 9 y = 2 }

		available = {
			FROM = {
				has_full_control_of_state = 197 #MYKOLAIV
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_completed_focus = SOV_new_shipyards
			}
			FROM = {
				has_country_flag = ship_plant_black_sea_ready
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { mio_cat_eq_all_cruiser }

		production_bonus = {
			production_cost_factor = @ship_cruiser_production_cost_factor
		}
	}
}

SOV_baltic_sea_shipyard_organization = {
	include = generic_light_ship_organization
	icon = GFX_idea_SOV_baltic_sea_shipyard

	allowed = {
		original_tag = SOV
	}
}

SOV_rubin_design_bureau_organization = {
	include = generic_submarine_organization
	icon = GFX_idea_SOV_rubin_design_bureau

	allowed = {
		tag = SOV
	}

	add_trait = { #MTG version
		token = SOV_mio_trait_merge_plant_no_370
		name = SOV_merge_ship_plant_4_baltic
		#icon = GFX_generic_mio_department_icon_facilities
		icon = GFX_generic_mio_trait_icon_mines
		special_trait_background = yes

		position = { x = 9 y = 1 }

		available = {
			FROM = {
				has_full_control_of_state = 195 #LENINGRAD
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_completed_focus = SOV_new_shipyards
			}
			FROM = {
				has_country_flag = ship_plant_baltic_ready4
			}
			hidden_trigger = {
				FROM = {
					NOT = { has_country_flag = SOV_merge_plant_no_370_flag2 }
				}
			}
		}

		on_complete = {
			custom_effect_tooltip = generic_trait_will_not_be_available_in_other_organizations
			FROM = {
				set_country_flag = SOV_merge_plant_no_370_flag
				if = {
					limit = {
						has_dlc = "Man the Guns"
					}
					add_tech_bonus = {
						name = SOV_merge_ship_plant_2_baltic
						bonus = 0.5
						uses = 1
						category = naval_mines
					}
				}
			}
		}

		limit_to_equipment_type = { mio_cat_eq_all_submarine }

		production_bonus = {
			production_capacity_factor = @ship_production_capacity_factor
		}

		equipment_bonus = {
			mines_planting = @ship_mines_planting
		}
	}

	add_trait = {
		token = SOV_mio_trait_merge_plant_no_363
		name = SOV_merge_ship_plant_2_baltic
		icon = GFX_generic_mio_department_icon_ship_submarine_production
		special_trait_background = yes

		position = { x = 8 y = 2 }

		mutually_exclusive = { SOV_mio_trait_merge_plant_no_190 }

		available = {
			FROM = {
				has_full_control_of_state = 195 #LENINGRAD
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_completed_focus = SOV_submarine_warfare
			}
			FROM = {
				has_country_flag = ship_plant_baltic_ready2
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { ship_hull_submarine }

		production_bonus = {
			production_cost_factor = @ship_destroyer_production_cost_factor
		}
	}

	add_trait = {
		token = SOV_mio_trait_merge_plant_no_190
		name = SOV_merge_ship_plant_3_baltic
		icon = GFX_generic_mio_department_icon_ship_submarine_production
		special_trait_background = yes

		position = { x = 9 y = 2 }

		mutually_exclusive = { SOV_mio_trait_merge_plant_no_363 }

		available = {
			FROM = {
				has_full_control_of_state = 195 #LENINGRAD
			}
			FROM = {
				has_completed_focus = SOV_merge_evacuated_plants
				has_completed_focus = SOV_submarine_warfare
			}
			FROM = {
				has_country_flag = ship_plant_baltic_ready3
			}
			#Only exists in this MIO
		}

		limit_to_equipment_type = { sub_hull_cruiser_submarine }

		production_bonus = {
			production_cost_factor = @ship_submarine_production_cost_factor
		}
	}
}